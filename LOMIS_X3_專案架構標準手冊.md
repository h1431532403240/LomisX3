# ğŸ—ï¸ LomisX3 å°ˆæ¡ˆæ¶æ§‹æ¨™æº–æ‰‹å†Š (V4.0)      

[![ç‰ˆæœ¬](https://img.shields.io/badge/ç‰ˆæœ¬-v4.0-blue.svg)](https://github.com/your-username/LomisX3)
[![ç‹€æ…‹](https://img.shields.io/badge/ç‹€æ…‹-ç”Ÿç”¢å°±ç·’-success.svg)](https://github.com/your-username/LomisX3)
[![å¼·åˆ¶åŸ·è¡Œ](https://img.shields.io/badge/å¼·åˆ¶åŸ·è¡Œ-100%25-red.svg)](https://github.com/your-username/LomisX3)

**âš ï¸ é‡è¦æé†’**: æœ¬æ‰‹å†Šç‚º LomisX3 å°ˆæ¡ˆçš„çµ•å°æ¨™æº–ï¼Œæ‰€æœ‰é–‹ç™¼äººå“¡**å¿…é ˆ**åš´æ ¼éµå®ˆã€‚
ä»»ä½•åé›¢æ­¤æ¨™æº–çš„é–‹ç™¼è¡Œç‚ºéƒ½**ç¦æ­¢**é€²è¡Œï¼Œä»¥é¿å…æ¶æ§‹åˆ†è£‚å’ŒæŠ€è¡“å‚µå‹™ã€‚

**ğŸ“… æ›´æ–°æ—¥èªŒ**: **v4.0 (2025-01-08) - é©å‘½æ€§æ›´æ–°**
1. **æ¶æ§‹æ ¸å¿ƒå‡ç´š**ï¼šå…¨é¢é·ç§»è‡³ **Pure Bearer Token** ç„¡ç‹€æ…‹èªè­‰æ¨¡å¼
2. **API å¥‘ç´„å¼·åˆ¶**ï¼šæ–°å¢ API è¦ç¯„èˆ‡å¯¦ç¾ä¸€è‡´æ€§çš„**è‡ªå‹•åŒ–åˆç´„æ¸¬è©¦**è¦æ±‚
3. **å‰ç«¯çµ„ä»¶æ¨™æº–é€²åŒ–**ï¼šç¢ºç«‹**å®Œå…¨å—æ§çµ„ä»¶ (Fully Controlled Component)** ç‚ºé€šç”¨çµ„ä»¶çš„å”¯ä¸€è¨­è¨ˆæ¨¡å¼
4. **React Hooks æœ€ä½³å¯¦è¸**ï¼šæ–°å¢ `useCallback` å’Œ `useEffect` ä¾è³´ç®¡ç†çš„å¼·åˆ¶è¦ç¯„ï¼Œæ ¹é™¤ç„¡é™æ¸²æŸ“å•é¡Œ

## ğŸ“‹ å®Œæ•´ç›®éŒ„

### ğŸ¯ åŸºç¤æ¶æ§‹
- [å°ˆæ¡ˆæ¦‚è¦½èˆ‡æ ¸å¿ƒåŸå‰‡](#-å°ˆæ¡ˆæ¦‚è¦½èˆ‡æ ¸å¿ƒåŸå‰‡)
- [æŠ€è¡“æ£§æ¨™æº–è¦ç¯„](#-æŠ€è¡“æ£§æ¨™æº–è¦ç¯„)
- [é …ç›®çµæ§‹èˆ‡çµ„ç¹”](#-é …ç›®çµæ§‹èˆ‡çµ„ç¹”)

### ğŸ” **èªè­‰èˆ‡æˆæ¬Šæ¶æ§‹ (V4.0 Pure Token æ¨¡å¼)**
- [**æ¶æ§‹æ ¸å¿ƒï¼šå¾ SPA Cookie åˆ° Pure Bearer Token**](#-æ¶æ§‹æ ¸å¿ƒå¾-spa-cookie-åˆ°-pure-bearer-token)
- [å¾Œç«¯å¯¦ç¾æ¨™æº–](#-å¾Œç«¯å¯¦ç¾æ¨™æº–-pure-token)
- [å‰ç«¯å¯¦ç¾æ¨™æº–](#-å‰ç«¯å¯¦ç¾æ¨™æº–-pure-token)
- [é–‹ç™¼å¼·åˆ¶è¦æ±‚èˆ‡ç¦æ­¢è¡Œç‚º](#-é–‹ç™¼å¼·åˆ¶è¦æ±‚èˆ‡ç¦æ­¢è¡Œç‚º)

### ğŸ›ï¸ ç³»çµ±æ¶æ§‹è¨­è¨ˆ
- [æ•´é«”æ¶æ§‹è¨­è¨ˆæ¨¡å¼](#-æ•´é«”æ¶æ§‹è¨­è¨ˆæ¨¡å¼)
- [å¾Œç«¯æ¶æ§‹æ¨™æº–](#-å¾Œç«¯æ¶æ§‹æ¨™æº–)
- [å‰ç«¯æ¶æ§‹æ¨™æº–](#-å‰ç«¯æ¶æ§‹æ¨™æº–)
- [æ•¸æ“šæµå‘èˆ‡é€šä¿¡è¦ç¯„](#-æ•¸æ“šæµå‘èˆ‡é€šä¿¡è¦ç¯„)

### ğŸ” æ¬Šé™èˆ‡å®‰å…¨æ¶æ§‹
- [å¤šç§Ÿæˆ¶æ¶æ§‹è¨­è¨ˆ](#-å¤šç§Ÿæˆ¶æ¶æ§‹è¨­è¨ˆ)
- [æ¬Šé™ç³»çµ±æ¶æ§‹](#-æ¬Šé™ç³»çµ±æ¶æ§‹)
- [å®‰å…¨é˜²è­·æ¨™æº–](#-å®‰å…¨é˜²è­·æ¨™æº–)

### ğŸ—„ï¸ è³‡æ–™åº«è¨­è¨ˆæ¨™æº–
- [è³‡æ–™åº«æ¶æ§‹è¨­è¨ˆ](#-è³‡æ–™åº«æ¶æ§‹è¨­è¨ˆ)
- [è¡¨æ ¼è¨­è¨ˆè¦ç¯„](#-è¡¨æ ¼è¨­è¨ˆè¦ç¯„)
- [ç´¢å¼•èˆ‡æ•ˆèƒ½å„ªåŒ–](#-ç´¢å¼•èˆ‡æ•ˆèƒ½å„ªåŒ–)

### ğŸŒ API è¨­è¨ˆèˆ‡å“è³ªä¿è­‰ (V4.0 å¼·åˆ¶)
- [RESTful API è¨­è¨ˆ](#-restful-api-è¨­è¨ˆ)
- [API å›æ‡‰æ ¼å¼](#-api-å›æ‡‰æ ¼å¼)
- [**API åˆç´„èˆ‡çœŸå¯¦æ€§é©—è­‰ (V4.0 å¼·åˆ¶)**](#-api-åˆç´„èˆ‡çœŸå¯¦æ€§é©—è­‰-v40-å¼·åˆ¶)
- [API æ–‡æª”èˆ‡æ¸¬è©¦](#-api-æ–‡æª”èˆ‡æ¸¬è©¦)

### ğŸ¨ å‰ç«¯é–‹ç™¼æ¨™æº– (V4.0 å¼·åŒ–)
- [å‰ç«¯æ¶æ§‹è¦ç¯„](#-å‰ç«¯æ¶æ§‹è¦ç¯„)
- [**çµ„ä»¶è¨­è¨ˆå“²å­¸ï¼šå®Œå…¨å—æ§èˆ‡ç„¡å‰¯ä½œç”¨ (V4.0 å¼·åˆ¶)**](#-çµ„ä»¶è¨­è¨ˆå“²å­¸å®Œå…¨å—æ§èˆ‡ç„¡å‰¯ä½œç”¨-v40-å¼·åˆ¶)
- [**React Hooks ä½¿ç”¨è¦ç¯„ (V4.0 å¼·åˆ¶)**](#-react-hooks-ä½¿ç”¨è¦ç¯„-v40-å¼·åˆ¶)
- [ç‹€æ…‹ç®¡ç†è¦ç¯„](#-ç‹€æ…‹ç®¡ç†è¦ç¯„)
- [å‹åˆ¥å®‰å…¨æ¨™æº–](#-å‹åˆ¥å®‰å…¨æ¨™æº–)

### ğŸ§ª æ¸¬è©¦èˆ‡å“è³ªä¿è­‰
- [æ¸¬è©¦ç­–ç•¥èˆ‡è¦†è“‹ç‡](#-æ¸¬è©¦ç­–ç•¥èˆ‡è¦†è“‹ç‡)
- [å¾Œç«¯æ¸¬è©¦æ¨™æº–](#-å¾Œç«¯æ¸¬è©¦æ¨™æº–)
- [å‰ç«¯æ¸¬è©¦æ¨™æº–](#-å‰ç«¯æ¸¬è©¦æ¨™æº–)
- [E2E æ¸¬è©¦æ¨™æº–](#-e2e-æ¸¬è©¦æ¨™æº–)

### ğŸ“š å·²å¯¦ç¾æ¨¡çµ„æ¸…å–®
- [å®Œæˆæ¨¡çµ„åˆ—è¡¨](#-å®Œæˆæ¨¡çµ„åˆ—è¡¨)
- [å…±ç”¨å…ƒä»¶åº«](#-å…±ç”¨å…ƒä»¶åº«)
- [é–‹ç™¼å·¥å…·èˆ‡é…ç½®](#-é–‹ç™¼å·¥å…·èˆ‡é…ç½®)

### ğŸš« ç¦æ­¢è¡Œç‚ºèˆ‡æª¢æŸ¥æ¸…å–®
- [çµ•å°ç¦æ­¢è¡Œç‚º](#-çµ•å°ç¦æ­¢è¡Œç‚º)
- [é–‹ç™¼æª¢æŸ¥æ¸…å–®](#-é–‹ç™¼æª¢æŸ¥æ¸…å–®)
- [å“è³ªæ¨™æº–ç›£æ§](#-å“è³ªæ¨™æº–ç›£æ§)

---

## ğŸ¯ å°ˆæ¡ˆæ¦‚è¦½èˆ‡æ ¸å¿ƒåŸå‰‡

### ğŸ“Š LomisX3 å°ˆæ¡ˆæ¦‚è¿°

LomisX3 æ˜¯ä¸€å€‹ä¼æ¥­ç´šç®¡ç†ç³»çµ±ï¼Œæ¡ç”¨ç¾ä»£åŒ–çš„å‰å¾Œç«¯åˆ†é›¢æ¶æ§‹ï¼Œæ”¯æ´å¤šç§Ÿæˆ¶ï¼ˆé–€å¸‚ï¼‰çš„æ•¸æ“šéš”é›¢ã€‚ç³»çµ±è¨­è¨ˆéµå¾ªå¾®æœå‹™ç†å¿µï¼Œå…·å‚™é«˜åº¦çš„å¯æ“´å±•æ€§å’Œç¶­è­·æ€§ã€‚

### ğŸ—ï¸ æ ¸å¿ƒæ¶æ§‹åŸå‰‡

#### 1. **SOLID è¨­è¨ˆåŸå‰‡ (ä¸å¯å¦¥å”)**

- **å–®ä¸€è·è²¬åŸå‰‡ (SRP)**: æ¯å€‹é¡åˆ¥ã€æ–¹æ³•ã€å…ƒä»¶åªè² è²¬ä¸€å€‹æ˜ç¢ºåŠŸèƒ½
- **é–‹æ”¾å°é–‰åŸå‰‡ (OCP)**: å°æ“´å±•é–‹æ”¾ï¼Œå°ä¿®æ”¹å°é–‰
- **é‡Œæ°æ›¿æ›åŸå‰‡ (LSP)**: å­é¡åˆ¥å¿…é ˆèƒ½å¤ æ›¿æ›å…¶çˆ¶é¡åˆ¥
- **ä»‹é¢éš”é›¢åŸå‰‡ (ISP)**: ä¸å¼·è¿«ä¾è³´ä¸ä½¿ç”¨çš„ä»‹é¢
- **ä¾è³´åè½‰åŸå‰‡ (DIP)**: ä¾è³´æŠ½è±¡è€Œéå…·é«”å¯¦ç¾

#### 2. **æ¶æ§‹å±¤ç´šè¨­è¨ˆ**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸŒ Presentation Layer                     â”‚
â”‚          React 19 + TypeScript + shadcn/ui                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     ğŸ”Œ API Gateway                          â”‚
â”‚                   Laravel Sanctum                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   âš™ï¸ Business Logic Layer                    â”‚
â”‚                     Service Classes                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   ğŸ“Š Data Access Layer                      â”‚
â”‚                  Repository Pattern                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   ğŸ—„ï¸ Persistence Layer                      â”‚
â”‚                 MySQL 8.0 + Redis 7.0                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3. **åš´æ ¼çš„æ•¸æ“šæµå‘**

```
Request â†’ Middleware â†’ Controller â†’ Service â†’ Repository â†’ Model â†’ Database
                          â†“
Response â† Resource â† Service â† Repository â† Model â† Database
```

**çµ•å°ç¦æ­¢çš„æ•¸æ“šæµ**ï¼š
- âŒ Controller ç›´æ¥æ“ä½œ Model
- âŒ Component ç›´æ¥èª¿ç”¨ API
- âŒ Service ç›´æ¥æ“ä½œè³‡æ–™åº«
- âŒ è·¨å±¤ç´šçš„ç›´æ¥ä¾è³´

---

## ğŸ› ï¸ æŠ€è¡“æ£§æ¨™æº–è¦ç¯„

### âš™ï¸ å¾Œç«¯æŠ€è¡“æ£§ (ä¸å¯è®Šæ›´)

| æŠ€è¡“é¡åˆ¥ | æŒ‡å®šç‰ˆæœ¬ | ç”¨é€”èªªæ˜ | æ›¿ä»£æ–¹æ¡ˆ |
|---------|---------|----------|----------|
| **PHP** | >= 8.2 | ä¸»è¦ç¨‹å¼èªè¨€ | âŒ ç¦æ­¢ |
| **Laravel** | >= 12.0 | Web æ¡†æ¶ | âŒ ç¦æ­¢ |
| **MySQL** | >= 8.0 | ä¸»è³‡æ–™åº« | âœ… PostgreSQL (ç‰¹æ®Šæƒ…æ³) |
| **Redis** | >= 7.0 | å¿«å–ç³»çµ± (Pure Bearer Token æ¨¡å¼) | âŒ ç¦æ­¢ |
| **Laravel Sanctum** | >= 4.1 | Pure Bearer Token API èªè­‰ | âŒ ç¦æ­¢ |
| **Spatie Permission** | >= 6.9 | æ¬Šé™ç®¡ç† | âŒ ç¦æ­¢ |
| **Laravel Scribe** | >= 5.2 | API æ–‡æª” | âŒ ç¦æ­¢ |
| **Spatie Permission** | >= 6.9 | æ¬Šé™ç®¡ç† | âŒ ç¦æ­¢ |
| **Spatie ActivityLog** | >= 4.8 | æ´»å‹•è¨˜éŒ„ | âŒ ç¦æ­¢ |
| **Spatie MediaLibrary** | >= 11.7 | åª’é«”ç®¡ç† | âŒ ç¦æ­¢ |
| **Spatie Query Builder** | >= 6.0 | API æŸ¥è©¢å»ºæ§‹å™¨ | âŒ ç¦æ­¢ |
| **PHPUnit/Pest** | >= 11.5 | æ¸¬è©¦æ¡†æ¶ | âŒ ç¦æ­¢ |
| **Laravel Pint** | >= 1.13 | ç¨‹å¼ç¢¼æ ¼å¼åŒ– | âŒ ç¦æ­¢ |
| **PHPStan** | >= 1.12 | éœæ…‹åˆ†æ | âŒ ç¦æ­¢ |

### ğŸ¨ å‰ç«¯æŠ€è¡“æ£§ (ä¸å¯è®Šæ›´)

| æŠ€è¡“é¡åˆ¥ | æŒ‡å®šç‰ˆæœ¬ | ç”¨é€”èªªæ˜ | æ›¿ä»£æ–¹æ¡ˆ |
|---------|---------|----------|----------|
| **React** | >= 19.1 | å‰ç«¯æ¡†æ¶ | âŒ ç¦æ­¢ |
| **TypeScript** | >= 5.8 | é¡å‹ç³»çµ± | âŒ ç¦æ­¢ |
| **Vite** | >= 6.3 | å»ºç½®å·¥å…· | âŒ ç¦æ­¢ |
| **shadcn/ui** | Latest | UI çµ„ä»¶åº« (å”¯ä¸€æŒ‡å®š) | âŒ ç¦æ­¢ |
| **Lucide React** | Latest | åœ–æ¨™åº« (shadcn/ui é…å¥—) | âŒ ç¦æ­¢ |
| **Tailwind CSS** | >= 3.4 | CSS æ¡†æ¶ | âŒ ç¦æ­¢ |
| **TanStack Query** | >= 5.80 | ä¼ºæœå™¨ç‹€æ…‹ç®¡ç† | âŒ ç¦æ­¢ |
| **React Hook Form** | >= 7.57 | è¡¨å–®è™•ç† | âŒ ç¦æ­¢ |
| **Zod** | >= 3.25 | Schema é©—è­‰ | âŒ ç¦æ­¢ |
| **React Router** | >= 7.6 | è·¯ç”±ç®¡ç† | âŒ ç¦æ­¢ |
| **openapi-typescript** | >= 7.4 | å‹åˆ¥ç”Ÿæˆ | âŒ ç¦æ­¢ |

### ğŸ”§ é–‹ç™¼å·¥å…·æ¨™æº–

| å·¥å…·é¡åˆ¥ | æŒ‡å®šå·¥å…· | é…ç½®æª”æ¡ˆ | å¼·åˆ¶ä½¿ç”¨ |
|---------|---------|----------|----------|
| **IDE** | VS Code | `.vscode/settings.json` | âœ… æ¨è–¦ |
| **å®¹å™¨åŒ–** | Docker + Docker Compose | `docker-compose.yml` | âœ… å¿…é ˆ |
| **ç‰ˆæœ¬æ§åˆ¶** | Git | `.gitignore`, `.gitattributes` | âœ… å¿…é ˆ |
| **CI/CD** | GitHub Actions | `.github/workflows/` | âœ… å¿…é ˆ |
| **ç›£æ§** | Prometheus + Grafana | `docker/prometheus/` | âœ… å¿…é ˆ |
| **è¿½è¹¤** | OpenTelemetry + Jaeger | `infrastructure/` | âœ… å¿…é ˆ |

---

## ğŸ“ é …ç›®çµæ§‹èˆ‡çµ„ç¹”

### ğŸ—ï¸ å®Œæ•´é …ç›®çµæ§‹

```
LomisX3/
â”œâ”€â”€ back/                            # å¾Œç«¯æ‡‰ç”¨
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ Http/                    # HTTP å±¤
â”‚   â”‚   â”‚   â”œâ”€â”€ Controllers/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Api/             # API æ§åˆ¶å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ Middleware/          # ä¸­ä»‹è»Ÿé«”
â”‚   â”‚   â”‚   â”œâ”€â”€ Requests/            # è«‹æ±‚é©—è­‰
â”‚   â”‚   â”‚   â””â”€â”€ Resources/           # è³‡æºå›æ‡‰
â”‚   â”‚   â”œâ”€â”€ Models/                  # Eloquent æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ Repositories/            # è³‡æ–™å­˜å–å±¤
â”‚   â”‚   â”‚   â””â”€â”€ Contracts/           # Repository ä»‹é¢
â”‚   â”‚   â”œâ”€â”€ Services/                # æ¥­å‹™é‚è¼¯å±¤
â”‚   â”‚   â”‚   â””â”€â”€ Contracts/           # Service ä»‹é¢
â”‚   â”‚   â”œâ”€â”€ Observers/               # æ¨¡å‹è§€å¯Ÿè€…
â”‚   â”‚   â”œâ”€â”€ Policies/                # æ¬Šé™ç­–ç•¥
â”‚   â”‚   â”œâ”€â”€ Enums/                   # æšèˆ‰å®šç¾©
â”‚   â”‚   â”œâ”€â”€ Rules/                   # è‡ªè¨‚é©—è­‰è¦å‰‡
â”‚   â”‚   â””â”€â”€ Exceptions/              # è‡ªè¨‚ä¾‹å¤–
â”‚   â”œâ”€â”€ database/
â”‚   â”‚   â”œâ”€â”€ migrations/              # è³‡æ–™åº«é·ç§»
â”‚   â”‚   â”œâ”€â”€ seeders/                 # è³‡æ–™å¡«å……
â”‚   â”‚   â””â”€â”€ factories/               # æ¨¡å‹å·¥å» 
â”‚   â”œâ”€â”€ tests/
â”‚   â”‚   â”œâ”€â”€ Feature/                 # åŠŸèƒ½æ¸¬è©¦
â”‚   â”‚   â”œâ”€â”€ Unit/                    # å–®å…ƒæ¸¬è©¦
â”‚   â”‚   â””â”€â”€ Support/                 # æ¸¬è©¦è¼”åŠ©
â”‚   â”œâ”€â”€ config/                      # é…ç½®æª”æ¡ˆ
â”‚   â”œâ”€â”€ routes/                      # è·¯ç”±å®šç¾©
â”‚   â””â”€â”€ storage/                     # å„²å­˜ç›®éŒ„
â”œâ”€â”€ front/                           # å‰ç«¯æ‡‰ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/              # å¯é‡ç”¨çµ„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ ui/                  # shadcn/ui åŸºç¤çµ„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ forms/               # è¡¨å–®ç›¸é—œçµ„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ layout/              # ä½ˆå±€çµ„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ common/              # é€šç”¨çµ„ä»¶
â”‚   â”‚   â”œâ”€â”€ pages/                   # é é¢çµ„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/                # èªè­‰é é¢
â”‚   â”‚   â”‚   â”œâ”€â”€ dashboard/           # å„€è¡¨æ¿
â”‚   â”‚   â”‚   â””â”€â”€ {module-name}/       # æ¨¡çµ„é é¢
â”‚   â”‚   â”œâ”€â”€ hooks/                   # è‡ªè¨‚ Hooks
â”‚   â”‚   â”‚   â”œâ”€â”€ api/                 # API Hooks
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/                # èªè­‰ Hooks
â”‚   â”‚   â”‚   â”œâ”€â”€ ui/                  # UI Hooks
â”‚   â”‚   â”‚   â””â”€â”€ common/              # é€šç”¨ Hooks
â”‚   â”‚   â”œâ”€â”€ lib/                     # å·¥å…·åº«
â”‚   â”‚   â”‚   â”œâ”€â”€ api-client.ts        # API å®¢æˆ¶ç«¯
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts              # èªè­‰å·¥å…·
â”‚   â”‚   â”‚   â”œâ”€â”€ utils.ts             # é€šç”¨å·¥å…·
â”‚   â”‚   â”‚   â””â”€â”€ constants.ts         # å¸¸æ•¸å®šç¾©
â”‚   â”‚   â”œâ”€â”€ store/                   # ç‹€æ…‹ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ auth-store.ts        # èªè­‰ç‹€æ…‹
â”‚   â”‚   â”‚   â”œâ”€â”€ ui-store.ts          # UI ç‹€æ…‹
â”‚   â”‚   â”‚   â””â”€â”€ {module}-store.ts    # æ¨¡çµ„ç‹€æ…‹
â”‚   â”‚   â”œâ”€â”€ types/                   # å‹åˆ¥å®šç¾©
â”‚   â”‚   â”‚   â”œâ”€â”€ api.ts               # API å‹åˆ¥ (è‡ªå‹•ç”Ÿæˆ)
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts              # èªè­‰å‹åˆ¥
â”‚   â”‚   â”‚   â”œâ”€â”€ ui.ts                # UI å‹åˆ¥
â”‚   â”‚   â”‚   â””â”€â”€ {module}.ts          # æ¨¡çµ„å‹åˆ¥
â”‚   â”‚   â”œâ”€â”€ styles/                  # æ¨£å¼æª”æ¡ˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ globals.css          # å…¨åŸŸæ¨£å¼
â”‚   â”‚   â”‚   â””â”€â”€ components.css       # çµ„ä»¶æ¨£å¼
â”‚   â”‚   â””â”€â”€ utils/                   # å·¥å…·å‡½æ•¸
â”‚   â”œâ”€â”€ public/                      # éœæ…‹è³‡æº
â”‚   â”œâ”€â”€ .env.example                 # ç’°å¢ƒè®Šæ•¸ç¯„ä¾‹
â”‚   â”œâ”€â”€ .eslintrc.json               # ESLint é…ç½®
â”‚   â”œâ”€â”€ .prettierrc                  # Prettier é…ç½®
â”‚   â”œâ”€â”€ tailwind.config.js           # Tailwind é…ç½®
â”‚   â”œâ”€â”€ tsconfig.json                # TypeScript é…ç½®
â”‚   â”œâ”€â”€ vite.config.ts               # Vite é…ç½®
â”‚   â””â”€â”€ package.json                 # ä¾è³´ç®¡ç†
â”œâ”€â”€ docs/                            # é …ç›®æ–‡æª”
â”‚   â”œâ”€â”€ api/                         # API æ–‡æª”
â”‚   â”œâ”€â”€ deployment/                  # éƒ¨ç½²æ–‡æª”
â”‚   â””â”€â”€ development/                 # é–‹ç™¼æ–‡æª”
â”œâ”€â”€ infrastructure/                  # åŸºç¤è¨­æ–½
â”‚   â”œâ”€â”€ docker/                      # Docker é…ç½®
â”‚   â”œâ”€â”€ prometheus/                  # ç›£æ§é…ç½®
â”‚   â””â”€â”€ nginx/                       # ç¶²é ä¼ºæœå™¨é…ç½®
â”œâ”€â”€ .github/                         # GitHub é…ç½®
â”‚   â””â”€â”€ workflows/                   # CI/CD æµç¨‹
â”œâ”€â”€ docker-compose.yml               # Docker ç·¨æ’
â”œâ”€â”€ README.md                        # å°ˆæ¡ˆèªªæ˜
â””â”€â”€ ARCHITECTURE_STANDARDS.md       # æœ¬æ¶æ§‹æ‰‹å†Š
```

### ğŸ“‹ å‘½åè¦ç¯„çµ±ä¸€æ¨™æº–

#### ğŸ—‚ï¸ æª”æ¡ˆèˆ‡ç›®éŒ„å‘½å

| é¡å‹ | è¦ç¯„ | ç¯„ä¾‹ | èªªæ˜ |
|------|------|------|------|
| **ç›®éŒ„** | kebab-case | `product-categories/` | å°å¯«å­—æ¯ + é€£å­—è™Ÿ |
| **PHP æª”æ¡ˆ** | PascalCase | `ProductCategoryController.php` | å¤§é§å³° |
| **TypeScript æª”æ¡ˆ** | kebab-case | `product-category-list.tsx` | å°å¯«å­—æ¯ + é€£å­—è™Ÿ |
| **çµ„ä»¶æª”æ¡ˆ** | PascalCase | `ProductCategoryList.tsx` | å¤§é§å³° |
| **Hook æª”æ¡ˆ** | kebab-case | `use-product-categories.ts` | use- å‰ç¶´ |
| **Type æª”æ¡ˆ** | kebab-case | `product-category.types.ts` | .types å¾Œç¶´ |
| **Test æª”æ¡ˆ** | PascalCase | `ProductCategoryTest.php` | Test å¾Œç¶´ |

#### ğŸ·ï¸ é¡åˆ¥èˆ‡ä»‹é¢å‘½å

| é¡å‹ | å‘½åè¦å‰‡ | ç¯„ä¾‹ |
|------|----------|------|
| **Controller** | `{ModuleName}Controller` | `ProductCategoryController` |
| **Model** | `{ModuleName}` | `ProductCategory` |
| **Repository Interface** | `{ModuleName}RepositoryInterface` | `ProductCategoryRepositoryInterface` |
| **Repository** | `{ModuleName}Repository` | `ProductCategoryRepository` |
| **Service Interface** | `{ModuleName}ServiceInterface` | `ProductCategoryServiceInterface` |
| **Service** | `{ModuleName}Service` | `ProductCategoryService` |
| **Policy** | `{ModuleName}Policy` | `ProductCategoryPolicy` |
| **Observer** | `{ModuleName}Observer` | `ProductCategoryObserver` |
| **Request** | `{Action}{ModuleName}Request` | `StoreProductCategoryRequest` |
| **Resource** | `{ModuleName}Resource` | `ProductCategoryResource` |
| **Migration** | `create_{table_name}_table` | `create_product_categories_table` |
| **Component** | `{ModuleName}{Action}` | `ProductCategoryList` |
| **Hook** | `use{ModuleName}` | `useProductCategories` |
| **Type Interface** | `{ModuleName}` | `ProductCategory` |

---

## ğŸ” Pure Bearer Token èªè­‰æ¶æ§‹ (LomisX3 ç‰¹è‰²)

### ğŸš€ æ¶æ§‹é©å‘½ï¼šå¾ SPA Cookie åˆ° Pure Bearer Token

LomisX3 æ¡ç”¨æ¥­ç•Œæœ€å…ˆé€²çš„ **Pure Bearer Token èªè­‰æ¨¡å¼**ï¼Œå®Œå…¨æ‘’æ£„å‚³çµ±çš„ Session å’Œ Cookie æ©Ÿåˆ¶ï¼Œå¯¦ç¾çœŸæ­£çš„ç„¡ç‹€æ…‹ API æ¶æ§‹ã€‚

#### ğŸ“Š æŠ€è¡“å°æ¯”

| å°æ¯”é …ç›® | å‚³çµ± SPA Cookie æ¨¡å¼ | **LomisX3 Pure Bearer Token** |
|---------|---------------------|------------------------------|
| **ç‹€æ…‹ç®¡ç†** | ä¾è³´ Session å­˜å„² | âœ… å®Œå…¨ç„¡ç‹€æ…‹ |
| **èªè­‰æ–¹å¼** | Cookie + CSRF Token | âœ… Authorization: Bearer {token} |
| **å®‰å…¨æ€§** | éœ€è¦ CSRF ä¿è­· | âœ… ç„¡éœ€ CSRFï¼ŒToken å…§å«èªè­‰ |
| **æ•ˆèƒ½** | Session æŸ¥è©¢é–‹éŠ· | âœ… é›¶æŸ¥è©¢é–‹éŠ·ï¼Œé€Ÿåº¦æå‡ 20%+ |
| **æ“´å±•æ€§** | éœ€è¦ Session åŒæ­¥ | âœ… æ°´å¹³æ“´å±•ç„¡éšœç¤™ |
| **è¡Œå‹•ç«¯æ”¯æ´** | è·¨åŸŸå•é¡Œè¤‡é›œ | âœ… åŸç”Ÿæ”¯æ´ï¼Œç„¡è·¨åŸŸå•é¡Œ |
| **å¾®æœå‹™å‹å¥½** | Session å…±äº«å›°é›£ | âœ… å¾®æœå‹™å¤©ç„¶æ”¯æ´ |

#### ğŸ›¡ï¸ å®‰å…¨å„ªå‹¢

1. **ç„¡ Session åŠ«æŒé¢¨éšª**: æ²’æœ‰ Session IDï¼Œç„¡æ³•è¢«åŠ«æŒ
2. **Token ä½œç”¨åŸŸæ§åˆ¶**: æ¯å€‹ Token åŒ…å«æ˜ç¢ºçš„æ¬Šé™ç¯„åœ
3. **è‡ªå‹•éæœŸæ©Ÿåˆ¶**: Token æœ‰æ˜ç¢ºçš„éæœŸæ™‚é–“
4. **è«‹æ±‚ç¨ç«‹æ€§**: æ¯å€‹è«‹æ±‚éƒ½æ˜¯ç¨ç«‹çš„å®‰å…¨é©—è­‰

#### âš¡ æ•ˆèƒ½å„ªå‹¢

1. **é›¶ Session é–‹éŠ·**: ç„¡éœ€æŸ¥è©¢ Session å­˜å„²
2. **ç„¡ CSRF æª¢æŸ¥**: æ¶ˆé™¤ CSRF Token é©—è­‰æ­¥é©Ÿ
3. **Cache-Friendly**: ç„¡ç‹€æ…‹è¨­è¨ˆå¤©ç„¶æ”¯æ´ CDN å¿«å–
4. **è¨˜æ†¶é«”å„ªåŒ–**: ä¼ºæœå™¨ç„¡éœ€ä¿å­˜ä»»ä½• Session è³‡æ–™

#### ğŸ—ï¸ æ¶æ§‹å¯¦ç¾æ¨™æº–

**å¾Œç«¯é…ç½®æ¨™æº–**ï¼š
```php
// config/sanctum.php
'stateful' => [
    // ğŸš« Pure Bearer Token æ¨¡å¼ï¼šä¸éœ€è¦ä»»ä½•ç‹€æ…‹åŒ–åŸŸå
    // æ‰€æœ‰ API è«‹æ±‚éƒ½ä½¿ç”¨ Authorization: Bearer {token} æ¨™é ­
],

// config/session.php  
'driver' => 'array', // å®Œå…¨ç¦ç”¨ Session æŒä¹…åŒ–

// .env
SESSION_DRIVER=array
# ç„¡éœ€ SANCTUM_STATEFUL_DOMAINS é…ç½®
```

**å‰ç«¯å¯¦ç¾æ¨™æº–**ï¼š
```typescript
// ç´” Bearer Token å®¢æˆ¶ç«¯
const apiClient = createClient({
  baseUrl: 'http://localhost:8000/api',
  // âŒ ä¸ä½¿ç”¨ credentials: 'include' - ç´” Bearer Token ä¸éœ€è¦ Cookie
});

// è‡ªå‹• Token æ³¨å…¥
apiClient.use({
  onRequest({ request }) {
    const token = localStorage.getItem('auth_token');
    if (token) {
      request.headers.set('Authorization', `Bearer ${token}`);
    }
    return request;
  },
});
```

#### ğŸ“‹ é–‹ç™¼å¼·åˆ¶è¦æ±‚

1. **âŒ çµ•å°ç¦æ­¢**: ä»»ä½•å½¢å¼çš„ Session æˆ– Cookie ä¾è³´
2. **âœ… å¼·åˆ¶ä½¿ç”¨**: Authorization: Bearer {token} æ¨™é ­èªè­‰
3. **âœ… ç‹€æ…‹å­˜å„²**: åƒ…ä½¿ç”¨ localStorage é€²è¡Œå‰ç«¯ç‹€æ…‹æŒä¹…åŒ–  
4. **âœ… API è¨­è¨ˆ**: æ‰€æœ‰ç«¯é»å¿…é ˆæ”¯æ´ç„¡ç‹€æ…‹è«‹æ±‚
5. **âœ… éŒ¯èª¤è™•ç†**: 401 éŒ¯èª¤ç›´æ¥è¿”å› JSONï¼Œä¸å¾—é‡å®šå‘

#### ğŸ§ª æ¸¬è©¦è¦æ±‚

æ‰€æœ‰æ–°åŠŸèƒ½å¿…é ˆé€šéä»¥ä¸‹ Pure Bearer Token æ¸¬è©¦ï¼š
- âœ… API è«‹æ±‚ç„¡ Cookie ä¾è³´
- âœ… èªè­‰åƒ…é€é Authorization æ¨™é ­
- âœ… 401 éŒ¯èª¤è¿”å› JSON æ ¼å¼
- âœ… ç„¡ CSRF Token é©—è­‰é‚è¼¯
- âœ… ç‹€æ…‹å®Œå…¨ç”± localStorage ç®¡ç†

---

## ğŸ›ï¸ æ•´é«”æ¶æ§‹è¨­è¨ˆæ¨¡å¼

### ğŸ“ åˆ†å±¤æ¶æ§‹è¨­è¨ˆ

LomisX3 æ¡ç”¨åš´æ ¼çš„åˆ†å±¤æ¶æ§‹ï¼Œæ¯ä¸€å±¤éƒ½æœ‰æ˜ç¢ºçš„è·è²¬å’Œé‚Šç•Œï¼š

#### 1. **è¡¨ç¾å±¤ (Presentation Layer)**
- **å‰ç«¯**: React 19 + TypeScript + shadcn/ui
- **è·è²¬**: ç”¨æˆ¶ä»‹é¢ã€ç”¨æˆ¶äº¤äº’ã€ç‹€æ…‹ç®¡ç†
- **é€šä¿¡**: HTTP API èª¿ç”¨

#### 2. **æ‡‰ç”¨å±¤ (Application Layer)**
- **å¾Œç«¯**: Laravel Controllers + Middleware
- **è·è²¬**: è·¯ç”±è™•ç†ã€è«‹æ±‚é©—è­‰ã€æ¬Šé™æª¢æŸ¥
- **é€šä¿¡**: JSON API å›æ‡‰

#### 3. **æ¥­å‹™é‚è¼¯å±¤ (Business Logic Layer)**
- **å¾Œç«¯**: Service Classes
- **è·è²¬**: æ¥­å‹™è¦å‰‡ã€æµç¨‹æ§åˆ¶ã€äº‹å‹™ç®¡ç†
- **é€šä¿¡**: Repository ä»‹é¢èª¿ç”¨

#### 4. **è³‡æ–™å­˜å–å±¤ (Data Access Layer)**
- **å¾Œç«¯**: Repository Pattern
- **è·è²¬**: è³‡æ–™æŸ¥è©¢ã€æ•¸æ“šè½‰æ›ã€å¿«å–ç®¡ç†
- **é€šä¿¡**: Eloquent ORM

#### 5. **æŒä¹…åŒ–å±¤ (Persistence Layer)**
- **è³‡æ–™åº«**: MySQL 8.0 + Redis 7.0
- **è·è²¬**: è³‡æ–™å„²å­˜ã€æ•¸æ“šæŒä¹…åŒ–
- **é€šä¿¡**: SQL æŸ¥è©¢

### ğŸ”„ æ¨™æº–è¨­è¨ˆæ¨¡å¼å¯¦ç¾

#### 1. **Repository Pattern (å¼·åˆ¶å¯¦ç¾)**

æ‰€æœ‰æ•¸æ“šå­˜å–å¿…é ˆé€šé Repository æ¨¡å¼ï¼š

```php
<?php

namespace App\Repositories\Contracts;

/**
 * Repository åŸºç¤ä»‹é¢
 * æ‰€æœ‰ Repository å¿…é ˆå¯¦ç¾æ­¤ä»‹é¢
 */
interface BaseRepositoryInterface
{
    public function find(int $id, array $relations = []): ?Model;
    public function findOrFail(int $id, array $relations = []): Model;
    public function all(array $relations = []): Collection;
    public function paginate(int $perPage = 15, array $filters = []): LengthAwarePaginator;
    public function create(array $data): Model;
    public function update(int $id, array $data): Model;
    public function delete(int $id): bool;
    public function createMany(array $data): bool;
    public function updateMany(array $updates): bool;
    public function deleteMany(array $ids): bool;
}
```

#### 2. **Service Layer Pattern (å¼·åˆ¶å¯¦ç¾)**

æ‰€æœ‰æ¥­å‹™é‚è¼¯å¿…é ˆé€šé Service å±¤ï¼š

```php
<?php

namespace App\Services\Contracts;

/**
 * Service åŸºç¤ä»‹é¢
 * æ‰€æœ‰ Service å¿…é ˆå¯¦ç¾æ­¤ä»‹é¢
 */
interface BaseServiceInterface
{
    public function getList(array $filters = [], int $perPage = 15);
    public function getDetail(int $id);
    public function create(array $data);
    public function update(int $id, array $data);
    public function delete(int $id): bool;
}
```

#### 3. **Observer Pattern (å¼·åˆ¶å¯¦ç¾)**

æ‰€æœ‰æ¨¡å‹è®Šæ›´å¿…é ˆé€šé Observer è™•ç†ï¼š

```php
<?php

namespace App\Observers;

/**
 * Observer åŸºç¤é¡åˆ¥
 * æ‰€æœ‰ Observer å¿…é ˆç¹¼æ‰¿æ­¤é¡åˆ¥
 */
abstract class BaseObserver
{
    protected function beforeCreate(BaseModel $model): void;
    protected function afterCreate(BaseModel $model): void;
    protected function beforeUpdate(BaseModel $model): void;
    protected function afterUpdate(BaseModel $model): void;
    protected function beforeDelete(BaseModel $model): void;
    protected function afterDelete(BaseModel $model): void;
    protected function clearRelatedCache(BaseModel $model): void;
}
```

### ğŸ¯ ä¾è³´æ³¨å…¥æ¨™æº–

#### ServiceProvider è¨»å†Šæ¨¡å¼

æ¯å€‹æ¨¡çµ„å¿…é ˆå»ºç«‹å°ˆç”¨çš„ ServiceProviderï¼š

```php
<?php

namespace App\Providers;

use Illuminate\Support\ServiceProvider;

/**
 * æ¨¡çµ„æœå‹™æä¾›è€…
 * è² è²¬è¨»å†Šæ¨¡çµ„å…§çš„ä¾è³´æ³¨å…¥ç¶å®š
 */
class {ModuleName}ServiceProvider extends ServiceProvider
{
    public function register(): void
    {
        // Repository ç¶å®š
        $this->app->bind(
            {ModuleName}RepositoryInterface::class,
            {ModuleName}Repository::class
        );

        // Service ç¶å®š
        $this->app->bind(
            {ModuleName}ServiceInterface::class,
            {ModuleName}Service::class
        );
    }

    public function boot(): void
    {
        // è¨»å†Š Observer
        {ModuleName}::observe({ModuleName}Observer::class);
        
        // è¨»å†Š Policy
        Gate::policy({ModuleName}::class, {ModuleName}Policy::class);
    }
}
```

---

## ğŸ› ï¸ å¾Œç«¯æ¶æ§‹æ¨™æº–

### ğŸ—ï¸ Laravel æ‡‰ç”¨æ¶æ§‹

#### 0. **æ ¸å¿ƒæ“´å±•å¥—ä»¶ (Spatie Ecosystem) - å®˜æ–¹æ¨™æº–**

ç‚ºç¢ºä¿é–‹ç™¼æ•ˆç‡èˆ‡æ¥­ç•Œæ¨™æº–ä¸€è‡´æ€§ï¼Œæœ¬å°ˆæ¡ˆæŒ‡å®šä»¥ä¸‹ Spatie å¥—ä»¶ä½œç‚ºå°æ‡‰åŠŸèƒ½é ˜åŸŸçš„**å”¯ä¸€å®˜æ–¹è§£æ±ºæ–¹æ¡ˆ**ï¼Œåš´ç¦é‡è¤‡é€ è¼ªå­ï¼š

| åŠŸèƒ½é ˜åŸŸ | æŒ‡å®šå¥—ä»¶ | ç”¨é€”èªªæ˜ | æ•´åˆç‹€æ…‹ |
|----------|----------|----------|----------|
| **æ¬Šé™ç®¡ç†** | `spatie/laravel-permission` | è§’è‰²èˆ‡æ¬Šé™ç³»çµ±ï¼Œå·²æ•´åˆé–€å¸‚éš”é›¢æ©Ÿåˆ¶ | âœ… V6.2 å®Œæˆ |
| **æ´»å‹•æ—¥èªŒ** | `spatie/laravel-activitylog` | ä½¿ç”¨è€…æ“ä½œè¨˜éŒ„ï¼Œå·²æ•´åˆé–€å¸‚éš”é›¢èˆ‡éš±ç§ä¿è­· | âœ… V6.2 å®Œæˆ |
| **åª’é«”ç®¡ç†** | `spatie/laravel-medialibrary` | æª”æ¡ˆä¸Šå‚³ã€è½‰æ›ã€ç®¡ç†ï¼ˆé ­åƒã€é™„ä»¶ï¼‰ | âœ… V6.2 å®Œæˆ |
| **API æŸ¥è©¢** | `spatie/laravel-query-builder` | è¤‡é›œçš„åˆ—è¡¨ç¯©é¸ã€æ’åºå’Œé—œè¯æŸ¥è©¢ | âœ… æ¨™æº–å¯¦ç¾ |

**å¯¦æ–½åŸå‰‡ï¼š**
- **å¼·åˆ¶ä½¿ç”¨**ï¼šæ‰€æœ‰æ¶‰åŠä¸Šè¿°åŠŸèƒ½çš„é–‹ç™¼ï¼Œå¿…é ˆä½¿ç”¨æŒ‡å®šçš„ Spatie å¥—ä»¶
- **ç¦æ­¢æ›¿ä»£**ï¼šä¸å¾—ä½¿ç”¨å…¶ä»–åŒé¡å‹å¥—ä»¶æˆ–è‡ªè¡Œå¯¦ç¾
- **çµ±ä¸€é…ç½®**ï¼šæ‰€æœ‰ Spatie å¥—ä»¶çš„é…ç½®å¿…é ˆéµå¾ªå°ˆæ¡ˆçµ±ä¸€æ¨™æº–
- **æ•´åˆæ“´å±•**ï¼šéœ€è¦é¡å¤–åŠŸèƒ½æ™‚ï¼Œåœ¨ç¾æœ‰å¥—ä»¶åŸºç¤ä¸Šæ“´å±•ï¼Œä¸å¾—æ›´æ›

#### 1. **BaseModel å®‰å…¨è¨­è¨ˆ (å¼·åˆ¶ç¹¼æ‰¿)**

```php
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Builder;
use Illuminate\Database\Eloquent\SoftDeletes;

/**
 * å®‰å…¨æ¨¡å‹åŸºé¡
 * æ‰€æœ‰æ¥­å‹™æ¨¡å‹å¿…é ˆç¹¼æ‰¿æ­¤é¡åˆ¥
 */
abstract class BaseModel extends Model
{
    use SoftDeletes;

    /**
     * ä¸å¯æ‰¹é‡è³¦å€¼çš„æ¬„ä½ (å®‰å…¨é˜²è­·)
     */
    protected $guarded = [
        'id',
        'created_at',
        'updated_at',
        'deleted_at',
        'created_by',
        'updated_by',
        'store_id',
    ];

    /**
     * éš±è—çš„æ¬„ä½ (API å›æ‡‰ä¸­ä¸é¡¯ç¤º)
     */
    protected $hidden = [
        'deleted_at',
        'created_by',
        'updated_by',
    ];

    /**
     * å‹åˆ¥è½‰æ›
     */
    protected $casts = [
        'created_at' => 'datetime',
        'updated_at' => 'datetime',
        'deleted_at' => 'datetime',
    ];

    /**
     * å…¨åŸŸæŸ¥è©¢ç¯„åœ - è‡ªå‹•é–€å¸‚éæ¿¾
     */
    protected static function booted(): void
    {
        parent::booted();

        // è‡ªå‹•æ³¨å…¥é–€å¸‚ç¯„åœ
        static::addGlobalScope('store', function (Builder $builder) {
            if (auth()->check() && auth()->user()->store_id) {
                $builder->where('store_id', auth()->user()->store_id);
            }
        });
    }

    /**
     * æª¢æŸ¥æ˜¯å¦å±¬æ–¼ç•¶å‰ä½¿ç”¨è€…çš„é–€å¸‚
     */
    public function belongsToCurrentStore(): bool
    {
        return auth()->check() && $this->store_id === auth()->user()->store_id;
    }
}
```

#### 2. **Controller æ¨™æº–å¯¦ç¾**

```php
<?php

namespace App\Http\Controllers\Api;

use App\Http\Controllers\BaseController;

/**
 * API æ§åˆ¶å™¨æ¨™æº–å¯¦ç¾
 * æ‰€æœ‰ API Controller å¿…é ˆéµå¾ªæ­¤æ¨¡å¼
 */
class {ModuleName}Controller extends BaseController
{
    protected {ModuleName}ServiceInterface $service;

    public function __construct({ModuleName}ServiceInterface $service)
    {
        $this->service = $service;
        
        // æ¬Šé™ä¸­ä»‹è»Ÿé«” (å¿…é ˆåŒ…å«)
        $this->middleware('auth:sanctum');
        $this->middleware('permission:{module-name}.view')->only(['index', 'show']);
        $this->middleware('permission:{module-name}.create')->only(['store']);
        $this->middleware('permission:{module-name}.update')->only(['update']);
        $this->middleware('permission:{module-name}.delete')->only(['destroy']);
    }

    /**
     * æ¨™æº– CRUD æ–¹æ³• (å¿…é ˆå¯¦ç¾)
     */
    public function index(Index{ModuleName}Request $request): JsonResponse
    {
        $this->authorize('viewAny', {ModuleName}::class);
        
        $result = $this->service->getList($request->validated());
        
        return $this->success(
            new {ModuleName}Collection($result),
            'å–å¾—{ModuleName}åˆ—è¡¨æˆåŠŸ'
        );
    }

    public function store(Store{ModuleName}Request $request): JsonResponse
    {
        $this->authorize('create', {ModuleName}::class);
        
        $model = $this->service->create($request->validated());
        
        return $this->success(
            new {ModuleName}Resource($model),
            'å»ºç«‹{ModuleName}æˆåŠŸ',
            201
        );
    }

    public function show(int $id): JsonResponse
    {
        $model = $this->service->getDetail($id);
        $this->authorize('view', $model);
        
        return $this->success(
            new {ModuleName}Resource($model),
            'å–å¾—{ModuleName}è©³æƒ…æˆåŠŸ'
        );
    }

    public function update(Update{ModuleName}Request $request, int $id): JsonResponse
    {
        $model = $this->service->getDetail($id);
        $this->authorize('update', $model);
        
        $updatedModel = $this->service->update($id, $request->validated());
        
        return $this->success(
            new {ModuleName}Resource($updatedModel),
            'æ›´æ–°{ModuleName}æˆåŠŸ'
        );
    }

    public function destroy(int $id): JsonResponse
    {
        $model = $this->service->getDetail($id);
        $this->authorize('delete', $model);
        
        $this->service->delete($id);
        
        return $this->success(null, 'åˆªé™¤{ModuleName}æˆåŠŸ');
    }
}
```

#### 3. **Service å±¤å¯¦ç¾æ¨™æº–**

```php
<?php

namespace App\Services;

use App\Services\Contracts\BaseServiceInterface;
use App\Repositories\Contracts\BaseRepositoryInterface;
use Illuminate\Support\Facades\DB;

/**
 * Service åŸºç¤å¯¦ç¾é¡åˆ¥
 * æ‰€æœ‰ Service å¿…é ˆç¹¼æ‰¿æ­¤é¡åˆ¥
 */
abstract class BaseService implements BaseServiceInterface
{
    protected BaseRepositoryInterface $repository;

    public function __construct(BaseRepositoryInterface $repository)
    {
        $this->repository = $repository;
    }

    /**
     * åŸ·è¡Œäº‹å‹™æ“ä½œ (æ‰€æœ‰å¯«æ“ä½œå¿…é ˆä½¿ç”¨)
     */
    protected function executeInTransaction(callable $operation)
    {
        return DB::transaction(function () use ($operation) {
            try {
                return $operation();
            } catch (\Exception $e) {
                Log::error('Service æ“ä½œå¤±æ•—', [
                    'service' => static::class,
                    'error' => $e->getMessage(),
                ]);
                throw $e;
            }
        });
    }

    /**
     * æ¥­å‹™è¦å‰‡é©—è­‰ (å­é¡åˆ¥å¯è¦†å¯«)
     */
    protected function validateBusinessRules(array $data, ?int $id = null): void
    {
        // åŸºç¤é©—è­‰é‚è¼¯
    }

    /**
     * æ¨™æº–å»ºç«‹æµç¨‹
     */
    public function create(array $data)
    {
        return $this->executeInTransaction(function () use ($data) {
            $this->validateBusinessRules($data);
            $this->beforeCreate($data);
            
            $model = $this->repository->create($data);
            
            $this->afterCreate($model, $data);
            
            return $model;
        });
    }

    // å…¶ä»–æ¨™æº–æ–¹æ³•...
    protected function beforeCreate(array &$data): void {}
    protected function afterCreate($model, array $data): void {}
}
```

### ğŸ›¡ï¸ éŒ¯èª¤è™•ç†èˆ‡ä¾‹å¤–ç®¡ç†

#### çµ±ä¸€éŒ¯èª¤è™•ç†æ©Ÿåˆ¶

```php
<?php

namespace App\Exceptions;

use Exception;

/**
 * æ¥­å‹™é‚è¼¯ä¾‹å¤–
 * æ‰€æœ‰æ¥­å‹™éŒ¯èª¤å¿…é ˆä½¿ç”¨æ­¤ä¾‹å¤–
 */
class BusinessException extends Exception
{
    protected $errorCode;
    protected $httpStatus;

    public function __construct(
        string $message,
        string $errorCode = 'BUSINESS_ERROR',
        int $httpStatus = 400,
        ?Throwable $previous = null
    ) {
        $this->errorCode = $errorCode;
        $this->httpStatus = $httpStatus;
        
        parent::__construct($message, 0, $previous);
    }

    public function getErrorCode(): string
    {
        return $this->errorCode;
    }

    public function getHttpStatus(): int
    {
        return $this->httpStatus;
    }
}
```

```php
<?php

namespace App\Enums;

/**
 * éŒ¯èª¤ä»£ç¢¼æšèˆ‰
 * çµ±ä¸€ç®¡ç†æ‰€æœ‰éŒ¯èª¤ä»£ç¢¼
 */
enum ErrorCode: string
{
    case VALIDATION_FAILED = 'VALIDATION_FAILED';
    case UNAUTHORIZED = 'UNAUTHORIZED';
    case FORBIDDEN = 'FORBIDDEN';
    case NOT_FOUND = 'NOT_FOUND';
    case DUPLICATE_ENTRY = 'DUPLICATE_ENTRY';
    case BUSINESS_RULE_VIOLATION = 'BUSINESS_RULE_VIOLATION';
    case EXTERNAL_SERVICE_ERROR = 'EXTERNAL_SERVICE_ERROR';
    
    public function message(): string
    {
        return match($this) {
            self::VALIDATION_FAILED => 'è³‡æ–™é©—è­‰å¤±æ•—',
            self::UNAUTHORIZED => 'æœªæˆæ¬Šçš„è«‹æ±‚',
            self::FORBIDDEN => 'æ¬Šé™ä¸è¶³',
            self::NOT_FOUND => 'è³‡æºä¸å­˜åœ¨',
            self::DUPLICATE_ENTRY => 'è³‡æ–™é‡è¤‡',
            self::BUSINESS_RULE_VIOLATION => 'é•åæ¥­å‹™è¦å‰‡',
            self::EXTERNAL_SERVICE_ERROR => 'å¤–éƒ¨æœå‹™éŒ¯èª¤',
        };
    }
}
```

---

## ğŸ” å¤šç§Ÿæˆ¶æ¶æ§‹è¨­è¨ˆ

### ğŸ¢ é–€å¸‚éš”é›¢åŸå‰‡

LomisX3 æ¡ç”¨åŸºæ–¼é–€å¸‚ï¼ˆStoreï¼‰çš„å¤šç§Ÿæˆ¶æ¶æ§‹ï¼Œç¢ºä¿è³‡æ–™å®Œå…¨éš”é›¢ï¼š

#### æ ¸å¿ƒéš”é›¢æ©Ÿåˆ¶

1. **è³‡æ–™åº«å±¤ç´šéš”é›¢**: æ‰€æœ‰æ¥­å‹™è¡¨æ ¼åŒ…å« `store_id` æ¬„ä½
2. **æ‡‰ç”¨å±¤ç´šéš”é›¢**: Model è‡ªå‹•æ³¨å…¥é–€å¸‚ç¯„åœéæ¿¾
3. **API å±¤ç´šéš”é›¢**: Controller è‡ªå‹•æª¢æŸ¥é–€å¸‚æ¬Šé™
4. **å‰ç«¯å±¤ç´šéš”é›¢**: çµ„ä»¶è‡ªå‹•éæ¿¾é–€å¸‚è³‡æ–™

#### é–€å¸‚ç¯„åœè‡ªå‹•æ³¨å…¥

```php
<?php

// åœ¨ BaseModel ä¸­è‡ªå‹•æ³¨å…¥
static::addGlobalScope('store', function (Builder $builder) {
    if (auth()->check() && auth()->user()->store_id) {
        $builder->where('store_id', auth()->user()->store_id);
    }
});
```

### ğŸ”‘ æ¬Šé™ç³»çµ±æ¶æ§‹

#### è§’è‰²æ¬Šé™å°æ‡‰è¡¨

```php
<?php

namespace App\Enums;

/**
 * ç³»çµ±è§’è‰²æšèˆ‰
 * å®šç¾©æ‰€æœ‰å¯ç”¨çš„ä½¿ç”¨è€…è§’è‰²
 */
enum UserRole: string
{
    case SUPER_ADMIN = 'super_admin';           // è¶…ç´šç®¡ç†å“¡
    case STORE_ADMIN = 'store_admin';           // é–€å¸‚ç®¡ç†å“¡
    case PRODUCT_MANAGER = 'product_manager';   // å•†å“ç®¡ç†å“¡
    case ORDER_MANAGER = 'order_manager';       // è¨‚å–®ç®¡ç†å“¡
    case CUSTOMER_SERVICE = 'customer_service'; // å®¢æœäººå“¡
    case EMPLOYEE = 'employee';                 // ä¸€èˆ¬å“¡å·¥

    /**
     * å–å¾—è§’è‰²æ¬Šé™
     */
    public function getPermissions(): array
    {
        return match($this) {
            self::SUPER_ADMIN => [
                'users.*',
                'product-categories.*',
                'products.*',
                'orders.*',
                'stores.*',
                'analytics.*',
            ],
            self::STORE_ADMIN => [
                'users.view', 'users.create', 'users.update',
                'product-categories.*',
                'products.*',
                'orders.*',
                'stores.view', 'stores.update',
                'analytics.*',
            ],
            self::PRODUCT_MANAGER => [
                'product-categories.*',
                'products.*',
                'orders.view',
                'analytics.products',
            ],
            // ... å…¶ä»–è§’è‰²æ¬Šé™
        };
    }
}
```

#### Policy æ¨™æº–å¯¦ç¾

```php
<?php

namespace App\Policies;

use App\Models\User;
use Illuminate\Database\Eloquent\Model;

/**
 * æ¬Šé™ç­–ç•¥åŸºé¡
 * æ‰€æœ‰æ¨¡çµ„çš„ Policy å¿…é ˆç¹¼æ‰¿æ­¤é¡åˆ¥
 */
abstract class BasePolicy
{
    /**
     * é€šç”¨çš„æª¢è¦–æ¬Šé™æª¢æŸ¥
     */
    protected function canView(User $user, string $permission, ?Model $model = null): bool
    {
        if (!$user->can($permission)) {
            return false;
        }

        if ($model && !$this->belongsToUserStore($user, $model)) {
            return false;
        }

        return true;
    }

    /**
     * æª¢æŸ¥è³‡æºæ˜¯å¦å±¬æ–¼ä½¿ç”¨è€…é–€å¸‚
     */
    protected function belongsToUserStore(User $user, Model $model): bool
    {
        if (!$model->hasAttribute('store_id')) {
            return true;
        }

        return $user->store_id === $model->store_id;
    }

    /**
     * æª¢æŸ¥ä½¿ç”¨è€…æ˜¯å¦ç‚ºè¶…ç´šç®¡ç†å“¡
     */
    protected function isSuperAdmin(User $user): bool
    {
        return $user->hasRole('super_admin');
    }
}
```

---

## ğŸ—„ï¸ è³‡æ–™åº«æ¶æ§‹è¨­è¨ˆ

### ğŸ“‹ è¡¨æ ¼è¨­è¨ˆè¦ç¯„

#### åŸºç¤æ¬„ä½æ¨™æº–

æ‰€æœ‰æ¥­å‹™è¡¨æ ¼å¿…é ˆåŒ…å«çš„åŸºç¤æ¬„ä½ï¼š

```sql
-- æ¨™æº–æ¥­å‹™è¡¨æ ¼çµæ§‹
CREATE TABLE {table_name} (
    -- ä¸»éµ (çµ±ä¸€ä½¿ç”¨ BIGINT UNSIGNED)
    id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    
    -- é–€å¸‚éš”é›¢æ¬„ä½ (å¿…é ˆ)
    store_id BIGINT UNSIGNED NOT NULL,
    
    -- æ¥­å‹™æ¬„ä½ (æ ¹æ“šéœ€æ±‚è¨­è¨ˆ)
    name VARCHAR(255) NOT NULL COMMENT 'åç¨±',
    slug VARCHAR(255) NOT NULL COMMENT 'URL å‹å–„è­˜åˆ¥ç¢¼',
    description TEXT COMMENT 'æè¿°',
    status BOOLEAN DEFAULT TRUE COMMENT 'ç‹€æ…‹ (å•Ÿç”¨/åœç”¨)',
    position INTEGER DEFAULT 0 COMMENT 'æ’åºä½ç½®',
    
    -- å¯©è¨ˆæ¬„ä½ (æ¨è–¦åŒ…å«)
    created_by BIGINT UNSIGNED COMMENT 'å»ºç«‹è€… ID',
    updated_by BIGINT UNSIGNED COMMENT 'æ›´æ–°è€… ID',
    
    -- æ™‚é–“æˆ³è¨˜ (å¿…é ˆ)
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT 'å»ºç«‹æ™‚é–“',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ™‚é–“',
    deleted_at TIMESTAMP NULL COMMENT 'è»Ÿåˆªé™¤æ™‚é–“',
    
    -- ç´¢å¼•è¨­è¨ˆ
    INDEX idx_store_status (store_id, status),
    INDEX idx_store_position (store_id, position),
    INDEX idx_slug (slug),
    UNIQUE KEY uk_store_slug (store_id, slug),
    
    -- å¤–éµç´„æŸ
    FOREIGN KEY (store_id) REFERENCES stores(id) ON DELETE CASCADE,
    FOREIGN KEY (created_by) REFERENCES users(id) ON DELETE SET NULL,
    FOREIGN KEY (updated_by) REFERENCES users(id) ON DELETE SET NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='æ¥­å‹™è¡¨æ ¼';
```

#### éšå±¤å¼çµæ§‹è¨­è¨ˆ

```sql
-- éšå±¤å¼è³‡æ–™çµæ§‹ (å¦‚å•†å“åˆ†é¡)
CREATE TABLE hierarchical_table (
    id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    store_id BIGINT UNSIGNED NOT NULL,
    
    -- éšå±¤æ¬„ä½
    parent_id BIGINT UNSIGNED NULL COMMENT 'çˆ¶ç¯€é» ID',
    path VARCHAR(500) NOT NULL DEFAULT '/' COMMENT 'ç¯€é»è·¯å¾‘',
    depth TINYINT UNSIGNED DEFAULT 0 COMMENT 'ç¯€é»æ·±åº¦',
    position INTEGER DEFAULT 0 COMMENT 'åŒå±¤æ’åº',
    
    -- æ¥­å‹™æ¬„ä½
    name VARCHAR(255) NOT NULL,
    slug VARCHAR(255) NOT NULL,
    description TEXT,
    status BOOLEAN DEFAULT TRUE,
    
    -- çµ±è¨ˆæ¬„ä½ (å¯é¸)
    children_count INTEGER DEFAULT 0 COMMENT 'ç›´æ¥å­ç¯€é»æ•¸é‡',
    descendants_count INTEGER DEFAULT 0 COMMENT 'æ‰€æœ‰å¾Œä»£ç¯€é»æ•¸é‡',
    
    -- åŸºç¤æ™‚é–“æˆ³è¨˜
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    deleted_at TIMESTAMP NULL,
    
    -- éšå±¤å¼ç´¢å¼•è¨­è¨ˆ
    INDEX idx_store_parent (store_id, parent_id),
    INDEX idx_store_depth (store_id, depth),
    INDEX idx_store_position (store_id, parent_id, position),
    INDEX idx_path (path),
    UNIQUE KEY uk_store_slug (store_id, slug),
    
    -- å¤–éµç´„æŸ
    FOREIGN KEY (store_id) REFERENCES stores(id) ON DELETE CASCADE,
    FOREIGN KEY (parent_id) REFERENCES hierarchical_table(id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
```

### ğŸ“Š ç´¢å¼•è¨­è¨ˆæ¨™æº–

#### ç´¢å¼•è¨­è¨ˆåŸå‰‡

1. **ä¸»éµç´¢å¼•**: çµ±ä¸€ä½¿ç”¨ `BIGINT UNSIGNED AUTO_INCREMENT`
2. **é–€å¸‚ç´¢å¼•**: æ‰€æœ‰æŸ¥è©¢éƒ½æœƒå¸¶ `store_id`ï¼Œå¿…é ˆå»ºç«‹ç›¸é—œè¤‡åˆç´¢å¼•
3. **ç‹€æ…‹ç´¢å¼•**: `(store_id, status)` è¤‡åˆç´¢å¼•ï¼Œæ”¯æ´ç‹€æ…‹ç¯©é¸
4. **æ’åºç´¢å¼•**: `(store_id, position)` æˆ– `(store_id, created_at)` æ”¯æ´æ’åº
5. **æœå°‹ç´¢å¼•**: å…¨æ–‡æœå°‹æ¬„ä½ä½¿ç”¨ `FULLTEXT` ç´¢å¼•
6. **å”¯ä¸€ç´¢å¼•**: æ¥­å‹™å”¯ä¸€æ¬„ä½ä½¿ç”¨ `(store_id, slug)` è¤‡åˆå”¯ä¸€ç´¢å¼•

#### ç´¢å¼•å‘½åè¦ç¯„

```sql
-- ç´¢å¼•å‘½åè¦ç¯„
INDEX idx_{table}_{column}                    -- å–®æ¬„ä½ç´¢å¼•
INDEX idx_{table}_{column1}_{column2}         -- è¤‡åˆç´¢å¼•
UNIQUE KEY uk_{table}_{column}                -- å”¯ä¸€ç´¢å¼•
FOREIGN KEY fk_{table}_{ref_table}            -- å¤–éµç´„æŸ
FULLTEXT KEY ft_{table}_{column}              -- å…¨æ–‡ç´¢å¼•
```

### ğŸ’¡ è»Ÿåˆªé™¤å”¯ä¸€æ€§ç´„æŸè§£æ±ºæ–¹æ¡ˆ (V6.2 å‰µæ–°æ¨¡å¼)

**å•é¡Œæè¿°ï¼š**
å‚³çµ±è»Ÿåˆªé™¤å¯¦ç¾ä¸­ï¼Œç•¶ä½¿ç”¨è€…è¢«è»Ÿåˆªé™¤å¾Œï¼Œå…¶ `username` æˆ– `email` ç­‰å”¯ä¸€æ¬„ä½ç„¡æ³•è¢«æ–°ä½¿ç”¨è€…é‡æ–°è¨»å†Šï¼Œé€™é™åˆ¶äº†è³‡æºçš„é‡è¤‡åˆ©ç”¨ã€‚

**V6.2 å‰µæ–°è§£æ±ºæ–¹æ¡ˆï¼šMySQL è¨ˆç®—æ¬„ä½ (Generated Column)**

æ­¤æ–¹æ¡ˆåœ¨è³‡æ–™åº«å±¤ç´šå®Œç¾è§£æ±ºè»Ÿåˆªé™¤èˆ‡å”¯ä¸€æ€§ç´„æŸçš„è¡çªï¼Œå·²æˆç‚ºå°ˆæ¡ˆæ¨™æº–æ¨¡å¼ï¼š

```sql
-- V6.2 è»Ÿåˆªé™¤å”¯ä¸€æ€§ç´„æŸæ¨™æº–å¯¦ç¾
CREATE TABLE users (
    id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    store_id BIGINT UNSIGNED NOT NULL,
    
    -- åŸå§‹æ¥­å‹™æ¬„ä½
    username VARCHAR(255) NOT NULL COMMENT 'ä½¿ç”¨è€…åç¨±',
    email VARCHAR(255) NOT NULL COMMENT 'é›»å­éƒµä»¶',
    
    -- V6.2 å‰µæ–°ï¼šè¨ˆç®—æ¬„ä½å¯¦ç¾è»Ÿåˆªé™¤å”¯ä¸€æ€§
    username_active VARCHAR(255) GENERATED ALWAYS AS (
        IF(deleted_at IS NULL, 
           username, 
           CONCAT(username, '_deleted_', UNIX_TIMESTAMP(deleted_at))
        )
    ) STORED COMMENT 'è»Ÿåˆªé™¤å®‰å…¨çš„ä½¿ç”¨è€…åç¨±',
    
    email_active VARCHAR(255) GENERATED ALWAYS AS (
        IF(deleted_at IS NULL, 
           email, 
           CONCAT(email, '_deleted_', UNIX_TIMESTAMP(deleted_at))
        )
    ) STORED COMMENT 'è»Ÿåˆªé™¤å®‰å…¨çš„é›»å­éƒµä»¶',
    
    -- å…¶ä»–æ¬„ä½...
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    deleted_at TIMESTAMP NULL,
    
    -- V6.2 å‰µæ–°ï¼šå°è¨ˆç®—æ¬„ä½å»ºç«‹å”¯ä¸€ç´¢å¼•
    UNIQUE KEY uk_user_username_active (store_id, username_active),
    UNIQUE KEY uk_user_email_active (store_id, email_active),
    
    -- å‚³çµ±ç´¢å¼•ä¿ç•™
    INDEX idx_username (username),
    INDEX idx_email (email),
    INDEX idx_store_status (store_id, deleted_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
```

**Migration å¯¦ç¾ç¯„ä¾‹ï¼š**

```php
<?php
// V6.2 è»Ÿåˆªé™¤å”¯ä¸€æ€§ç´„æŸ Migration æ¨™æº–å¯¦ç¾

return new class extends Migration
{
    public function up(): void
    {
        Schema::create('users', function (Blueprint $table) {
            $table->id()->comment('ä¸»éµ ID');
            $table->foreignId('store_id')->constrained()->comment('é–€å¸‚ ID');
            
            // åŸå§‹æ¥­å‹™æ¬„ä½
            $table->string('username')->comment('ä½¿ç”¨è€…åç¨±');
            $table->string('email')->comment('é›»å­éƒµä»¶');
            
            // å…¶ä»–æ¬„ä½...
            $table->timestamps();
            $table->softDeletes();
            
            // å‚³çµ±ç´¢å¼•
            $table->index('username');
            $table->index('email');
        });
        
        // V6.2 å‰µæ–°ï¼šä½¿ç”¨ raw SQL æ·»åŠ è¨ˆç®—æ¬„ä½å’Œå”¯ä¸€ç´¢å¼•
        DB::statement("
            ALTER TABLE users 
            ADD COLUMN username_active VARCHAR(255) 
            GENERATED ALWAYS AS (
                IF(deleted_at IS NULL, 
                   username, 
                   CONCAT(username, '_deleted_', UNIX_TIMESTAMP(deleted_at))
                )
            ) STORED COMMENT 'è»Ÿåˆªé™¤å®‰å…¨çš„ä½¿ç”¨è€…åç¨±'
        ");
        
        DB::statement("
            ALTER TABLE users 
            ADD COLUMN email_active VARCHAR(255) 
            GENERATED ALWAYS AS (
                IF(deleted_at IS NULL, 
                   email, 
                   CONCAT(email, '_deleted_', UNIX_TIMESTAMP(deleted_at))
                )
            ) STORED COMMENT 'è»Ÿåˆªé™¤å®‰å…¨çš„é›»å­éƒµä»¶'
        ");
        
        // å°è¨ˆç®—æ¬„ä½å»ºç«‹å”¯ä¸€ç´¢å¼•
        DB::statement("
            ALTER TABLE users 
            ADD UNIQUE INDEX uk_user_username_active (store_id, username_active)
        ");
        
        DB::statement("
            ALTER TABLE users 
            ADD UNIQUE INDEX uk_user_email_active (store_id, email_active)
        ");
    }

    public function down(): void
    {
        Schema::dropIfExists('users');
    }
};
```

**æŠ€è¡“å„ªå‹¢ï¼š**
- âœ… **100% è³‡æ–™åº«å±¤é¢è§£æ±ºæ–¹æ¡ˆ**ï¼šæ‡‰ç”¨ç¨‹å¼å®Œå…¨ç„¡æ„ŸçŸ¥ï¼Œç„¡éœ€é¡å¤–é‚è¼¯
- âœ… **é«˜æ•ˆèƒ½**ï¼šè¨ˆç®—æ¬„ä½å„²å­˜ç‚º STOREDï¼ŒæŸ¥è©¢é€Ÿåº¦èˆ‡ä¸€èˆ¬æ¬„ä½ç›¸åŒ
- âœ… **è‡ªå‹•ç¶­è­·**ï¼šè³‡æ–™åº«è‡ªå‹•ç¶­è­·è¨ˆç®—æ¬„ä½å€¼ï¼Œç„¡éœ€æ‰‹å‹•æ›´æ–°
- âœ… **å‘å¾Œç›¸å®¹**ï¼šä¸å½±éŸ¿ç¾æœ‰æ¥­å‹™é‚è¼¯å’ŒæŸ¥è©¢
- âœ… **è³‡æºé‡ç”¨**ï¼šè»Ÿåˆªé™¤å¾Œï¼Œç›¸åŒç”¨æˆ¶å/éƒµç®±å¯ç«‹å³é‡æ–°è¨»å†Š

**é©ç”¨å ´æ™¯ï¼š**
æ­¤æ¨¡å¼é©ç”¨æ–¼æ‰€æœ‰éœ€è¦ã€Œè»Ÿåˆªé™¤ + å”¯ä¸€ç´„æŸã€çš„æ¬„ä½ï¼Œå¦‚ï¼š
- ä½¿ç”¨è€…ç®¡ç†ï¼š`username`, `email`, `phone`
- å•†å“ç®¡ç†ï¼š`sku`, `barcode`
- é–€å¸‚ç®¡ç†ï¼š`code`, `tax_number`

**æ¨™æº–åŒ–è¦æ±‚ï¼š**
æ‰€æœ‰æ¶‰åŠè»Ÿåˆªé™¤å”¯ä¸€æ€§ç´„æŸçš„æ–°æ¨¡çµ„ï¼Œ**å¿…é ˆ**æ¡ç”¨æ­¤ V6.2 æ¨¡å¼ï¼Œç¦æ­¢ä½¿ç”¨å…¶ä»–è§£æ±ºæ–¹æ¡ˆã€‚

### ğŸ”„ Migration æ¨™æº–

```php
<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

/**
 * Migration æ¨™æº–å¯¦ç¾
 * æ‰€æœ‰ Migration å¿…é ˆéµå¾ªæ­¤æ ¼å¼
 */
return new class extends Migration
{
    /**
     * åŸ·è¡Œ Migration
     */
    public function up(): void
    {
        Schema::create('{table_name}', function (Blueprint $table) {
            // ä¸»éµ
            $table->id()->comment('ä¸»éµ ID');
            
            // é–€å¸‚éš”é›¢ (å¿…é ˆ)
            $table->foreignId('store_id')
                  ->constrained('stores')
                  ->onDelete('cascade')
                  ->comment('é–€å¸‚ ID');
            
            // æ¥­å‹™æ¬„ä½
            $table->string('name')->comment('åç¨±');
            $table->string('slug')->comment('URL è­˜åˆ¥ç¢¼');
            $table->text('description')->nullable()->comment('æè¿°');
            $table->boolean('status')->default(true)->comment('ç‹€æ…‹');
            $table->integer('position')->default(0)->comment('æ’åºä½ç½®');
            
            // å¯©è¨ˆæ¬„ä½
            $table->foreignId('created_by')
                  ->nullable()
                  ->constrained('users')
                  ->onDelete('set null')
                  ->comment('å»ºç«‹è€… ID');
                  
            $table->foreignId('updated_by')
                  ->nullable()
                  ->constrained('users')
                  ->onDelete('set null')
                  ->comment('æ›´æ–°è€… ID');
            
            // æ™‚é–“æˆ³è¨˜
            $table->timestamps();
            $table->softDeletes();
            
            // ç´¢å¼•è¨­è¨ˆ
            $table->index(['store_id', 'status'], 'idx_store_status');
            $table->index(['store_id', 'position'], 'idx_store_position');
            $table->index('slug', 'idx_slug');
            $table->unique(['store_id', 'slug'], 'uk_store_slug');
        });
    }

    /**
     * å›æ»¾ Migration
     */
    public function down(): void
    {
        Schema::dropIfExists('{table_name}');
    }
};
```

---

## ğŸŒ RESTful API è¨­è¨ˆ

### ğŸ“‹ API è¨­è¨ˆåŸå‰‡

#### è³‡æºå‘½åè¦ç¯„

| HTTP Method | URI Pattern | æ§åˆ¶å™¨æ–¹æ³• | ç”¨é€”èªªæ˜ |
|-------------|-------------|------------|----------|
| `GET` | `/api/{resources}` | `index()` | å–å¾—è³‡æºåˆ—è¡¨ |
| `POST` | `/api/{resources}` | `store()` | å»ºç«‹æ–°è³‡æº |
| `GET` | `/api/{resources}/{id}` | `show()` | å–å¾—å–®ä¸€è³‡æº |
| `PUT/PATCH` | `/api/{resources}/{id}` | `update()` | æ›´æ–°è³‡æº |
| `DELETE` | `/api/{resources}/{id}` | `destroy()` | åˆªé™¤è³‡æº |

#### è‡ªè¨‚ç«¯é»è¦ç¯„

```php
// çµ±è¨ˆè³‡è¨Š
GET    /api/{resources}/statistics

// æ¨¹ç‹€çµæ§‹  
GET    /api/{resources}/tree

// æ‰¹æ¬¡æ“ä½œ
PATCH  /api/{resources}/batch-update
DELETE /api/{resources}/batch-delete

// é—œè¯è³‡æº
GET    /api/{resources}/{id}/children
GET    /api/{resources}/{id}/ancestors

// ç‰¹æ®ŠåŠŸèƒ½
POST   /api/{resources}/import
GET    /api/{resources}/export
POST   /api/{resources}/{id}/duplicate
```

### ğŸ“Š API å›æ‡‰æ ¼å¼

#### æˆåŠŸå›æ‡‰æ ¼å¼

```json
{
  "success": true,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    // å¯¦éš›è³‡æ–™å…§å®¹
  },
  "meta": {
    // å…ƒè³‡æ–™ (åˆ†é ã€çµ±è¨ˆç­‰)
  },
  "timestamp": "2025-01-07T10:00:00.000000Z"
}
```

#### éŒ¯èª¤å›æ‡‰æ ¼å¼

```json
{
  "success": false,
  "message": "æ“ä½œå¤±æ•—çš„èªªæ˜",
  "error_code": "BUSINESS_ERROR_CODE",
  "errors": {
    // è©³ç´°éŒ¯èª¤è³‡è¨Š (é©—è­‰éŒ¯èª¤ç­‰)
  },
  "timestamp": "2025-01-07T10:00:00.000000Z"
}
```

#### åˆ†é å›æ‡‰æ ¼å¼

```json
{
  "success": true,
  "message": "å–å¾—è³‡æ–™æˆåŠŸ",
  "data": [
    // è³‡æ–™é™£åˆ—
  ],
  "links": {
    "first": "http://example.com/api/resources?page=1",
    "last": "http://example.com/api/resources?page=10",
    "prev": null,
    "next": "http://example.com/api/resources?page=2"
  },
  "meta": {
    "current_page": 1,
    "from": 1,
    "last_page": 10,
    "per_page": 20,
    "to": 20,
    "total": 200
  },
  "timestamp": "2025-01-07T10:00:00.000000Z"
}
```

### ğŸ“ Request é©—è­‰æ¨™æº–

```php
<?php

namespace App\Http\Requests\{ModuleName};

use Illuminate\Foundation\Http\FormRequest;

/**
 * Request é©—è­‰æ¨™æº–å¯¦ç¾
 * æ‰€æœ‰ Request å¿…é ˆéµå¾ªæ­¤æ ¼å¼
 */
class Store{ModuleName}Request extends FormRequest
{
    /**
     * æˆæ¬Šæª¢æŸ¥
     */
    public function authorize(): bool
    {
        return auth()->check();
    }

    /**
     * é©—è­‰è¦å‰‡
     */
    public function rules(): array
    {
        return [
            'name' => ['required', 'string', 'max:255'],
            'slug' => [
                'nullable',
                'string', 
                'max:255',
                'regex:/^[a-z0-9-]+$/',
                'unique:table_name,slug,NULL,id,store_id,' . auth()->user()->store_id
            ],
            'description' => ['nullable', 'string', 'max:65535'],
            'status' => ['boolean'],
            'position' => ['integer', 'min:0'],
        ];
    }

    /**
     * è‡ªè¨‚éŒ¯èª¤è¨Šæ¯
     */
    public function messages(): array
    {
        return [
            'name.required' => 'åç¨±ç‚ºå¿…å¡«æ¬„ä½',
            'name.max' => 'åç¨±ä¸èƒ½è¶…é 255 å€‹å­—å…ƒ',
            'slug.regex' => 'URL è­˜åˆ¥ç¢¼åªèƒ½åŒ…å«å°å¯«å­—æ¯ã€æ•¸å­—å’Œé€£å­—è™Ÿ',
            'slug.unique' => 'æ­¤ URL è­˜åˆ¥ç¢¼å·²è¢«ä½¿ç”¨',
        ];
    }

    /**
     * è³‡æ–™é è™•ç†
     */
    protected function prepareForValidation(): void
    {
        // è‡ªå‹•ç”Ÿæˆ slug
        if (!$this->slug && $this->name) {
            $this->merge([
                'slug' => Str::slug($this->name)
            ]);
        }

        // è‡ªå‹•å¡«å……é–€å¸‚ ID
        $this->merge([
            'store_id' => auth()->user()->store_id
        ]);
    }
}
```

---

## ğŸŒ API åˆç´„èˆ‡çœŸå¯¦æ€§é©—è­‰ (V4.0 å¼·åˆ¶)

### ğŸ¯ API åˆç´„æ¸¬è©¦çš„é‡è¦æ€§

LomisX3 V4.0 å¼•å…¥äº†**å¼·åˆ¶æ€§ API åˆç´„æ¸¬è©¦**ï¼Œç¢ºä¿ OpenAPI è¦ç¯„èˆ‡å¯¦éš› API å¯¦ç¾çš„å®Œå…¨ä¸€è‡´æ€§ã€‚é€™è§£æ±ºäº†å‰ç«¯ TypeScript å‹åˆ¥èˆ‡å¾Œç«¯å¯¦éš›å›æ‡‰ä¸åŒ¹é…çš„æ ¹æœ¬å•é¡Œã€‚

#### **å•é¡Œå ´æ™¯**

```typescript
// å‰ç«¯åŸºæ–¼ OpenAPI ç”Ÿæˆçš„å‹åˆ¥æœŸæœ›
interface User {
  id: number;
  name: string;
  email: string;
  roles: string[];  // å‹åˆ¥æœŸæœ›é™£åˆ—
}

// ä½†å¾Œç«¯å¯¦éš›è¿”å›
{
  "id": 1,
  "name": "æ¸¬è©¦ç”¨æˆ¶",
  "email": "test@example.com",
  "roles": "admin,user"  // å¯¦éš›æ˜¯å­—ä¸²ï¼Œå°è‡´å‰ç«¯éŒ¯èª¤
}
```

### ğŸ”’ å¼·åˆ¶åˆç´„æ¸¬è©¦è¦ç¯„

#### 1. **CI/CD ä¸­çš„åˆç´„é©—è­‰**

```yaml
# .github/workflows/api-contract-test.yml
name: API Contract Testing

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  contract-test:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup PHP
        uses: shivammathur/setup-php@v2
        with:
          php-version: '8.2'

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Install dependencies
        run: |
          cd back && composer install --no-dev
          cd front && npm ci

      - name: Start Laravel server
        run: |
          cd back
          php artisan serve &
          sleep 5

      - name: Generate OpenAPI spec
        run: |
          cd back
          php artisan scribe:generate --no-extraction

      - name: Run contract tests
        run: |
          cd front
          npm run test:api-contract

      - name: Validate OpenAPI consistency
        run: |
          node scripts/validate-api-contract.js
```

#### 2. **å‰ç«¯åˆç´„æ¸¬è©¦å¯¦ç¾**

```typescript
// tests/api-contract/contract-validator.test.ts
import { describe, it, expect, beforeAll } from 'vitest';
import { apiClient } from '@/lib/api-client';
import type { paths } from '@/types/api';

/**
 * API åˆç´„æ¸¬è©¦å¥—ä»¶
 * ç¢ºä¿ OpenAPI è¦ç¯„èˆ‡å¯¦éš› API å›æ‡‰ä¸€è‡´
 */
describe('API Contract Validation', () => {
  beforeAll(async () => {
    // è¨­ç½®æ¸¬è©¦ç’°å¢ƒï¼ŒåŒ…å«èªè­‰
    await setupTestAuth();
  });

  describe('User Management API', () => {
    it('GET /api/users å›æ‡‰æ ¼å¼ç¬¦åˆè¦ç¯„', async () => {
      const { data, error } = await apiClient.GET('/api/users', {
        params: {
          query: { page: 1, per_page: 10 }
        }
      });

      expect(error).toBeUndefined();
      expect(data).toBeDefined();
      
      // é©—è­‰å›æ‡‰çµæ§‹
      expect(data).toHaveProperty('success', true);
      expect(data).toHaveProperty('data');
      expect(data).toHaveProperty('links');
      expect(data).toHaveProperty('meta');
      
      // é©—è­‰ä½¿ç”¨è€…è³‡æ–™çµæ§‹
      if (data.data.length > 0) {
        const user = data.data[0];
        expect(user).toHaveProperty('id');
        expect(user).toHaveProperty('name');
        expect(user).toHaveProperty('email');
        expect(user).toHaveProperty('roles');
        expect(Array.isArray(user.roles)).toBe(true);
      }
    });

    it('POST /api/users å»ºç«‹å›æ‡‰æ ¼å¼ç¬¦åˆè¦ç¯„', async () => {
      const { data, error } = await apiClient.POST('/api/users', {
        body: {
          name: 'æ¸¬è©¦ç”¨æˆ¶',
          email: 'test@example.com',
          password: 'password123',
          roles: ['staff']
        }
      });

      expect(error).toBeUndefined();
      expect(data).toBeDefined();
      expect(data.success).toBe(true);
      expect(data.data).toHaveProperty('id');
      expect(typeof data.data.id).toBe('number');
    });
  });

  describe('Product Categories API', () => {
    it('GET /api/product-categories/tree æ¨¹ç‹€çµæ§‹ç¬¦åˆè¦ç¯„', async () => {
      const { data, error } = await apiClient.GET('/api/product-categories/tree');

      expect(error).toBeUndefined();
      expect(data).toBeDefined();
      expect(Array.isArray(data.data)).toBe(true);
      
      // é©—è­‰æ¨¹ç‹€çµæ§‹
      if (data.data.length > 0) {
        const category = data.data[0];
        expect(category).toHaveProperty('id');
        expect(category).toHaveProperty('name');
        expect(category).toHaveProperty('children');
        expect(Array.isArray(category.children)).toBe(true);
      }
    });
  });
});
```

#### 3. **è‡ªå‹•åŒ–è¦ç¯„ä¸€è‡´æ€§æª¢æŸ¥**

```javascript
// scripts/validate-api-contract.js
const fs = require('fs');
const path = require('path');

/**
 * é©—è­‰ OpenAPI è¦ç¯„èˆ‡å¯¦éš› Controller å›æ‡‰çš„ä¸€è‡´æ€§
 */
async function validateApiContract() {
  console.log('ğŸ” é–‹å§‹ API åˆç´„ä¸€è‡´æ€§æª¢æŸ¥...');

  try {
    // è®€å– OpenAPI è¦ç¯„
    const openApiSpec = JSON.parse(
      fs.readFileSync(path.join(__dirname, '../public/docs/openapi.json'), 'utf8')
    );

    // è®€å–å¯¦éš›çš„ API Resource å®šç¾©
    const resourceFiles = await glob('back/app/Http/Resources/**/*.php');
    
    // é©—è­‰æ¯å€‹ç«¯é»çš„å›æ‡‰æ ¼å¼
    const validationResults = [];
    
    for (const [path, methods] of Object.entries(openApiSpec.paths)) {
      for (const [method, spec] of Object.entries(methods)) {
        if (spec.responses && spec.responses['200']) {
          const result = await validateEndpoint(path, method, spec);
          validationResults.push(result);
        }
      }
    }

    // ç”Ÿæˆé©—è­‰å ±å‘Š
    const failedValidations = validationResults.filter(r => !r.success);
    
    if (failedValidations.length > 0) {
      console.error('âŒ API åˆç´„é©—è­‰å¤±æ•—:');
      failedValidations.forEach(failure => {
        console.error(`  - ${failure.endpoint}: ${failure.error}`);
      });
      process.exit(1);
    }

    console.log('âœ… API åˆç´„é©—è­‰é€šé');
  } catch (error) {
    console.error('ğŸ’¥ åˆç´„é©—è­‰éç¨‹ä¸­ç™¼ç”ŸéŒ¯èª¤:', error);
    process.exit(1);
  }
}

async function validateEndpoint(path, method, spec) {
  // å¯¦ç¾å…·é«”çš„ç«¯é»é©—è­‰é‚è¼¯
  // æ¯”è¼ƒ OpenAPI è¦ç¯„èˆ‡å¯¦éš›å›æ‡‰æ ¼å¼
  return {
    endpoint: `${method.toUpperCase()} ${path}`,
    success: true,
    error: null
  };
}

validateApiContract();
```

#### 4. **é–‹ç™¼å¼·åˆ¶è¦æ±‚**

##### **å¾Œç«¯é–‹ç™¼è€…æª¢æŸ¥æ¸…å–®**

- [ ] âœ… **Resource é¡åˆ¥åŒæ­¥æ›´æ–°**: ä¿®æ”¹ API å›æ‡‰æ™‚ï¼ŒåŒæ­¥æ›´æ–°å°æ‡‰çš„ Resource é¡åˆ¥
- [ ] âœ… **OpenAPI è¨»è§£æ›´æ–°**: ä½¿ç”¨ Laravel Scribe è¨»è§£ç¢ºä¿æ–‡æª”æ­£ç¢ºæ€§
- [ ] âœ… **å‹åˆ¥ä¸€è‡´æ€§**: ç¢ºä¿ PHP å›æ‡‰å‹åˆ¥èˆ‡ OpenAPI è¦ç¯„ä¸€è‡´

```php
/**
 * @group ç”¨æˆ¶ç®¡ç†
 * 
 * @response 200 scenario="æˆåŠŸå–å¾—ç”¨æˆ¶åˆ—è¡¨" {
 *   "success": true,
 *   "data": [
 *     {
 *       "id": 1,
 *       "name": "æ¸¬è©¦ç”¨æˆ¶",
 *       "email": "test@example.com",
 *       "roles": ["admin", "user"]
 *     }
 *   ],
 *   "links": {...},
 *   "meta": {...}
 * }
 */
public function index(IndexUserRequest $request): JsonResponse
{
    // å¯¦ç¾å¿…é ˆèˆ‡ @response è¨»è§£å®Œå…¨ä¸€è‡´
}
```

##### **å‰ç«¯é–‹ç™¼è€…æª¢æŸ¥æ¸…å–®**

- [ ] âœ… **å‹åˆ¥é‡æ–°ç”Ÿæˆ**: API è¦ç¯„æ›´æ–°å¾Œï¼Œé‡æ–°ç”Ÿæˆ TypeScript å‹åˆ¥
- [ ] âœ… **åˆç´„æ¸¬è©¦æ›´æ–°**: æ–°å¢ API ç«¯é»æ™‚ï¼ŒåŒæ­¥æ–°å¢åˆç´„æ¸¬è©¦
- [ ] âœ… **å‹åˆ¥ä½¿ç”¨æ­£ç¢º**: ç¢ºä¿ä½¿ç”¨ç”Ÿæˆçš„å‹åˆ¥ï¼Œé¿å…æ‰‹å‹•å‹åˆ¥å®šç¾©

```typescript
// âœ… æ­£ç¢ºï¼šä½¿ç”¨ç”Ÿæˆçš„å‹åˆ¥
import type { paths } from '@/types/api';

type UserListResponse = paths['/api/users']['get']['responses']['200']['content']['application/json'];

// âŒ ç¦æ­¢ï¼šæ‰‹å‹•å®šç¾©å¯èƒ½ä¸ä¸€è‡´çš„å‹åˆ¥
interface UserListResponse {
  data: User[];  // å¯èƒ½èˆ‡å¯¦éš›ä¸ç¬¦
}
```

### ğŸ“Š åˆç´„æ¸¬è©¦æ•ˆç›Š

1. **æå‰ç™¼ç¾å•é¡Œ**: CI/CD ä¸­è‡ªå‹•æª¢æ¸¬ API ä¸ä¸€è‡´æ€§
2. **å‹åˆ¥å®‰å…¨ä¿è­‰**: å‰ç«¯å‹åˆ¥èˆ‡å¾Œç«¯å¯¦ç¾ 100% ä¸€è‡´
3. **é–‹ç™¼æ•ˆç‡æå‡**: æ¸›å°‘å›  API ä¸ä¸€è‡´å°è‡´çš„èª¿è©¦æ™‚é–“
4. **æ–‡æª”æº–ç¢ºæ€§**: OpenAPI æ–‡æª”èˆ‡å¯¦ç¾è‡ªå‹•åŒæ­¥
5. **åœ˜éšŠå”ä½œé †æš¢**: å‰å¾Œç«¯é–‹ç™¼è€…åŸºæ–¼ç›¸åŒçš„ API å¥‘ç´„å·¥ä½œ

---

## ğŸ¨ çµ„ä»¶è¨­è¨ˆå“²å­¸ï¼šå®Œå…¨å—æ§èˆ‡ç„¡å‰¯ä½œç”¨ (V4.0 å¼·åˆ¶)

### ğŸ¯ å®Œå…¨å—æ§çµ„ä»¶ (Fully Controlled Component) å“²å­¸

LomisX3 V4.0 ç¢ºç«‹äº†**å®Œå…¨å—æ§çµ„ä»¶**ç‚ºæ‰€æœ‰é€šç”¨çµ„ä»¶çš„å”¯ä¸€è¨­è¨ˆæ¨¡å¼ã€‚æ‰€æœ‰å¯è¤‡ç”¨çµ„ä»¶å¿…é ˆæ˜¯ç„¡ç‹€æ…‹çš„"å‚€å„¡çµ„ä»¶"ï¼Œæ‰€æœ‰ç‹€æ…‹é€šé props æ¥æ”¶ï¼Œæ‰€æœ‰äº’å‹•é€šéå›èª¿å‡½æ•¸å‘ä¸Šå‚³éã€‚

#### **æ ¸å¿ƒåŸå‰‡**

```typescript
// âœ… å®Œå…¨å—æ§çµ„ä»¶ç¤ºä¾‹
interface UserTableProps {
  // ğŸ“¥ æ‰€æœ‰è³‡æ–™é€šé props æ¥æ”¶
  users: User[];
  loading?: boolean;
  searchTerm?: string;
  selectedIds?: string[];
  sortConfig?: SortConfig;
  
  // ğŸ“¤ æ‰€æœ‰äº’å‹•é€šéå›èª¿å‚³é
  onSearchChange?: (term: string) => void;
  onSelectionChange?: (ids: string[]) => void;
  onSortChange?: (config: SortConfig) => void;
  onEditUser?: (user: User) => void;
  onDeleteUser?: (user: User) => void;
}

/**
 * âœ… å®Œå…¨å—æ§çš„ç”¨æˆ¶è¡¨æ ¼çµ„ä»¶
 * - ç„¡å…§éƒ¨ç‹€æ…‹ (useState)
 * - ç„¡å‰¯ä½œç”¨ (useEffect åƒ…ç”¨æ–¼ DOM æ“ä½œ)
 * - ç´”å±•ç¤ºé‚è¼¯
 */
const UserTable: React.FC<UserTableProps> = ({
  users = [],
  loading = false,
  searchTerm = '',
  selectedIds = [],
  sortConfig,
  onSearchChange,
  onSelectionChange,
  onSortChange,
  onEditUser,
  onDeleteUser,
}) => {
  // âŒ ç¦æ­¢å…§éƒ¨ç‹€æ…‹
  // const [internalState, setInternalState] = useState();
  
  // âœ… åªèƒ½ç”¨æ–¼ DOM æ“ä½œçš„ useEffect
  useEffect(() => {
    // åªèƒ½é€²è¡Œ DOM æ“ä½œï¼Œå¦‚ç„¦é»ç®¡ç†ã€æ»¾å‹•ä½ç½®ç­‰
    if (searchTerm) {
      inputRef.current?.focus();
    }
  }, [searchTerm]);

  const handleSearchChange = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {
    onSearchChange?.(e.target.value);
  }, [onSearchChange]);

  const handleUserSelect = useCallback((userId: string, checked: boolean) => {
    const newSelection = checked
      ? [...selectedIds, userId]
      : selectedIds.filter(id => id !== userId);
    onSelectionChange?.(newSelection);
  }, [selectedIds, onSelectionChange]);

  return (
    <div className="space-y-4">
      {/* æœå°‹è¼¸å…¥ */}
      <div className="flex items-center space-x-2">
        <Input
          ref={inputRef}
          placeholder="æœå°‹ç”¨æˆ¶..."
          value={searchTerm}
          onChange={handleSearchChange}
          className="max-w-sm"
        />
      </div>

      {/* è³‡æ–™è¡¨æ ¼ */}
      <Table>
        <TableHeader>
          <TableRow>
            <TableHead>
              <Checkbox
                checked={selectedIds.length === users.length && users.length > 0}
                onCheckedChange={(checked) => {
                  const newSelection = checked ? users.map(u => u.id) : [];
                  onSelectionChange?.(newSelection);
                }}
              />
            </TableHead>
            <TableHead 
              className="cursor-pointer"
              onClick={() => onSortChange?.({ field: 'name', direction: 'asc' })}
            >
              å§“å
            </TableHead>
            <TableHead>é›»å­éƒµä»¶</TableHead>
            <TableHead>è§’è‰²</TableHead>
            <TableHead>æ“ä½œ</TableHead>
          </TableRow>
        </TableHeader>
        <TableBody>
          {loading ? (
            <TableRow>
              <TableCell colSpan={5} className="text-center">
                <Spinner /> è¼‰å…¥ä¸­...
              </TableCell>
            </TableRow>
          ) : users.length === 0 ? (
            <TableRow>
              <TableCell colSpan={5} className="text-center text-muted-foreground">
                {searchTerm ? 'æœªæ‰¾åˆ°ç¬¦åˆæ¢ä»¶çš„ç”¨æˆ¶' : 'æš«ç„¡ç”¨æˆ¶è³‡æ–™'}
              </TableCell>
            </TableRow>
          ) : (
            users.map((user) => (
              <TableRow key={user.id}>
                <TableCell>
                  <Checkbox
                    checked={selectedIds.includes(user.id)}
                    onCheckedChange={(checked) => handleUserSelect(user.id, !!checked)}
                  />
                </TableCell>
                <TableCell>{user.name}</TableCell>
                <TableCell>{user.email}</TableCell>
                <TableCell>
                  <Badge variant="secondary">
                    {user.roles.join(', ')}
                  </Badge>
                </TableCell>
                <TableCell>
                  <div className="flex space-x-2">
                    <Button
                      variant="ghost"
                      size="sm"
                      onClick={() => onEditUser?.(user)}
                    >
                      <Edit className="h-4 w-4" />
                    </Button>
                    <Button
                      variant="ghost"
                      size="sm"
                      onClick={() => onDeleteUser?.(user)}
                    >
                      <Trash2 className="h-4 w-4" />
                    </Button>
                  </div>
                </TableCell>
              </TableRow>
            ))
          )}
        </TableBody>
      </Table>
    </div>
  );
};

export default UserTable;
```

#### **é é¢çµ„ä»¶çš„ç‹€æ…‹ç®¡ç†è·è²¬**

```typescript
// âœ… é é¢çµ„ä»¶è² è²¬æ‰€æœ‰ç‹€æ…‹ç®¡ç†
const UsersPage: React.FC = () => {
  // ğŸ“Š é é¢ç´šåˆ¥ç‹€æ…‹ç®¡ç†
  const [searchTerm, setSearchTerm] = useState('');
  const [selectedIds, setSelectedIds] = useState<string[]>([]);
  const [sortConfig, setSortConfig] = useState<SortConfig>({
    field: 'name',
    direction: 'asc'
  });

  // ğŸ”„ API ç‹€æ…‹ç®¡ç†
  const { data: usersData, isLoading } = useUsers({
    search: searchTerm,
    sort: sortConfig,
  });

  // ğŸ“¥ ç©©å®šçš„å›èª¿å‡½æ•¸
  const handleSearchChange = useCallback((term: string) => {
    setSearchTerm(term);
  }, []);

  const handleSelectionChange = useCallback((ids: string[]) => {
    setSelectedIds(ids);
  }, []);

  const handleSortChange = useCallback((config: SortConfig) => {
    setSortConfig(config);
  }, []);

  const handleEditUser = useCallback((user: User) => {
    // ç·¨è¼¯é‚è¼¯
    navigate(`/users/${user.id}/edit`);
  }, [navigate]);

  const handleDeleteUser = useCallback((user: User) => {
    // åˆªé™¤é‚è¼¯
    deleteUserMutation.mutate(user.id);
  }, [deleteUserMutation]);

  return (
    <div className="container mx-auto p-6">
      <div className="flex justify-between items-center mb-6">
        <h1 className="text-3xl font-bold">ç”¨æˆ¶ç®¡ç†</h1>
        <Button onClick={() => navigate('/users/create')}>
          <Plus className="h-4 w-4 mr-2" />
          æ–°å¢ç”¨æˆ¶
        </Button>
      </div>

      {/* ğŸ­ å®Œå…¨å—æ§çš„çµ„ä»¶ */}
      <UserTable
        users={usersData?.data || []}
        loading={isLoading}
        searchTerm={searchTerm}
        selectedIds={selectedIds}
        sortConfig={sortConfig}
        onSearchChange={handleSearchChange}
        onSelectionChange={handleSelectionChange}
        onSortChange={handleSortChange}
        onEditUser={handleEditUser}
        onDeleteUser={handleDeleteUser}
      />
    </div>
  );
};
```

### ğŸš« ç¦æ­¢çš„çµ„ä»¶è¨­è¨ˆæ¨¡å¼

#### âŒ å…§éƒ¨ç‹€æ…‹çµ„ä»¶ (çµ•å°ç¦æ­¢)

```typescript
// âŒ çµ•å°ç¦æ­¢ï¼šå…§éƒ¨ç‹€æ…‹ç®¡ç†
const BadUserTable: React.FC<{ users: User[] }> = ({ users }) => {
  // âŒ ç¦æ­¢å…§éƒ¨ç‹€æ…‹
  const [searchTerm, setSearchTerm] = useState('');
  const [selectedIds, setSelectedIds] = useState<string[]>([]);
  
  // âŒ ç¦æ­¢å…§éƒ¨å‰¯ä½œç”¨
  useEffect(() => {
    // ä¸æ‡‰è©²åœ¨çµ„ä»¶å…§éƒ¨è™•ç†æ¥­å‹™é‚è¼¯
    fetchAdditionalData();
  }, []);

  // é€™æ¨£çš„çµ„ä»¶ç„¡æ³•è¢«å…¶ä»–é é¢é‡è¤‡ä½¿ç”¨
  return (
    // ...çµ„ä»¶å¯¦ç¾
  );
};
```

#### âŒ æ··åˆç‹€æ…‹çµ„ä»¶ (çµ•å°ç¦æ­¢)

```typescript
// âŒ çµ•å°ç¦æ­¢ï¼šæ··åˆå…§å¤–éƒ¨ç‹€æ…‹
interface BadTableProps {
  users: User[];
  // âŒ æ—¢æœ‰å¤–éƒ¨è³‡æ–™ï¼Œåˆæœ‰å…§éƒ¨ç‹€æ…‹ç®¡ç†
  onUserSelect?: (user: User) => void;
}

const BadMixedTable: React.FC<BadTableProps> = ({ users, onUserSelect }) => {
  // âŒ ç¦æ­¢ï¼šçµ„ä»¶æ—¢æ¥æ”¶å¤–éƒ¨ç‹€æ…‹ï¼Œåˆç®¡ç†å…§éƒ¨ç‹€æ…‹
  const [internalFilter, setInternalFilter] = useState('');
  
  // é€™æœƒå°è‡´ç‹€æ…‹ç®¡ç†æ··äº‚ï¼Œé›£ä»¥ç¶­è­·
};
```

### âœ… å…è¨±çš„ useEffect ä½¿ç”¨å ´æ™¯

å®Œå…¨å—æ§çµ„ä»¶ä¸­ï¼Œ`useEffect` åªèƒ½ç”¨æ–¼ä»¥ä¸‹å ´æ™¯ï¼š

```typescript
const ControlledComponent: React.FC<Props> = ({ focusOnMount, scrollToTop }) => {
  const inputRef = useRef<HTMLInputElement>(null);

  // âœ… å…è¨±ï¼šDOM æ“ä½œ
  useEffect(() => {
    if (focusOnMount) {
      inputRef.current?.focus();
    }
  }, [focusOnMount]);

  // âœ… å…è¨±ï¼šæ»¾å‹•ä½ç½®ç®¡ç†
  useEffect(() => {
    if (scrollToTop) {
      window.scrollTo(0, 0);
    }
  }, [scrollToTop]);

  // âœ… å…è¨±ï¼šç¬¬ä¸‰æ–¹åº«åˆå§‹åŒ– (ç„¡ç‹€æ…‹è®Šæ›´)
  useEffect(() => {
    const chart = new Chart(canvasRef.current, config);
    return () => chart.destroy();
  }, []);

  // âŒ ç¦æ­¢ï¼šè³‡æ–™ç²å–
  // useEffect(() => {
  //   fetchData().then(setData);
  // }, []);

  // âŒ ç¦æ­¢ï¼šç‹€æ…‹è®Šæ›´
  // useEffect(() => {
  //   setInternalState(computeValue(props.data));
  // }, [props.data]);
};
```

### ğŸ“‹ çµ„ä»¶è¨­è¨ˆæª¢æŸ¥æ¸…å–®

é–‹ç™¼å®Œæˆå¾Œï¼Œæ¯å€‹é€šç”¨çµ„ä»¶å¿…é ˆé€šéä»¥ä¸‹æª¢æŸ¥ï¼š

- [ ] âœ… **é›¶å…§éƒ¨ç‹€æ…‹**: ä¸ä½¿ç”¨ `useState` ç®¡ç†ä»»ä½•æ¥­å‹™ç‹€æ…‹
- [ ] âœ… **ç´”ç²¹å‚³é**: æ‰€æœ‰è³‡æ–™é€šé props æ¥æ”¶ï¼Œç„¡å…§éƒ¨è³‡æ–™ç²å–
- [ ] âœ… **å›èª¿é€šä¿¡**: æ‰€æœ‰äº’å‹•é€šéå›èª¿å‡½æ•¸å‘ä¸Šå‚³é
- [ ] âœ… **å‡½æ•¸ç©©å®š**: ä½¿ç”¨ `useCallback` ç¢ºä¿å›èª¿å‡½æ•¸ç©©å®š
- [ ] âœ… **æœ‰é™å‰¯ä½œç”¨**: `useEffect` åªç”¨æ–¼ DOM æ“ä½œå’Œç¬¬ä¸‰æ–¹åº«ç®¡ç†
- [ ] âœ… **å‹åˆ¥å®Œæ•´**: æ‰€æœ‰ props éƒ½æœ‰æ˜ç¢ºçš„ TypeScript å‹åˆ¥å®šç¾©
- [ ] âœ… **é è¨­å€¼**: æ‰€æœ‰å¯é¸ props éƒ½æœ‰åˆç†çš„é è¨­å€¼
- [ ] âœ… **å¯æ¸¬è©¦æ€§**: çµ„ä»¶è¡Œç‚ºå®Œå…¨ç”± props æ±ºå®šï¼Œæ˜“æ–¼å–®å…ƒæ¸¬è©¦

---

## âš›ï¸ React Hooks ä½¿ç”¨è¦ç¯„ (V4.0 å¼·åˆ¶)

### ğŸ¯ useCallback å¼·åˆ¶ä½¿ç”¨è¦ç¯„

LomisX3 V4.0 å¼·åˆ¶è¦æ±‚æ‰€æœ‰å‚³éçµ¦å­çµ„ä»¶çš„å‡½æ•¸éƒ½å¿…é ˆä½¿ç”¨ `useCallback` åŒ…è£ï¼Œé˜²æ­¢ç„¡é™é‡æ¸²æŸ“å•é¡Œã€‚

#### **å¼·åˆ¶ useCallback å ´æ™¯**

```typescript
// âœ… å¼·åˆ¶å ´æ™¯ 1ï¼šå‚³éçµ¦å­çµ„ä»¶çš„å›èª¿å‡½æ•¸
const ParentComponent: React.FC = () => {
  const [users, setUsers] = useState<User[]>([]);
  const [searchTerm, setSearchTerm] = useState('');

  // âœ… å¿…é ˆä½¿ç”¨ useCallback
  const handleSearchChange = useCallback((term: string) => {
    setSearchTerm(term);
  }, []); // ç„¡ä¾è³´ï¼Œå‡½æ•¸æ°¸é ç©©å®š

  const handleUserEdit = useCallback((user: User) => {
    navigate(`/users/${user.id}/edit`);
  }, [navigate]); // navigate ä¾†è‡ª react-routerï¼Œç©©å®š

  const handleUserDelete = useCallback((user: User) => {
    if (confirm('ç¢ºå®šè¦åˆªé™¤é€™å€‹ç”¨æˆ¶å—ï¼Ÿ')) {
      deleteUser(user.id);
    }
  }, []); // ç„¡å¤–éƒ¨ä¾è³´

  return (
    <UserTable
      users={users}
      searchTerm={searchTerm}
      onSearchChange={handleSearchChange}  // å‚³éçµ¦å­çµ„ä»¶
      onUserEdit={handleUserEdit}          // å‚³éçµ¦å­çµ„ä»¶
      onUserDelete={handleUserDelete}      // å‚³éçµ¦å­çµ„ä»¶
    />
  );
};

// âœ… å¼·åˆ¶å ´æ™¯ 2ï¼šuseEffect ä¾è³´ä¸­çš„å‡½æ•¸
const DataFetcher: React.FC<{ userId: string }> = ({ userId }) => {
  const [userData, setUserData] = useState<User | null>(null);

  // âœ… å¿…é ˆä½¿ç”¨ useCallback (ç”¨æ–¼ useEffect ä¾è³´)
  const fetchUserData = useCallback(async () => {
    try {
      const response = await api.get(`/users/${userId}`);
      setUserData(response.data);
    } catch (error) {
      console.error('ç²å–ç”¨æˆ¶è³‡æ–™å¤±æ•—:', error);
    }
  }, [userId]); // userId è®ŠåŒ–æ™‚é‡æ–°å‰µå»ºå‡½æ•¸

  useEffect(() => {
    fetchUserData();
  }, [fetchUserData]); // ä¾è³´æ–¼ useCallback åŒ…è£çš„å‡½æ•¸

  // ...
};

// âœ… å¼·åˆ¶å ´æ™¯ 3ï¼šå‚³éçµ¦ memo çµ„ä»¶çš„ props
const MemoizedChild = React.memo<{ onAction: () => void }>(({ onAction }) => {
  // çµ„ä»¶å¯¦ç¾
});

const Parent: React.FC = () => {
  // âœ… å¿…é ˆä½¿ç”¨ useCallbackï¼Œå¦å‰‡ memo å¤±æ•ˆ
  const handleAction = useCallback(() => {
    // è™•ç†é‚è¼¯
  }, []);

  return <MemoizedChild onAction={handleAction} />;
};
```

#### **useCallback ä¾è³´ç®¡ç†æœ€ä½³å¯¦è¸**

```typescript
const OptimalComponent: React.FC = () => {
  const [filter, setFilter] = useState('');
  const [sortBy, setSortBy] = useState('name');
  const { mutate: updateUser } = useUpdateUser();

  // âœ… æœ€ä½³å¯¦è¸ï¼šæœ€å°åŒ–ä¾è³´
  const handleFilterChange = useCallback((newFilter: string) => {
    setFilter(newFilter);
  }, []); // ç„¡ä¾è³´ï¼Œä½¿ç”¨å‡½æ•¸æ›´æ–°æ¨¡å¼

  // âœ… æœ€ä½³å¯¦è¸ï¼šç©©å®šçš„ä¾è³´
  const handleSort = useCallback((field: string) => {
    setSortBy(field);
  }, []); // ç„¡ä¾è³´

  // âœ… æœ€ä½³å¯¦è¸ï¼šå¿…è¦çš„ä¾è³´
  const handleUserUpdate = useCallback((userId: string, data: UpdateUserData) => {
    updateUser({ id: userId, ...data });
  }, [updateUser]); // updateUser ä¾†è‡ª react-queryï¼Œç©©å®š

  // âš ï¸ è¬¹æ…ä½¿ç”¨ï¼šåŒ…å«ç‹€æ…‹çš„ä¾è³´
  const handleComplexOperation = useCallback((userId: string) => {
    if (filter && sortBy) {
      // è¤‡é›œæ“ä½œé‚è¼¯
      performOperation(userId, filter, sortBy);
    }
  }, [filter, sortBy]); // å¿…è¦æ™‚åŒ…å«ç‹€æ…‹ä¾è³´

  // âŒ é¿å…ï¼šéå¤šä¾è³´å°è‡´é »ç¹é‡å»º
  const badCallback = useCallback(() => {
    // ç›¡é‡é¿å…åœ¨ useCallback ä¸­ä½¿ç”¨å¤ªå¤šç‹€æ…‹
  }, [state1, state2, state3, state4, state5]); // éå¤šä¾è³´

  return (
    <div>
      <SearchInput onSearchChange={handleFilterChange} />
      <SortControls onSortChange={handleSort} />
      <UserList onUserUpdate={handleUserUpdate} />
    </div>
  );
};
```

### ğŸ”„ useEffect ä¾è³´å„ªåŒ–è¦ç¯„

#### **æœ€å°åŒ–ä¾è³´åŸå‰‡**

```typescript
// âœ… æœ€ä½³å¯¦è¸ï¼šæœ€å°åŒ–ä¾è³´
const DataComponent: React.FC<{ userId: string }> = ({ userId }) => {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(false);

  useEffect(() => {
    let cancelled = false;
    
    const fetchData = async () => {
      setLoading(true);
      try {
        const response = await api.get(`/users/${userId}`);
        if (!cancelled) {
          setData(response.data);
        }
      } finally {
        if (!cancelled) {
          setLoading(false);
        }
      }
    };

    fetchData();

    return () => {
      cancelled = true;
    };
  }, [userId]); // åªä¾è³´çœŸæ­£éœ€è¦çš„ userId

  // âŒ é¿å…ï¼šåŒ…å«ä¸å¿…è¦çš„ä¾è³´
  // useEffect(() => {
  //   fetchData();
  // }, [userId, data, loading]); // data å’Œ loading æœƒå°è‡´ç„¡é™å¾ªç’°
};

// âœ… æ­£ç¢ºåˆ†é›¢å¤šå€‹ useEffect
const MultiEffectComponent: React.FC<{ userId: string, theme: string }> = ({ 
  userId, 
  theme 
}) => {
  // æ•ˆæœ 1ï¼šè³‡æ–™ç²å–
  useEffect(() => {
    fetchUserData(userId);
  }, [userId]);

  // æ•ˆæœ 2ï¼šä¸»é¡Œæ‡‰ç”¨
  useEffect(() => {
    applyTheme(theme);
  }, [theme]);

  // âŒ é¿å…ï¼šæ··åˆä¸ç›¸é—œçš„é‚è¼¯
  // useEffect(() => {
  //   fetchUserData(userId);
  //   applyTheme(theme);
  // }, [userId, theme]); // æœƒå°è‡´ä¸å¿…è¦çš„é‡è¤‡åŸ·è¡Œ
};
```

#### **äº‹ä»¶è™•ç†å™¨ç©©å®šåŒ–**

```typescript
// âœ… äº‹ä»¶è™•ç†å™¨ç©©å®šåŒ–æœ€ä½³å¯¦è¸
const StableEventComponent: React.FC = () => {
  const [count, setCount] = useState(0);
  const [text, setText] = useState('');

  // âœ… ä½¿ç”¨å‡½æ•¸æ›´æ–°å½¢å¼ï¼Œé¿å…ä¾è³´ç‹€æ…‹
  const increment = useCallback(() => {
    setCount(prev => prev + 1);
  }, []); // ç„¡ä¾è³´ï¼Œæ°¸é ç©©å®š

  const decrement = useCallback(() => {
    setCount(prev => prev - 1);
  }, []); // ç„¡ä¾è³´ï¼Œæ°¸é ç©©å®š

  // âœ… ç°¡å–®ç‹€æ…‹æ›´æ–°ä¸éœ€è¦ä¾è³´
  const handleTextChange = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {
    setText(e.target.value);
  }, []); // ç„¡ä¾è³´

  // âœ… è¤‡é›œé‚è¼¯éœ€è¦ä¾è³´æ™‚ï¼Œä½¿ç”¨ ref å„ªåŒ–
  const complexLogicRef = useRef<(value: string) => void>();
  complexLogicRef.current = (value: string) => {
    // ä½¿ç”¨æœ€æ–°çš„ count å’Œ textï¼Œä½†ä¸ä½œç‚ºä¾è³´
    console.log(`è™•ç† ${value}ï¼Œç•¶å‰è¨ˆæ•¸ï¼š${count}ï¼Œæ–‡å­—ï¼š${text}`);
  };

  const handleComplexAction = useCallback((value: string) => {
    complexLogicRef.current?.(value);
  }, []); // ç„¡ä¾è³´ï¼Œä½†èƒ½å­˜å–æœ€æ–°ç‹€æ…‹

  return (
    <div>
      <div>è¨ˆæ•¸ï¼š{count}</div>
      <button onClick={increment}>+</button>
      <button onClick={decrement}>-</button>
      <input value={text} onChange={handleTextChange} />
      <button onClick={() => handleComplexAction('test')}>
        è¤‡é›œæ“ä½œ
      </button>
    </div>
  );
};
```

### ğŸ›¡ï¸ é˜²æ­¢ç„¡é™é‡æ¸²æŸ“çš„å®‰å…¨æªæ–½

#### **å®‰å…¨æª¢æŸ¥æ¸…å–®**

```typescript
// ğŸ” æª¢æŸ¥æ¸…å–®ç¯„ä¾‹
const SafeComponent: React.FC<SafeComponentProps> = ({ 
  data, 
  onDataChange, 
  filters 
}) => {
  // âœ… æª¢æŸ¥é» 1ï¼šæ‰€æœ‰å›èª¿éƒ½ä½¿ç”¨ useCallback
  const handleItemClick = useCallback((item: Item) => {
    onDataChange?.(item);
  }, [onDataChange]);

  // âœ… æª¢æŸ¥é» 2ï¼šuseEffect ä¾è³´æœ€å°åŒ–
  useEffect(() => {
    if (data.length > 0) {
      // åªä¾è³´çœŸæ­£éœ€è¦çš„è®Šæ•¸
      processData(data);
    }
  }, [data]); // åªä¾è³´ dataï¼Œä¸åŒ…å« onDataChange

  // âœ… æª¢æŸ¥é» 3ï¼šé¿å…åœ¨ render ä¸­å‰µå»ºç‰©ä»¶
  const memoizedFilters = useMemo(() => ({
    ...filters,
    timestamp: Date.now()
  }), [filters]);

  // âœ… æª¢æŸ¥é» 4ï¼šç©©å®šçš„è¨ˆç®—å€¼
  const computedValue = useMemo(() => {
    return expensiveComputation(data);
  }, [data]);

  // âŒ é¿å…ï¼šåœ¨ render ä¸­å‰µå»ºæ–°ç‰©ä»¶
  // const newObject = { ...filters }; // æ¯æ¬¡ render éƒ½æœƒå‰µå»ºæ–°ç‰©ä»¶

  return (
    <div>
      {data.map(item => (
        <ItemComponent
          key={item.id}
          item={item}
          onClick={handleItemClick}  // ç©©å®šçš„å›èª¿
          filters={memoizedFilters}  // ç©©å®šçš„ç‰©ä»¶
        />
      ))}
    </div>
  );
};
```

#### **é™¤éŒ¯å·¥å…·èˆ‡æª¢æ¸¬**

```typescript
// é–‹ç™¼ç’°å¢ƒçš„ç„¡é™é‡æ¸²æŸ“æª¢æ¸¬
if (process.env.NODE_ENV === 'development') {
  const renderCount = useRef(0);
  renderCount.current++;
  
  useEffect(() => {
    if (renderCount.current > 50) {
      console.warn('âš ï¸ çµ„ä»¶æ¸²æŸ“æ¬¡æ•¸éå¤šï¼Œå¯èƒ½å­˜åœ¨ç„¡é™é‡æ¸²æŸ“å•é¡Œ', {
        component: 'ComponentName',
        renderCount: renderCount.current
      });
    }
  });
}

// ä¾è³´è®ŠåŒ–è¿½è¹¤
const useWhyDidYouUpdate = (name: string, props: Record<string, any>) => {
  const previous = useRef<Record<string, any>>();
  
  useEffect(() => {
    if (previous.current) {
      const allKeys = Object.keys({ ...previous.current, ...props });
      const changedProps: Record<string, any> = {};
      
      allKeys.forEach(key => {
        if (previous.current?.[key] !== props[key]) {
          changedProps[key] = {
            from: previous.current?.[key],
            to: props[key]
          };
        }
      });
      
      if (Object.keys(changedProps).length) {
        console.log('[why-did-you-update]', name, changedProps);
      }
    }
    
    previous.current = props;
  });
};
```

### ğŸ“‹ Hooks ä½¿ç”¨æª¢æŸ¥æ¸…å–®

æ¯å€‹çµ„ä»¶å®Œæˆå¾Œå¿…é ˆé€šéä»¥ä¸‹æª¢æŸ¥ï¼š

- [ ] âœ… **useCallback å®Œæ•´**: æ‰€æœ‰å‚³éçµ¦å­çµ„ä»¶çš„å‡½æ•¸éƒ½ä½¿ç”¨ useCallback
- [ ] âœ… **ä¾è³´æœ€å°åŒ–**: useEffect å’Œ useCallback çš„ä¾è³´é™£åˆ—æœ€å°åŒ–
- [ ] âœ… **ç„¡å¾ªç’°ä¾è³´**: ä¸å­˜åœ¨æœƒå°è‡´ç„¡é™é‡æ¸²æŸ“çš„ä¾è³´å¾ªç’°
- [ ] âœ… **ç©©å®šå¼•ç”¨**: ç‰©ä»¶å’Œé™£åˆ— props ä½¿ç”¨ useMemo ç©©å®šåŒ–
- [ ] âœ… **æ¸…ç†æ©Ÿåˆ¶**: æ‰€æœ‰è¨‚é–±å’Œå®šæ™‚å™¨éƒ½æœ‰é©ç•¶çš„æ¸…ç†
- [ ] âœ… **æ•ˆèƒ½å„ªåŒ–**: æ˜‚è²´è¨ˆç®—ä½¿ç”¨ useMemo å„ªåŒ–
- [ ] âœ… **é–‹ç™¼é™¤éŒ¯**: é–‹ç™¼ç’°å¢ƒæœ‰é©ç•¶çš„é™¤éŒ¯å’Œè­¦å‘Šæ©Ÿåˆ¶

---

## ğŸ¨ å‰ç«¯æ¶æ§‹æ¨™æº–

### ğŸ¨ UI çµ„ä»¶è¨­è¨ˆæ¨™æº– (shadcn/ui ç”Ÿæ…‹ç³»çµ±)

æœ¬å°ˆæ¡ˆ**å”¯ä¸€æŒ‡å®š**ä½¿ç”¨ `shadcn/ui` ä½œç‚º UI çµ„ä»¶åº«ï¼Œé…åˆ `Tailwind CSS` æ§‹å»ºä¸€è‡´çš„ä½¿ç”¨è€…ä»‹é¢ã€‚ä»»ä½•åé›¢æ­¤æ¨™æº–çš„ UI å¯¦ç¾éƒ½å°‡è¢«è¦–ç‚ºæ¶æ§‹é•è¦ã€‚

#### **æ ¸å¿ƒ UI æŠ€è¡“æ£§ (ä¸å¯æ›¿ä»£)**

| çµ„ä»¶é¡å‹ | æŒ‡å®šè§£æ±ºæ–¹æ¡ˆ | èªªæ˜ | æ›¿ä»£æ–¹æ¡ˆ |
|----------|-------------|------|----------|
| **åŸºç¤çµ„ä»¶** | `shadcn/ui` | å”¯ä¸€æŒ‡å®šçš„ UI çµ„ä»¶åº« | âŒ ç¦æ­¢ |
| **åœ–æ¨™ç³»çµ±** | `lucide-react` | shadcn/ui å®˜æ–¹é…å¥—åœ–æ¨™åº« | âŒ ç¦æ­¢ |
| **æ¨£å¼æ¡†æ¶** | `Tailwind CSS` | èˆ‡ shadcn/ui æ·±åº¦æ•´åˆ | âŒ ç¦æ­¢ |
| **é€šçŸ¥ç³»çµ±** | `shadcn/ui useToast` | å…§å»ºçš„ Toast Hook | âŒ ç¦æ­¢ react-hot-toast |
| **å°è©±æ¡†** | `shadcn/ui Dialog` | æ¨¡æ…‹æ¡†å’Œå°è©±æ¡†è§£æ±ºæ–¹æ¡ˆ | âŒ ç¦æ­¢ @headlessui/react |
| **è¡¨å–®çµ„ä»¶** | `shadcn/ui Form + React Hook Form` | è¡¨å–®è™•ç†æ¨™æº–çµ„åˆ | âŒ ç¦æ­¢å…¶ä»–è¡¨å–®åº« |

#### **å…·é«”å¯¦è¸è¦ç¯„**

##### 1. **åœ–æ¨™ä½¿ç”¨æ¨™æº–**
```typescript
// âœ… æ­£ç¢ºï¼šçµ±ä¸€ä½¿ç”¨ lucide-react
import { Search, Plus, Edit, Trash2, ChevronDown } from 'lucide-react';

// âŒ ç¦æ­¢ï¼šä½¿ç”¨å…¶ä»–åœ–æ¨™åº«
import { SearchIcon } from '@heroicons/react/24/outline'; // ç¦æ­¢
import { FaSearch } from 'react-icons/fa'; // ç¦æ­¢
```

##### 2. **é€šçŸ¥/Toast ä½¿ç”¨æ¨™æº–**
```typescript
// âœ… æ­£ç¢ºï¼šä½¿ç”¨ shadcn/ui å…§å»º useToast
import { useToast } from '@/components/ui/use-toast';

const Component = () => {
  const { toast } = useToast();
  
  const handleSuccess = () => {
    toast({
      title: "æ“ä½œæˆåŠŸ",
      description: "å•†å“åˆ†é¡å·²æˆåŠŸå»ºç«‹",
      variant: "default",
    });
  };
  
  const handleError = () => {
    toast({
      title: "æ“ä½œå¤±æ•—",
      description: "è«‹æª¢æŸ¥è¼¸å…¥è³‡æ–™",
      variant: "destructive",
    });
  };
};

// âŒ ç¦æ­¢ï¼šä½¿ç”¨å…¶ä»– toast å¥—ä»¶
import toast from 'react-hot-toast'; // ç¦æ­¢
```

##### 3. **å°è©±æ¡†/æ¨¡æ…‹çª—ä½¿ç”¨æ¨™æº–**
```typescript
// âœ… æ­£ç¢ºï¼šä½¿ç”¨ shadcn/ui Dialog
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogTitle,
  DialogTrigger,
} from '@/components/ui/dialog';

const ConfirmDialog = () => (
  <Dialog>
    <DialogTrigger asChild>
      <Button variant="destructive">åˆªé™¤</Button>
    </DialogTrigger>
    <DialogContent>
      <DialogHeader>
        <DialogTitle>ç¢ºèªåˆªé™¤</DialogTitle>
        <DialogDescription>
          æ­¤æ“ä½œç„¡æ³•å¾©åŸï¼Œç¢ºå®šè¦åˆªé™¤é€™å€‹é …ç›®å—ï¼Ÿ
        </DialogDescription>
      </DialogHeader>
      <DialogFooter>
        <Button variant="outline">å–æ¶ˆ</Button>
        <Button variant="destructive">ç¢ºèªåˆªé™¤</Button>
      </DialogFooter>
    </DialogContent>
  </Dialog>
);

// âŒ ç¦æ­¢ï¼šä½¿ç”¨å…¶ä»–å°è©±æ¡†è§£æ±ºæ–¹æ¡ˆ
import { Dialog } from '@headlessui/react'; // ç¦æ­¢
```

##### 4. **è¡¨å–®çµ„ä»¶ä½¿ç”¨æ¨™æº–**
```typescript
// âœ… æ­£ç¢ºï¼šshadcn/ui Form + React Hook Form + Zod
import {
  Form,
  FormControl,
  FormDescription,
  FormField,
  FormItem,
  FormLabel,
  FormMessage,
} from '@/components/ui/form';
import { Input } from '@/components/ui/input';
import { Button } from '@/components/ui/button';
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import * as z from 'zod';

const formSchema = z.object({
  name: z.string().min(2, 'åç¨±è‡³å°‘éœ€è¦ 2 å€‹å­—å…ƒ'),
  email: z.string().email('è«‹è¼¸å…¥æœ‰æ•ˆçš„é›»å­éƒµä»¶åœ°å€'),
});

const UserForm = () => {
  const form = useForm<z.infer<typeof formSchema>>({
    resolver: zodResolver(formSchema),
  });

  return (
    <Form {...form}>
      <form onSubmit={form.handleSubmit(onSubmit)}>
        <FormField
          control={form.control}
          name="name"
          render={({ field }) => (
            <FormItem>
              <FormLabel>åç¨±</FormLabel>
              <FormControl>
                <Input placeholder="è«‹è¼¸å…¥åç¨±" {...field} />
              </FormControl>
              <FormDescription>
                é€™æ˜¯æ‚¨çš„å…¬é–‹é¡¯ç¤ºåç¨±
              </FormDescription>
              <FormMessage />
            </FormItem>
          )}
        />
        <Button type="submit">æäº¤</Button>
      </form>
    </Form>
  );
};
```

##### 5. **æ·±è‰²æ¨¡å¼æ”¯æ´æ¨™æº–**
```typescript
// âœ… æ­£ç¢ºï¼šä½¿ç”¨ Tailwind CSS æ·±è‰²æ¨¡å¼è®Šæ•¸
const Card = () => (
  <div className="bg-background text-foreground border-border rounded-lg p-6">
    <h3 className="text-foreground font-semibold">æ¨™é¡Œ</h3>
    <p className="text-muted-foreground">æè¿°æ–‡å­—</p>
  </div>
);

// âŒ ç¦æ­¢ï¼šç¡¬ç·¨ç¢¼é¡è‰²å€¼
const Card = () => (
  <div className="bg-white dark:bg-gray-900 text-black dark:text-white">
    // ç¦æ­¢ç¡¬ç·¨ç¢¼
  </div>
);
```

#### **çµ„ä»¶æ“´å±•è¦ç¯„**

ç•¶éœ€è¦å®¢è£½åŒ– shadcn/ui çµ„ä»¶æ™‚ï¼Œå¿…é ˆéµå¾ªä»¥ä¸‹æ“´å±•æ¨¡å¼ï¼š

```typescript
// âœ… æ­£ç¢ºï¼šåŸºæ–¼ shadcn/ui çµ„ä»¶æ“´å±•
import { Button, ButtonProps } from '@/components/ui/button';
import { cn } from '@/lib/utils';

interface LoadingButtonProps extends ButtonProps {
  loading?: boolean;
}

const LoadingButton = ({ loading, children, className, ...props }: LoadingButtonProps) => (
  <Button
    className={cn(className)}
    disabled={loading || props.disabled}
    {...props}
  >
    {loading && <Loader2 className="mr-2 h-4 w-4 animate-spin" />}
    {children}
  </Button>
);

// âŒ ç¦æ­¢ï¼šé‡æ–°å¯¦ç¾æŒ‰éˆ•çµ„ä»¶
const CustomButton = ({ children, onClick }) => (
  <button className="custom-btn" onClick={onClick}>
    {children}
  </button>
); // ç¦æ­¢
```

### ğŸ—ï¸ React æ‡‰ç”¨æ¶æ§‹

#### 1. **çµ„ä»¶å±¤ç´šæ¶æ§‹**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ğŸ“± Pages Layer                         â”‚
â”‚                    (è·¯ç”±é é¢çµ„ä»¶)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   ğŸ—ï¸ Layout Layer                           â”‚
â”‚                   (ä½ˆå±€å®¹å™¨çµ„ä»¶)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  ğŸ¨ Feature Layer                           â”‚
â”‚                (æ¥­å‹™åŠŸèƒ½çµ„ä»¶)                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   ğŸ§± UI Layer                               â”‚
â”‚                 (åŸºç¤ UI çµ„ä»¶)                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  ğŸª Hooks Layer                             â”‚
â”‚               (é‚è¼¯è™•ç† Hooks)                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  ğŸ”§ Utils Layer                             â”‚
â”‚                (å·¥å…·å‡½æ•¸)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2. **çµ„ä»¶è¨­è¨ˆæ¨™æº–**

```typescript
// components/ui/button.tsx - åŸºç¤ UI çµ„ä»¶æ¨™æº–
import { forwardRef } from 'react';
import { Slot } from '@radix-ui/react-slot';
import { cva, type VariantProps } from 'class-variance-authority';
import { cn } from '@/lib/utils';

/**
 * Button è®Šé«”é…ç½®
 * çµ±ä¸€çš„æŒ‰éˆ•æ¨£å¼è®Šé«”å®šç¾©
 */
const buttonVariants = cva(
  'inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50',
  {
    variants: {
      variant: {
        default: 'bg-primary text-primary-foreground hover:bg-primary/90',
        destructive: 'bg-destructive text-destructive-foreground hover:bg-destructive/90',
        outline: 'border border-input bg-background hover:bg-accent hover:text-accent-foreground',
        secondary: 'bg-secondary text-secondary-foreground hover:bg-secondary/80',
        ghost: 'hover:bg-accent hover:text-accent-foreground',
        link: 'text-primary underline-offset-4 hover:underline',
      },
      size: {
        default: 'h-10 px-4 py-2',
        sm: 'h-9 rounded-md px-3',
        lg: 'h-11 rounded-md px-8',
        icon: 'h-10 w-10',
      },
    },
    defaultVariants: {
      variant: 'default',
      size: 'default',
    },
  }
);

/**
 * Button çµ„ä»¶ Props ä»‹é¢
 */
export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  asChild?: boolean;
}

/**
 * Button åŸºç¤çµ„ä»¶
 * æ‰€æœ‰æŒ‰éˆ•ç›¸é—œçµ„ä»¶å¿…é ˆåŸºæ–¼æ­¤çµ„ä»¶å»ºæ§‹
 */
const Button = forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant, size, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : 'button';
    
    return (
      <Comp
        className={cn(buttonVariants({ variant, size, className }))}
        ref={ref}
        {...props}
      />
    );
  }
);

Button.displayName = 'Button';

export { Button, buttonVariants };
```

#### 3. **æ¥­å‹™çµ„ä»¶æ¨™æº–**

```typescript
// pages/product-categories/components/product-category-list.tsx
import { useState } from 'react';
import { useProductCategories } from '@/hooks/api/use-product-categories';
import { DataTable } from '@/components/common/data-table';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Badge } from '@/components/ui/badge';
import type { ColumnDef } from '@tanstack/react-table';
import type { ProductCategory } from '@/types/api';

/**
 * å•†å“åˆ†é¡åˆ—è¡¨çµ„ä»¶
 * è² è²¬é¡¯ç¤ºå•†å“åˆ†é¡çš„è¡¨æ ¼åˆ—è¡¨
 */
export function ProductCategoryList() {
  const [filters, setFilters] = useState({
    search: '',
    status: null as boolean | null,
    per_page: 20
  });

  const {
    data,
    isLoading,
    isError,
    refetch
  } = useProductCategories(filters);

  /**
   * è¡¨æ ¼æ¬„ä½å®šç¾©
   */
  const columns: ColumnDef<ProductCategory>[] = [
    {
      accessorKey: 'name',
      header: 'åç¨±',
      cell: ({ row }) => (
        <div className="font-medium">
          {row.original.name}
        </div>
      ),
    },
    {
      accessorKey: 'slug',
      header: 'URL è­˜åˆ¥ç¢¼',
      cell: ({ row }) => (
        <code className="text-sm bg-muted px-2 py-1 rounded">
          {row.original.slug}
        </code>
      ),
    },
    {
      accessorKey: 'status',
      header: 'ç‹€æ…‹',
      cell: ({ row }) => (
        <Badge variant={row.original.status ? 'default' : 'secondary'}>
          {row.original.status ? 'å•Ÿç”¨' : 'åœç”¨'}
        </Badge>
      ),
    },
    {
      accessorKey: 'position',
      header: 'æ’åº',
      cell: ({ row }) => row.original.position,
    },
    {
      id: 'actions',
      header: 'æ“ä½œ',
      cell: ({ row }) => (
        <div className="flex gap-2">
          <Button
            variant="outline"
            size="sm"
            onClick={() => handleEdit(row.original.id)}
          >
            ç·¨è¼¯
          </Button>
          <Button
            variant="destructive"
            size="sm"
            onClick={() => handleDelete(row.original.id)}
          >
            åˆªé™¤
          </Button>
        </div>
      ),
    },
  ];

  /**
   * ç·¨è¼¯è™•ç†å‡½æ•¸
   */
  const handleEdit = (id: number) => {
    // å°èˆªåˆ°ç·¨è¼¯é é¢æˆ–é–‹å•Ÿç·¨è¼¯æ¨¡æ…‹æ¡†
  };

  /**
   * åˆªé™¤è™•ç†å‡½æ•¸
   */
  const handleDelete = (id: number) => {
    // é¡¯ç¤ºç¢ºèªå°è©±æ¡†ä¸¦åŸ·è¡Œåˆªé™¤
  };

  /**
   * ç¯©é¸å™¨è®Šæ›´è™•ç†
   */
  const handleFilterChange = (key: string, value: any) => {
    setFilters(prev => ({
      ...prev,
      [key]: value
    }));
  };

  if (isError) {
    return (
      <div className="text-center py-8">
        <p className="text-destructive">è¼‰å…¥è³‡æ–™æ™‚ç™¼ç”ŸéŒ¯èª¤</p>
        <Button variant="outline" onClick={() => refetch()}>
          é‡è©¦
        </Button>
      </div>
    );
  }

  return (
    <div className="space-y-4">
      {/* ç¯©é¸å™¨ */}
      <div className="flex gap-4">
        <Input
          placeholder="æœå°‹åˆ†é¡åç¨±..."
          value={filters.search}
          onChange={(e) => handleFilterChange('search', e.target.value)}
          className="max-w-sm"
        />
        
        <Button variant="outline" onClick={() => setFilters({ search: '', status: null, per_page: 20 })}>
          é‡ç½®ç¯©é¸
        </Button>
      </div>

      {/* è³‡æ–™è¡¨æ ¼ */}
      <DataTable
        columns={columns}
        data={data?.data || []}
        loading={isLoading}
        pagination={data?.meta}
        onPaginationChange={(page, perPage) => {
          setFilters(prev => ({ ...prev, page, per_page: perPage }));
        }}
      />
    </div>
  );
}
```

### ğŸ”’ TypeScript å‹åˆ¥å®‰å…¨

#### è‡ªå‹• API å‹åˆ¥ç”Ÿæˆ

```typescript
// scripts/generate-api-types.ts
import { generateApi } from 'swagger-typescript-api';
import fs from 'fs';
import path from 'path';

/**
 * è‡ªå‹•ç”Ÿæˆ API å‹åˆ¥
 * å¾å¾Œç«¯ OpenAPI è¦æ ¼è‡ªå‹•ç”Ÿæˆå‰ç«¯å‹åˆ¥å®šç¾©
 */
async function generateApiTypes() {
  try {
    const { files } = await generateApi({
      name: 'api.ts',
      url: 'http://localhost:8000/docs/openapi.json',
      httpClientType: 'fetch',
      generateClient: false,
      generateRouteTypes: true,
      extractRequestParams: true,
      extractRequestBody: true,
      extractResponseBody: true,
      modular: false,
    });

    const outputPath = path.join(process.cwd(), 'src/types');
    
    if (!fs.existsSync(outputPath)) {
      fs.mkdirSync(outputPath, { recursive: true });
    }

    files.forEach(({ content, name }) => {
      fs.writeFileSync(path.join(outputPath, name), content);
    });

    console.log('âœ… API å‹åˆ¥ç”Ÿæˆå®Œæˆ');
  } catch (error) {
    console.error('âŒ API å‹åˆ¥ç”Ÿæˆå¤±æ•—:', error);
    process.exit(1);
  }
}

generateApiTypes();
```

#### API å®¢æˆ¶ç«¯å‹åˆ¥å®‰å…¨

```typescript
// lib/api-client.ts
import createClient from 'openapi-fetch';
import type { paths } from '@/types/api';

/**
 * å‹åˆ¥å®‰å…¨çš„ API å®¢æˆ¶ç«¯
 * 100% å‹åˆ¥å®‰å…¨ï¼Œè‡ªå‹•åŒæ­¥å¾Œç«¯ API è®Šæ›´
 */
const apiClient = createClient<paths>({
  baseUrl: import.meta.env.VITE_API_BASE_URL || 'http://localhost:8000',
  headers: {
    'Content-Type': 'application/json',
    'Accept': 'application/json',
  },
});

/**
 * è«‹æ±‚æ””æˆªå™¨ - è‡ªå‹•æ·»åŠ èªè­‰ Token
 */
apiClient.use({
  onRequest({ request }) {
    const token = localStorage.getItem('auth_token');
    if (token) {
      request.headers.set('Authorization', `Bearer ${token}`);
    }
    return request;
  },
  onResponse({ response }) {
    // è™•ç† 401 æœªæˆæ¬ŠéŒ¯èª¤
    if (response.status === 401) {
      localStorage.removeItem('auth_token');
      window.location.href = '/login';
    }
    return response;
  },
});

export default apiClient;
```

### ğŸ”„ ç‹€æ…‹ç®¡ç†è¦ç¯„

#### Zustand Store è¨­è¨ˆ

```typescript
// store/auth-store.ts
import { create } from 'zustand';
import { persist } from 'zustand/middleware';
import apiClient from '@/lib/api-client';
import type { User } from '@/types/api';

/**
 * èªè­‰ç‹€æ…‹ä»‹é¢
 */
interface AuthState {
  // ç‹€æ…‹
  user: User | null;
  token: string | null;
  isAuthenticated: boolean;
  isLoading: boolean;

  // Actions
  login: (email: string, password: string) => Promise<void>;
  logout: () => void;
  refreshUser: () => Promise<void>;
  updateUser: (userData: Partial<User>) => void;
}

/**
 * èªè­‰ç‹€æ…‹ç®¡ç† Store
 * è™•ç†ä½¿ç”¨è€…ç™»å…¥ã€ç™»å‡ºã€è³‡æ–™æ›´æ–°ç­‰èªè­‰ç›¸é—œé‚è¼¯
 */
export const useAuthStore = create<AuthState>()(
  persist(
    (set, get) => ({
      // åˆå§‹ç‹€æ…‹
      user: null,
      token: null,
      isAuthenticated: false,
      isLoading: false,

      // ç™»å…¥å‡½æ•¸
      login: async (email: string, password: string) => {
        set({ isLoading: true });
        
        try {
          const { data, error } = await apiClient.POST('/api/auth/login', {
            body: { email, password }
          });

          if (error) {
            throw new Error('ç™»å…¥å¤±æ•—');
          }

          set({
            user: data.user,
            token: data.token,
            isAuthenticated: true,
            isLoading: false
          });

          localStorage.setItem('auth_token', data.token);
        } catch (error) {
          set({ isLoading: false });
          throw error;
        }
      },

      // ç™»å‡ºå‡½æ•¸
      logout: () => {
        set({
          user: null,
          token: null,
          isAuthenticated: false,
          isLoading: false
        });
        
        localStorage.removeItem('auth_token');
      },

      // é‡æ–°æ•´ç†ä½¿ç”¨è€…è³‡è¨Š
      refreshUser: async () => {
        const token = localStorage.getItem('auth_token');
        if (!token) return;

        try {
          const { data, error } = await apiClient.GET('/api/auth/me');

          if (error) {
            get().logout();
            return;
          }

          set({
            user: data,
            token,
            isAuthenticated: true
          });
        } catch (error) {
          get().logout();
        }
      },

      // æ›´æ–°ä½¿ç”¨è€…è³‡æ–™
      updateUser: (userData) => {
        set(state => ({
          user: state.user ? { ...state.user, ...userData } : null
        }));
      }
    }),
    {
      name: 'auth-storage',
      partialize: (state) => ({
        user: state.user,
        token: state.token,
        isAuthenticated: state.isAuthenticated
      })
    }
  )
);
```

#### TanStack Query æ•´åˆ

```typescript
// hooks/api/use-product-categories.ts
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { useAuthStore } from '@/store/auth-store';
import apiClient from '@/lib/api-client';
import type { ProductCategory } from '@/types/api';

/**
 * å•†å“åˆ†é¡ API Hooks
 * æä¾›å®Œæ•´çš„ CRUD æ“ä½œå’Œå¿«å–ç®¡ç†
 */

/**
 * æŸ¥è©¢å•†å“åˆ†é¡åˆ—è¡¨
 */
export function useProductCategories(params?: {
  search?: string;
  status?: boolean;
  per_page?: number;
  page?: number;
}) {
  return useQuery({
    queryKey: ['product-categories', params],
    queryFn: async () => {
      const { data, error } = await apiClient.GET('/api/product-categories', {
        params: { query: params }
      });
      
      if (error) {
        throw new Error('å–å¾—å•†å“åˆ†é¡åˆ—è¡¨å¤±æ•—');
      }
      
      return data;
    },
    staleTime: 5 * 60 * 1000, // 5 åˆ†é˜å¿«å–
  });
}

/**
 * æŸ¥è©¢å–®ä¸€å•†å“åˆ†é¡
 */
export function useProductCategory(id: number) {
  return useQuery({
    queryKey: ['product-categories', id],
    queryFn: async () => {
      const { data, error } = await apiClient.GET('/api/product-categories/{id}', {
        params: { path: { id } }
      });
      
      if (error) {
        throw new Error('å–å¾—å•†å“åˆ†é¡å¤±æ•—');
      }
      
      return data;
    },
    enabled: !!id,
  });
}

/**
 * å»ºç«‹å•†å“åˆ†é¡
 */
export function useCreateProductCategory() {
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: async (data: Omit<ProductCategory, 'id' | 'created_at' | 'updated_at'>) => {
      const { data: result, error } = await apiClient.POST('/api/product-categories', {
        body: data
      });
      
      if (error) {
        throw new Error('å»ºç«‹å•†å“åˆ†é¡å¤±æ•—');
      }
      
      return result;
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['product-categories'] });
    },
  });
}

/**
 * æ›´æ–°å•†å“åˆ†é¡
 */
export function useUpdateProductCategory() {
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: async ({ id, data }: { id: number; data: Partial<ProductCategory> }) => {
      const { data: result, error } = await apiClient.PUT('/api/product-categories/{id}', {
        params: { path: { id } },
        body: data
      });
      
      if (error) {
        throw new Error('æ›´æ–°å•†å“åˆ†é¡å¤±æ•—');
      }
      
      return result;
    },
    onSuccess: (_, { id }) => {
      queryClient.invalidateQueries({ queryKey: ['product-categories'] });
      queryClient.invalidateQueries({ queryKey: ['product-categories', id] });
    },
  });
}

/**
 * åˆªé™¤å•†å“åˆ†é¡
 */
export function useDeleteProductCategory() {
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: async (id: number) => {
      const { error } = await apiClient.DELETE('/api/product-categories/{id}', {
        params: { path: { id } }
      });
      
      if (error) {
        throw new Error('åˆªé™¤å•†å“åˆ†é¡å¤±æ•—');
      }
      
      return true;
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['product-categories'] });
    },
  });
}
```

---

## ğŸ§ª æ¸¬è©¦æ¨™æº–

### ğŸ“Š æ¸¬è©¦é‡‘å­—å¡”ç­–ç•¥

```
     5% E2E æ¸¬è©¦
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  E2E Tests   â”‚  â† Playwright (é—œéµä½¿ç”¨è€…æµç¨‹)
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ Integration Test â”‚ â† React Testing Library + API æ•´åˆ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Unit Tests      â”‚ â† Jest + Vitest (æ¥­å‹™é‚è¼¯)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        70%
```

### ğŸ”§ å¾Œç«¯æ¸¬è©¦æ¨™æº–

#### Pest æ¸¬è©¦æ¡†æ¶

```php
<?php

// tests/Feature/ProductCategoryTest.php

use App\Models\ProductCategory;
use App\Models\User;
use App\Models\Store;

/**
 * å•†å“åˆ†é¡åŠŸèƒ½æ¸¬è©¦
 * æ¸¬è©¦å®Œæ•´çš„ CRUD æ“ä½œå’Œæ¥­å‹™é‚è¼¯
 */
describe('ProductCategory API', function () {
    beforeEach(function () {
        $this->store = Store::factory()->create();
        $this->user = User::factory()->create(['store_id' => $this->store->id]);
        $this->actingAs($this->user, 'sanctum');
    });

    describe('GET /api/product-categories', function () {
        it('æ‡‰è©²è¿”å›åˆ†é çš„å•†å“åˆ†é¡åˆ—è¡¨', function () {
            // æº–å‚™æ¸¬è©¦è³‡æ–™
            ProductCategory::factory(5)->create(['store_id' => $this->store->id]);
            ProductCategory::factory(3)->create(); // å…¶ä»–é–€å¸‚çš„è³‡æ–™
            
            // åŸ·è¡Œ API è«‹æ±‚
            $response = $this->getJson('/api/product-categories');
            
            // é©—è­‰å›æ‡‰
            $response->assertOk()
                ->assertJsonStructure([
                    'success',
                    'message',
                    'data' => [
                        '*' => [
                            'id',
                            'name',
                            'slug',
                            'description',
                            'status',
                            'position',
                            'store_id',
                            'created_at',
                            'updated_at'
                        ]
                    ],
                    'meta' => [
                        'current_page',
                        'last_page',
                        'per_page',
                        'total'
                    ]
                ]);
            
            // é©—è­‰åªè¿”å›ç•¶å‰é–€å¸‚çš„è³‡æ–™
            expect($response->json('data'))->toHaveCount(5);
            expect($response->json('meta.total'))->toBe(5);
        });

        it('æ‡‰è©²æ”¯æ´æœå°‹ç¯©é¸', function () {
            ProductCategory::factory()->create([
                'name' => 'é›»å­ç”¢å“',
                'store_id' => $this->store->id
            ]);
            ProductCategory::factory()->create([
                'name' => 'å®¶å…·ç”¨å“',
                'store_id' => $this->store->id
            ]);
            
            $response = $this->getJson('/api/product-categories?search=é›»å­');
            
            $response->assertOk();
            expect($response->json('data'))->toHaveCount(1);
            expect($response->json('data.0.name'))->toBe('é›»å­ç”¢å“');
        });
    });

    describe('POST /api/product-categories', function () {
        it('æ‡‰è©²èƒ½å»ºç«‹æ–°çš„å•†å“åˆ†é¡', function () {
            $data = [
                'name' => 'æ–°åˆ†é¡',
                'description' => 'æ¸¬è©¦åˆ†é¡æè¿°',
                'status' => true,
                'position' => 10
            ];
            
            $response = $this->postJson('/api/product-categories', $data);
            
            $response->assertCreated()
                ->assertJsonFragment([
                    'name' => 'æ–°åˆ†é¡',
                    'slug' => 'new-category',
                    'store_id' => $this->store->id
                ]);
            
            $this->assertDatabaseHas('product_categories', [
                'name' => 'æ–°åˆ†é¡',
                'store_id' => $this->store->id
            ]);
        });

        it('æ‡‰è©²é©—è­‰å¿…å¡«æ¬„ä½', function () {
            $response = $this->postJson('/api/product-categories', []);
            
            $response->assertUnprocessable()
                ->assertJsonValidationErrors(['name']);
        });

        it('æ‡‰è©²ç¢ºä¿ slug åœ¨é–€å¸‚å…§å”¯ä¸€', function () {
            ProductCategory::factory()->create([
                'slug' => 'existing-category',
                'store_id' => $this->store->id
            ]);
            
            $response = $this->postJson('/api/product-categories', [
                'name' => 'ç¾æœ‰åˆ†é¡',
                'slug' => 'existing-category'
            ]);
            
            $response->assertUnprocessable()
                ->assertJsonValidationErrors(['slug']);
        });
    });
});
```

#### Repository å–®å…ƒæ¸¬è©¦

```php
<?php

// tests/Unit/Repositories/ProductCategoryRepositoryTest.php

use App\Models\ProductCategory;
use App\Models\Store;
use App\Repositories\ProductCategoryRepository;

/**
 * ProductCategoryRepository å–®å…ƒæ¸¬è©¦
 */
describe('ProductCategoryRepository', function () {
    beforeEach(function () {
        $this->repository = new ProductCategoryRepository();
        $this->store = Store::factory()->create();
    });

    describe('findBySlug', function () {
        it('æ‡‰è©²æ ¹æ“š slug æ‰¾åˆ°å•†å“åˆ†é¡', function () {
            $category = ProductCategory::factory()->create([
                'slug' => 'test-category',
                'store_id' => $this->store->id
            ]);
            
            $result = $this->repository->findBySlug('test-category', $this->store->id);
            
            expect($result)->not->toBeNull();
            expect($result->id)->toBe($category->id);
        });

        it('æ‡‰è©²åœ¨æ‰¾ä¸åˆ°æ™‚è¿”å› null', function () {
            $result = $this->repository->findBySlug('non-existent', $this->store->id);
            
            expect($result)->toBeNull();
        });
    });

    describe('getTree', function () {
        it('æ‡‰è©²è¿”å›éšå±¤å¼æ¨¹ç‹€çµæ§‹', function () {
            $parent = ProductCategory::factory()->create([
                'name' => 'çˆ¶åˆ†é¡',
                'store_id' => $this->store->id
            ]);
            
            $child1 = ProductCategory::factory()->create([
                'name' => 'å­åˆ†é¡1',
                'parent_id' => $parent->id,
                'store_id' => $this->store->id
            ]);
            
            $child2 = ProductCategory::factory()->create([
                'name' => 'å­åˆ†é¡2',
                'parent_id' => $parent->id,
                'store_id' => $this->store->id
            ]);
            
            $tree = $this->repository->getTree($this->store->id);
            
            expect($tree)->toHaveCount(1);
            expect($tree[0]->children)->toHaveCount(2);
            expect($tree[0]->children[0]->name)->toBe('å­åˆ†é¡1');
        });
    });
});
```

### ğŸ­ å‰ç«¯æ¸¬è©¦æ¨™æº–

#### React Testing Library çµ„ä»¶æ¸¬è©¦

```typescript
// __tests__/components/product-category-list.test.tsx
import { render, screen, fireEvent, waitFor } from '@testing-library/react';
import { QueryClient, QueryClientProvider } from '@tanstack/react-query';
import { ProductCategoryList } from '@/pages/product-categories/components/product-category-list';
import { useProductCategories } from '@/hooks/api/use-product-categories';

// Mock API Hook
jest.mock('@/hooks/api/use-product-categories');
const mockUseProductCategories = useProductCategories as jest.MockedFunction<typeof useProductCategories>;

/**
 * å•†å“åˆ†é¡åˆ—è¡¨çµ„ä»¶æ¸¬è©¦
 */
describe('ProductCategoryList', function () {
  let queryClient: QueryClient;

  beforeEach(() => {
    queryClient = new QueryClient({
      defaultOptions: {
        queries: { retry: false },
        mutations: { retry: false },
      },
    });
  });

  const renderWithProviders = (component: React.ReactElement) => {
    return render(
      <QueryClientProvider client={queryClient}>
        {component}
      </QueryClientProvider>
    );
  };

  it('æ‡‰è©²é¡¯ç¤ºè¼‰å…¥ç‹€æ…‹', () => {
    mockUseProductCategories.mockReturnValue({
      data: undefined,
      isLoading: true,
      isError: false,
      refetch: jest.fn(),
    } as any);

    renderWithProviders(<ProductCategoryList />);

    expect(screen.getByTestId('loading-spinner')).toBeInTheDocument();
  });

  it('æ‡‰è©²é¡¯ç¤ºå•†å“åˆ†é¡åˆ—è¡¨', () => {
    const mockData = {
      data: [
        {
          id: 1,
          name: 'é›»å­ç”¢å“',
          slug: 'electronics',
          status: true,
          position: 1,
          created_at: '2023-01-01T00:00:00Z',
          updated_at: '2023-01-01T00:00:00Z',
        },
        {
          id: 2,
          name: 'å®¶å…·ç”¨å“',
          slug: 'furniture',
          status: false,
          position: 2,
          created_at: '2023-01-01T00:00:00Z',
          updated_at: '2023-01-01T00:00:00Z',
        },
      ],
      meta: {
        current_page: 1,
        last_page: 1,
        per_page: 20,
        total: 2,
      }
    };

    mockUseProductCategories.mockReturnValue({
      data: mockData,
      isLoading: false,
      isError: false,
      refetch: jest.fn(),
    } as any);

    renderWithProviders(<ProductCategoryList />);

    expect(screen.getByText('é›»å­ç”¢å“')).toBeInTheDocument();
    expect(screen.getByText('å®¶å…·ç”¨å“')).toBeInTheDocument();
    expect(screen.getByText('electronics')).toBeInTheDocument();
    expect(screen.getByText('å•Ÿç”¨')).toBeInTheDocument();
    expect(screen.getByText('åœç”¨')).toBeInTheDocument();
  });

  it('æ‡‰è©²æ”¯æ´æœå°‹åŠŸèƒ½', async () => {
    const mockRefetch = jest.fn();
    mockUseProductCategories.mockReturnValue({
      data: { data: [], meta: {} },
      isLoading: false,
      isError: false,
      refetch: mockRefetch,
    } as any);

    renderWithProviders(<ProductCategoryList />);

    const searchInput = screen.getByPlaceholderText('æœå°‹åˆ†é¡åç¨±...');
    fireEvent.change(searchInput, { target: { value: 'é›»å­' } });

    await waitFor(() => {
      expect(mockUseProductCategories).toHaveBeenCalledWith(
        expect.objectContaining({
          search: 'é›»å­'
        })
      );
    });
  });

  it('æ‡‰è©²è™•ç†éŒ¯èª¤ç‹€æ…‹', () => {
    const mockRefetch = jest.fn();
    mockUseProductCategories.mockReturnValue({
      data: undefined,
      isLoading: false,
      isError: true,
      refetch: mockRefetch,
    } as any);

    renderWithProviders(<ProductCategoryList />);

    expect(screen.getByText('è¼‰å…¥è³‡æ–™æ™‚ç™¼ç”ŸéŒ¯èª¤')).toBeInTheDocument();
    
    const retryButton = screen.getByText('é‡è©¦');
    fireEvent.click(retryButton);
    
    expect(mockRefetch).toHaveBeenCalled();
  });
});
```

#### Hook æ¸¬è©¦

```typescript
// __tests__/hooks/use-product-categories.test.ts
import { renderHook, waitFor } from '@testing-library/react';
import { QueryClient, QueryClientProvider } from '@tanstack/react-query';
import { useProductCategories } from '@/hooks/api/use-product-categories';
import apiClient from '@/lib/api-client';

// Mock API Client
jest.mock('@/lib/api-client');
const mockApiClient = apiClient as jest.Mocked<typeof apiClient>;

/**
 * useProductCategories Hook æ¸¬è©¦
 */
describe('useProductCategories', () => {
  let queryClient: QueryClient;

  beforeEach(() => {
    queryClient = new QueryClient({
      defaultOptions: {
        queries: { retry: false },
        mutations: { retry: false },
      },
    });
  });

  const wrapper = ({ children }: { children: React.ReactNode }) => (
    <QueryClientProvider client={queryClient}>
      {children}
    </QueryClientProvider>
  );

  it('æ‡‰è©²æˆåŠŸç²å–å•†å“åˆ†é¡è³‡æ–™', async () => {
    const mockData = {
      data: [{ id: 1, name: 'æ¸¬è©¦åˆ†é¡' }],
      meta: { total: 1 }
    };

    mockApiClient.GET.mockResolvedValueOnce({
      data: mockData,
      error: undefined
    } as any);

    const { result } = renderHook(
      () => useProductCategories({ search: 'æ¸¬è©¦' }),
      { wrapper }
    );

    await waitFor(() => {
      expect(result.current.isSuccess).toBe(true);
    });

    expect(result.current.data).toEqual(mockData);
    expect(mockApiClient.GET).toHaveBeenCalledWith('/api/product-categories', {
      params: { query: { search: 'æ¸¬è©¦' } }
    });
  });

  it('æ‡‰è©²è™•ç† API éŒ¯èª¤', async () => {
    mockApiClient.GET.mockResolvedValueOnce({
      data: undefined,
      error: { message: 'API éŒ¯èª¤' }
    } as any);

    const { result } = renderHook(
      () => useProductCategories(),
      { wrapper }
    );

    await waitFor(() => {
      expect(result.current.isError).toBe(true);
    });

    expect(result.current.error).toBeInstanceOf(Error);
  });
});
```

### ğŸ¯ E2E æ¸¬è©¦æ¨™æº–

#### Playwright E2E æ¸¬è©¦

```typescript
// e2e/product-categories.spec.ts
import { test, expect } from '@playwright/test';

/**
 * å•†å“åˆ†é¡ E2E æ¸¬è©¦
 * æ¸¬è©¦å®Œæ•´çš„ä½¿ç”¨è€…æµç¨‹
 */
test.describe('å•†å“åˆ†é¡ç®¡ç†', () => {
  test.beforeEach(async ({ page }) => {
    // ç™»å…¥ç³»çµ±
    await page.goto('/login');
    await page.fill('[data-testid=email-input]', 'admin@example.com');
    await page.fill('[data-testid=password-input]', 'password123');
    await page.click('[data-testid=login-button]');
    
    // ç­‰å¾…ç™»å…¥å®Œæˆ
    await expect(page).toHaveURL('/dashboard');
    
    // å°èˆªåˆ°å•†å“åˆ†é¡é é¢
    await page.click('[data-testid=nav-product-categories]');
    await expect(page).toHaveURL('/product-categories');
  });

  test('æ‡‰è©²èƒ½æŸ¥çœ‹å•†å“åˆ†é¡åˆ—è¡¨', async ({ page }) => {
    // é©—è­‰é é¢æ¨™é¡Œ
    await expect(page.locator('h1')).toContainText('å•†å“åˆ†é¡ç®¡ç†');
    
    // é©—è­‰è¡¨æ ¼å­˜åœ¨
    await expect(page.locator('[data-testid=categories-table]')).toBeVisible();
    
    // é©—è­‰è‡³å°‘æœ‰ä¸€ç­†è³‡æ–™
    await expect(page.locator('tbody tr')).toHaveCountGreaterThan(0);
  });

  test('æ‡‰è©²èƒ½å»ºç«‹æ–°çš„å•†å“åˆ†é¡', async ({ page }) => {
    // é»æ“Šæ–°å¢æŒ‰éˆ•
    await page.click('[data-testid=add-category-button]');
    
    // å¡«å¯«è¡¨å–®
    await page.fill('[data-testid=name-input]', 'æ¸¬è©¦åˆ†é¡');
    await page.fill('[data-testid=description-input]', 'é€™æ˜¯ä¸€å€‹æ¸¬è©¦åˆ†é¡');
    
    // æäº¤è¡¨å–®
    await page.click('[data-testid=save-button]');
    
    // é©—è­‰æˆåŠŸè¨Šæ¯
    await expect(page.locator('[data-testid=success-message]')).toContainText('å»ºç«‹æˆåŠŸ');
    
    // é©—è­‰è³‡æ–™å‡ºç¾åœ¨åˆ—è¡¨ä¸­
    await expect(page.locator('tbody')).toContainText('æ¸¬è©¦åˆ†é¡');
  });

  test('æ‡‰è©²èƒ½ç·¨è¼¯å•†å“åˆ†é¡', async ({ page }) => {
    // é»æ“Šç¬¬ä¸€ç­†è³‡æ–™çš„ç·¨è¼¯æŒ‰éˆ•
    await page.click('tbody tr:first-child [data-testid=edit-button]');
    
    // ä¿®æ”¹åç¨±
    await page.fill('[data-testid=name-input]', 'ä¿®æ”¹å¾Œçš„åˆ†é¡');
    
    // æäº¤è¡¨å–®
    await page.click('[data-testid=save-button]');
    
    // é©—è­‰æˆåŠŸè¨Šæ¯
    await expect(page.locator('[data-testid=success-message]')).toContainText('æ›´æ–°æˆåŠŸ');
    
    // é©—è­‰è³‡æ–™å·²æ›´æ–°
    await expect(page.locator('tbody')).toContainText('ä¿®æ”¹å¾Œçš„åˆ†é¡');
  });

  test('æ‡‰è©²èƒ½åˆªé™¤å•†å“åˆ†é¡', async ({ page }) => {
    // è¨˜éŒ„åˆªé™¤å‰çš„è³‡æ–™æ•¸é‡
    const initialCount = await page.locator('tbody tr').count();
    
    // é»æ“Šç¬¬ä¸€ç­†è³‡æ–™çš„åˆªé™¤æŒ‰éˆ•
    await page.click('tbody tr:first-child [data-testid=delete-button]');
    
    // ç¢ºèªåˆªé™¤
    await page.click('[data-testid=confirm-delete-button]');
    
    // é©—è­‰æˆåŠŸè¨Šæ¯
    await expect(page.locator('[data-testid=success-message]')).toContainText('åˆªé™¤æˆåŠŸ');
    
    // é©—è­‰è³‡æ–™æ•¸é‡æ¸›å°‘
    await expect(page.locator('tbody tr')).toHaveCount(initialCount - 1);
  });

  test('æ‡‰è©²æ”¯æ´æœå°‹ç¯©é¸', async ({ page }) => {
    // åœ¨æœå°‹æ¡†è¼¸å…¥é—œéµå­—
    await page.fill('[data-testid=search-input]', 'é›»å­');
    
    // ç­‰å¾…æœå°‹çµæœ
    await page.waitForTimeout(500);
    
    // é©—è­‰æœå°‹çµæœåªåŒ…å«ç›¸é—œè³‡æ–™
    const rows = page.locator('tbody tr');
    const count = await rows.count();
    
    for (let i = 0; i < count; i++) {
      await expect(rows.nth(i)).toContainText('é›»å­', { ignoreCase: true });
    }
  });
});
```

--- 

## ğŸ“š å·²å¯¦ç¾æ¨¡çµ„æ¸…å–®

### âœ… å®Œæˆæ¨¡çµ„åˆ—è¡¨

| æ¨¡çµ„åç¨± | ç‰ˆæœ¬ | é–‹ç™¼ç‹€æ…‹ | æ¸¬è©¦è¦†è“‹ç‡ | é–‹ç™¼è€… | å®Œæˆæ—¥æœŸ |
|---------|------|----------|-----------|--------|----------|
| **å•†å“åˆ†é¡æ¨¡çµ„** | v2.3 | âœ… ä¼æ¥­ç´šå®Œæˆ | 95%+ | åœ˜éšŠ | 2025-01 |
| **ä½¿ç”¨è€…ç®¡ç†æ¨¡çµ„** | v6.2 | âœ… ä¼æ¥­ç´šå®Œæˆ | 100% | åœ˜éšŠ | 2025-01 |
| ä½¿ç”¨è€…èªè­‰æ¨¡çµ„ | v1.0 | ğŸŸ¡ åŸºç¤å®Œæˆ | 85%+ | å¾…å®š | è¨ˆåŠƒä¸­ |
| æ¬Šé™ç®¡ç†æ¨¡çµ„ | - | ğŸ“ è¦åŠƒä¸­ | - | å¾…åˆ†é… | å¾…å®š |
| å•†å“ç®¡ç†æ¨¡çµ„ | - | ğŸ“ è¦åŠƒä¸­ | - | å¾…åˆ†é… | å¾…å®š |
| è¨‚å–®ç®¡ç†æ¨¡çµ„ | - | ğŸ“ è¦åŠƒä¸­ | - | å¾…åˆ†é… | å¾…å®š |

### ğŸ¯ å•†å“åˆ†é¡æ¨¡çµ„ v2.3 è©³ç´°è¦æ ¼

#### å¾Œç«¯å¯¦ç¾ç‹€æ…‹
- âœ… **Model**: `ProductCategory` - å®Œæ•´çš„é–€å¸‚éš”é›¢ã€è»Ÿåˆªé™¤ã€éšå±¤çµæ§‹
- âœ… **Repository**: `ProductCategoryRepository` - å®Œæ•´çš„ CRUDã€æ¨¹ç‹€æŸ¥è©¢ã€å¿«å–
- âœ… **Service**: `ProductCategoryService` - æ¥­å‹™é‚è¼¯ã€äº‹å‹™è™•ç†ã€é©—è­‰
- âœ… **Controller**: `ProductCategoryController` - RESTful APIã€æ¬Šé™æª¢æŸ¥
- âœ… **Policy**: `ProductCategoryPolicy` - ç´°ç²’åº¦æ¬Šé™æ§åˆ¶
- âœ… **Observer**: `ProductCategoryObserver` - è‡ªå‹•åŒ–è™•ç†ã€å¿«å–æ¸…ç†
- âœ… **Request**: å®Œæ•´çš„é©—è­‰è¦å‰‡ã€éŒ¯èª¤è¨Šæ¯
- âœ… **Resource**: æ¨™æº–åŒ–çš„ API å›æ‡‰æ ¼å¼
- âœ… **Migration**: æ¨™æº–è¡¨æ ¼çµæ§‹ã€ç´¢å¼•å„ªåŒ–
- âœ… **Factory**: æ¸¬è©¦è³‡æ–™ç”Ÿæˆ
- âœ… **Seeder**: åˆå§‹è³‡æ–™å¡«å……

#### å‰ç«¯å¯¦ç¾ç‹€æ…‹
- âœ… **Pages**: åˆ—è¡¨ã€å»ºç«‹ã€ç·¨è¼¯ã€è©³æƒ…é é¢
- âœ… **Components**: è¡¨æ ¼ã€è¡¨å–®ã€ç¯©é¸å™¨ã€æ¨¹ç‹€çµæ§‹
- âœ… **Hooks**: å®Œæ•´çš„ CRUD Hooksã€å¿«å–ç®¡ç†
- âœ… **Types**: 100% å‹åˆ¥å®‰å…¨
- âœ… **Store**: Zustand ç‹€æ…‹ç®¡ç†
- âœ… **Routes**: å®Œæ•´è·¯ç”±é…ç½®

#### æ¸¬è©¦å¯¦ç¾ç‹€æ…‹
- âœ… **Unit Tests**: Repositoryã€Serviceã€Hook æ¸¬è©¦
- âœ… **Feature Tests**: API ç«¯é»æ¸¬è©¦
- âœ… **Component Tests**: React çµ„ä»¶æ¸¬è©¦
- âœ… **E2E Tests**: å®Œæ•´ä½¿ç”¨è€…æµç¨‹æ¸¬è©¦

### ğŸš€ ä½¿ç”¨è€…ç®¡ç†æ¨¡çµ„ v6.2 è©³ç´°è¦æ ¼ (é€²éšåƒè€ƒ)

ä½¿ç”¨è€…ç®¡ç†æ¨¡çµ„ V6.2 ä»£è¡¨äº†æœ¬å°ˆæ¡ˆ**æœ€æ–°çš„ã€æœ€å…¨é¢çš„ä¼æ¥­ç´šå¯¦è¸**ï¼Œæ˜¯æ‰€æœ‰æ–°æ¨¡çµ„é–‹ç™¼çš„**å„ªå…ˆåƒè€ƒæ¨™æº–**ã€‚å®ƒæˆåŠŸæ•´åˆäº† Spatie ç”Ÿæ…‹ç³»çµ±ï¼Œä¸¦å¼•å…¥äº†å‰µæ–°çš„è³‡æ–™åº«è¨­è¨ˆæ¨¡å¼ã€‚

#### **æ ¸å¿ƒæŠ€è¡“å‰µæ–° (V6.2 ç¨æœ‰)**

##### 1. **Spatie ç”Ÿæ…‹ç³»çµ±æ·±åº¦æ•´åˆ**
- âœ… **æ¬Šé™ç®¡ç†**: `spatie/laravel-permission` + é–€å¸‚éš”é›¢æ“´å±•
- âœ… **æ´»å‹•è¨˜éŒ„**: `spatie/laravel-activitylog` + éš±ç§ä¿è­·æ©Ÿåˆ¶
- âœ… **åª’é«”ç®¡ç†**: `spatie/laravel-medialibrary` + é ­åƒä¸Šå‚³è½‰æ›
- âœ… **API æŸ¥è©¢**: `spatie/laravel-query-builder` + æ™ºèƒ½ç¯©é¸

##### 2. **V6.2 å‰µæ–°è³‡æ–™åº«æ¨¡å¼**
- âœ… **è»Ÿåˆªé™¤å”¯ä¸€æ€§ç´„æŸ**: MySQL è¨ˆç®—æ¬„ä½ `username_active`, `email_active`
- âœ… **é›¶æ‡‰ç”¨ç¨‹å¼æ„ŸçŸ¥**: 100% è³‡æ–™åº«å±¤é¢è§£æ±ºæ–¹æ¡ˆ
- âœ… **è³‡æºé‡ç”¨**: è»Ÿåˆªé™¤å¾Œå¯ç«‹å³é‡æ–°è¨»å†Šç›¸åŒç”¨æˆ¶å/éƒµç®±

##### 3. **å®Œæ•´é–€å¸‚éš”é›¢æ¶æ§‹**
- âœ… **æ™ºèƒ½æ¬Šé™**: ç®¡ç†å“¡å¯è·¨é–€å¸‚ï¼Œä¸€èˆ¬ä½¿ç”¨è€…é™åˆ¶é–€å¸‚
- âœ… **Spatie æ•´åˆ**: é–€å¸‚éš”é›¢èˆ‡ Permission ç³»çµ±å®Œç¾çµåˆ
- âœ… **æ´»å‹•è¿½è¹¤**: è·¨é–€å¸‚æ“ä½œçš„å®Œæ•´å¯©è¨ˆè»Œè·¡

#### **å¾Œç«¯å¯¦ç¾ç‹€æ…‹ (100% å®Œæˆ)**
- âœ… **Traits**: `HasStoreIsolation`, `HasAuditFields` - ä¼æ¥­ç´šå…±ç”¨é‚è¼¯
- âœ… **Model**: `User` - æ•´åˆæ‰€æœ‰ Spatie Traits (HasRoles + LogsActivity + InteractsWithMedia)
- âœ… **Repository**: `UserRepository` - 34 å€‹å®Œæ•´æ–¹æ³•ï¼ŒåŒ…å«å®‰å…¨æŸ¥è©¢ã€æ‰¹æ¬¡æ“ä½œã€çµ±è¨ˆåˆ†æ
- âœ… **Service**: `UserService` - ä¼æ¥­ç´šæ¥­å‹™é‚è¼¯ï¼Œ2FA æ”¯æ´ï¼Œåª’é«”ç®¡ç†
- âœ… **Cache**: `UserCacheService` - Spatie å¿«å–æ·±åº¦æ•´åˆï¼Œæ™ºèƒ½å¤±æ•ˆç­–ç•¥
- âœ… **Controller**: `UserController`, `AuthController` - å®Œæ•´ RESTful + è‡ªè¨‚ç«¯é»
- âœ… **Policy**: `UserPolicy` - åŸºæ–¼ Spatie Permission çš„ç´°ç²’åº¦æ¬Šé™
- âœ… **Observer**: `UserObserver` - å¿«å–æ¸…é™¤ + Spatie å¥—ä»¶å¿«å–åŒæ­¥
- âœ… **Request**: 5 å€‹é©—è­‰é¡åˆ¥ï¼ŒåŒ…å« V6.2 è»Ÿåˆªé™¤å”¯ä¸€æ€§é©—è­‰
- âœ… **Resource**: `UserResource`, `UserCollection` - å®Œæ•´åˆ†é çµæ§‹
- âœ… **Migration**: V6.2 è»Ÿåˆªé™¤å‰µæ–°æ¨¡å¼ + è¨ˆç®—æ¬„ä½å¯¦ç¾
- âœ… **Factory**: å®Œæ•´æ¸¬è©¦è³‡æ–™ç”Ÿæˆï¼Œæ”¯æ´è§’è‰²æ¬Šé™
- âœ… **Seeder**: ç®¡ç†å“¡å¸³è™Ÿ + æ¬Šé™çŸ©é™£åˆå§‹åŒ–

#### **å‰ç«¯å¯¦ç¾ç‹€æ…‹ (100% å®Œæˆ)**
- âœ… **Pages**: ä½¿ç”¨è€…åˆ—è¡¨ã€å»ºç«‹ã€ç·¨è¼¯ã€å€‹äººè³‡æ–™ã€2FA è¨­å®š
- âœ… **Components**: é«˜åº¦è¤‡ç”¨çš„è¡¨æ ¼ã€è¡¨å–®ã€å°è©±æ¡†çµ„ä»¶
- âœ… **Hooks**: å®Œæ•´çš„ CRUD + è§’è‰²æ¬Šé™ + åª’é«”ä¸Šå‚³ Hooks
- âœ… **Types**: 100% å‹åˆ¥å®‰å…¨ï¼Œèˆ‡å¾Œç«¯ API è‡ªå‹•åŒæ­¥
- âœ… **Store**: Zustand ä½¿ç”¨è€…ç‹€æ…‹ + æ¬Šé™ç‹€æ…‹ç®¡ç†
- âœ… **Routes**: æ¬Šé™å®ˆè¡› + å·¢ç‹€è·¯ç”±é…ç½®

#### **æ¸¬è©¦å¯¦ç¾ç‹€æ…‹ (100% è¦†è“‹)**
- âœ… **Unit Tests**: 15 å€‹æ¸¬è©¦ï¼Œ130 å€‹æ–·è¨€ï¼ŒService + Repository å®Œæ•´è¦†è“‹
- âœ… **Feature Tests**: API ç«¯é» + Spatie æ•´åˆæ¸¬è©¦
- âœ… **Component Tests**: React çµ„ä»¶ + Hook æ¸¬è©¦
- âœ… **Integration Tests**: Spatie å¥—ä»¶æ•´åˆé©—è­‰
- âœ… **E2E Tests**: 2FA æµç¨‹ + åª’é«”ä¸Šå‚³å®Œæ•´æ¸¬è©¦

#### **V6.2 é–‹ç™¼åƒ¹å€¼ (æŠ€è¡“å‚µå‹™å„Ÿé‚„)**
- ğŸ”¥ **æ¸›å°‘ 60%+ é–‹ç™¼æ™‚é–“**: é€é Spatie ç”Ÿæ…‹ç³»çµ±æ¨™æº–åŒ–
- ğŸ›¡ï¸ **æå‡å®‰å…¨ç­‰ç´š**: ä¼æ¥­ç´šæ¬Šé™ + æ´»å‹•è¿½è¹¤ + åª’é«”å®‰å…¨
- ğŸ“ˆ **é•·æœŸç¶­è­·æˆæœ¬é™ä½**: è·Ÿéš¨ Laravel ç”Ÿæ…‹ç³»çµ±æ¼”é€²
- ğŸ§ª **100% æ¸¬è©¦è¦†è“‹**: ä¿è­‰ç”Ÿç”¢ç’°å¢ƒç©©å®šæ€§
- ğŸ“š **å®Œæ•´æ–‡æª”**: ç¤¾ç¾¤æ”¯æ´ + ä¼æ¥­ç´šè¨»è§£

#### **æ–°æ¨¡çµ„é–‹ç™¼æŒ‡å°åŸå‰‡**
1. **å„ªå…ˆåƒè€ƒ V6.2 æ¨¡å¼**: æ‰€æœ‰æ–°æ¨¡çµ„æ‡‰ä»¥ä½¿ç”¨è€…ç®¡ç†æ¨¡çµ„ V6.2 ç‚ºè¨­è¨ˆè—åœ–
2. **å¼·åˆ¶ä½¿ç”¨ Spatie ç”Ÿæ…‹**: æ¬Šé™ã€æ—¥èªŒã€åª’é«”åŠŸèƒ½å¿…é ˆä½¿ç”¨å°æ‡‰çš„ Spatie å¥—ä»¶
3. **æ¡ç”¨ V6.2 è³‡æ–™åº«æ¨¡å¼**: æ¶‰åŠè»Ÿåˆªé™¤å”¯ä¸€æ€§ç´„æŸæ™‚ï¼Œå¿…é ˆä½¿ç”¨è¨ˆç®—æ¬„ä½è§£æ±ºæ–¹æ¡ˆ
4. **è¤‡ç”¨ V6.2 å…±ç”¨å…ƒä»¶**: Traitsã€Servicesã€çµ„ä»¶ç­‰å¯ç›´æ¥è¤‡ç”¨æˆ–æ“´å±•

---

## â™»ï¸ å…±ç”¨å…ƒä»¶åº«

### ğŸ”§ å¾Œç«¯å…±ç”¨å…ƒä»¶

#### åŸºç¤é¡åˆ¥
```php
// æ‰€æœ‰æ¨¡çµ„å¿…é ˆä½¿ç”¨çš„åŸºç¤é¡åˆ¥
app/Models/BaseModel.php              âœ… å·²å¯¦ç¾ - é–€å¸‚éš”é›¢ã€è»Ÿåˆªé™¤ã€å¯©è¨ˆ
app/Http/Controllers/BaseController.php  âœ… å·²å¯¦ç¾ - API å›æ‡‰æ ¼å¼ã€éŒ¯èª¤è™•ç†
app/Services/BaseService.php         âœ… å·²å¯¦ç¾ - äº‹å‹™è™•ç†ã€æ¥­å‹™é‚è¼¯åŸºç¤
app/Repositories/BaseRepository.php  âœ… å·²å¯¦ç¾ - æ¨™æº– CRUD æ“ä½œ
app/Policies/BasePolicy.php          âœ… å·²å¯¦ç¾ - æ¬Šé™æª¢æŸ¥åŸºç¤é‚è¼¯
```

#### ä¾‹å¤–è™•ç†
```php
app/Exceptions/BusinessException.php  âœ… å·²å¯¦ç¾ - æ¥­å‹™é‚è¼¯ä¾‹å¤–
app/Enums/ErrorCode.php              âœ… å·²å¯¦ç¾ - çµ±ä¸€éŒ¯èª¤ä»£ç¢¼
```

#### å¿«å–æœå‹™
```php
app/Services/BaseCacheService.php    âœ… å·²å¯¦ç¾ - Redis å¿«å–ç®¡ç†
```

#### API å›æ‡‰è™•ç†
```php
app/Traits/ApiResponseTrait.php      âœ… å·²å¯¦ç¾ - çµ±ä¸€ API å›æ‡‰æ ¼å¼
```

### ğŸ¨ å‰ç«¯å…±ç”¨å…ƒä»¶

#### shadcn/ui åŸºç¤çµ„ä»¶
```typescript
components/ui/button.tsx              âœ… å·²å¯¦ç¾ - æŒ‰éˆ•çµ„ä»¶
components/ui/input.tsx               âœ… å·²å¯¦ç¾ - è¼¸å…¥æ¡†çµ„ä»¶
components/ui/dialog.tsx              âœ… å·²å¯¦ç¾ - å°è©±æ¡†çµ„ä»¶
components/ui/select.tsx              âœ… å·²å¯¦ç¾ - é¸æ“‡å™¨çµ„ä»¶
components/ui/badge.tsx               âœ… å·²å¯¦ç¾ - å¾½ç« çµ„ä»¶
components/ui/table.tsx               âœ… å·²å¯¦ç¾ - è¡¨æ ¼çµ„ä»¶
```

#### è¤‡åˆåŠŸèƒ½çµ„ä»¶
```typescript
components/common/confirm-dialog.tsx  âœ… å·²å¯¦ç¾ - ç¢ºèªå°è©±æ¡†
components/common/data-table.tsx      âœ… å·²å¯¦ç¾ - æ•¸æ“šè¡¨æ ¼
components/common/loading-spinner.tsx âœ… å·²å¯¦ç¾ - è¼‰å…¥æŒ‡ç¤ºå™¨
components/common/error-boundary.tsx  âœ… å·²å¯¦ç¾ - éŒ¯èª¤é‚Šç•Œ
components/common/permission-guard.tsx âœ… å·²å¯¦ç¾ - æ¬Šé™å®ˆè¡›
components/common/pagination.tsx      âœ… å·²å¯¦ç¾ - åˆ†é çµ„ä»¶
```

#### API å®¢æˆ¶ç«¯
```typescript
lib/api-client.ts                     âœ… å·²å¯¦ç¾ - å‹åˆ¥å®‰å…¨çš„ API å®¢æˆ¶ç«¯
```

#### çµ±ä¸€ API Hooks
```typescript
hooks/api/use-list.ts                 âœ… å·²å¯¦ç¾ - åˆ—è¡¨æŸ¥è©¢ Hook
hooks/api/use-create.ts               âœ… å·²å¯¦ç¾ - å»ºç«‹è³‡æº Hook
hooks/api/use-update.ts               âœ… å·²å¯¦ç¾ - æ›´æ–°è³‡æº Hook
hooks/api/use-delete.ts               âœ… å·²å¯¦ç¾ - åˆªé™¤è³‡æº Hook
```

#### è¡¨å–®è™•ç†
```typescript
hooks/forms/use-form-validation.ts    âœ… å·²å¯¦ç¾ - React Hook Form + Zod æ•´åˆ
components/forms/form-field.tsx       âœ… å·²å¯¦ç¾ - çµ±ä¸€è¡¨å–®æ¬„ä½
components/forms/form-wrapper.tsx     âœ… å·²å¯¦ç¾ - è¡¨å–®å®¹å™¨
```

### ğŸ“‹ é–‹ç™¼å·¥ä½œæµç¨‹æ¨™æº–

#### æ–°æ¨¡çµ„é–‹ç™¼æµç¨‹ (å¼·åˆ¶éµå¾ª)
1. **éœ€æ±‚åˆ†æ** â†’ ç¢ºèªæ¨¡çµ„åŠŸèƒ½ç¯„åœå’Œä¾è³´é—œä¿‚
2. **æ¶æ§‹è¨­è¨ˆ** â†’ éµå¾ªæœ¬æ‰‹å†Šçš„è¨­è¨ˆæ¨¡å¼
3. **è³‡æ–™åº«è¨­è¨ˆ** â†’ ä½¿ç”¨æ¨™æº–è¡¨æ ¼çµæ§‹å’Œç´¢å¼•
4. **å¾Œç«¯é–‹ç™¼** â†’ Repository â†’ Service â†’ Controller â†’ Tests
5. **å‰ç«¯é–‹ç™¼** â†’ Hooks â†’ Components â†’ Pages â†’ Tests
6. **æ•´åˆæ¸¬è©¦** â†’ API æ¸¬è©¦ â†’ E2E æ¸¬è©¦
7. **ç¨‹å¼ç¢¼å¯©æ ¸** â†’ éµå¾ªæª¢æŸ¥æ¸…å–®
8. **éƒ¨ç½²ä¸Šç·š** â†’ CI/CD æµç¨‹

#### å…±ç”¨å…ƒä»¶ä½¿ç”¨è¦å‰‡ (ä¸å¯é•èƒŒ)
1. **å¼·åˆ¶ä½¿ç”¨**: æ‰€æœ‰æ¨¡çµ„å¿…é ˆä½¿ç”¨å·²å¯¦ç¾çš„å…±ç”¨å…ƒä»¶
2. **ç¦æ­¢é‡è¤‡**: ä¸å¾—é‡æ–°å¯¦ç¾å·²å­˜åœ¨çš„åŠŸèƒ½
3. **æ“´å±•è¦ç¯„**: éœ€è¦æ–°åŠŸèƒ½æ™‚ï¼Œå…ˆæ“´å±•å…±ç”¨å…ƒä»¶å†ä½¿ç”¨
4. **ç‰ˆæœ¬ç®¡ç†**: å…±ç”¨å…ƒä»¶è®Šæ›´éœ€è¦ç‰ˆæœ¬è™Ÿç®¡ç†

---

## ğŸš« çµ•å°ç¦æ­¢è¡Œç‚º

### âŒ æ¶æ§‹é•è¦è¡Œç‚º (é›¶å®¹å¿)

#### å¾Œç«¯ç¦æ­¢è¡Œç‚º
1. **âŒ è·³é Repository å±¤ç›´æ¥åœ¨ Controller ä¸­æ“ä½œ Model**
   ```php
   // çµ•å°ç¦æ­¢
   public function index() {
       return ProductCategory::where('store_id', auth()->user()->store_id)->get();
   }
   
   // å¿…é ˆä½¿ç”¨
   public function index() {
       return $this->service->getList();
   }
   ```

2. **âŒ åœ¨ Repository ä¸­è™•ç†æ¥­å‹™é‚è¼¯**
   ```php
   // çµ•å°ç¦æ­¢
   public function create($data) {
       if ($data['parent_id']) {
           // æ¥­å‹™é‚è¼¯ä¸æ‡‰åœ¨ Repository ä¸­
           $parent = $this->find($data['parent_id']);
           $data['depth'] = $parent->depth + 1;
       }
       return $this->model->create($data);
   }
   ```

3. **âŒ ä¸ä½¿ç”¨äº‹å‹™è™•ç†å¯«æ“ä½œ**
   ```php
   // çµ•å°ç¦æ­¢
   public function create($data) {
       $category = $this->repository->create($data);
       $this->updateParentCount($category->parent_id);
       return $category;
   }
   
   // å¿…é ˆä½¿ç”¨äº‹å‹™
   public function create($data) {
       return DB::transaction(function () use ($data) {
           $category = $this->repository->create($data);
           $this->updateParentCount($category->parent_id);
           return $category;
       });
   }
   ```

4. **âŒ å¿½ç•¥é–€å¸‚éš”é›¢æ©Ÿåˆ¶**
   ```php
   // çµ•å°ç¦æ­¢
   ProductCategory::withoutGlobalScope('store')->get();
   ```

5. **âŒ ç¡¬ç·¨ç¢¼é­”è¡“æ•¸å­—å’Œå­—ä¸²**
   ```php
   // çµ•å°ç¦æ­¢
   if ($user->role === 'admin') { ... }
   
   // å¿…é ˆä½¿ç”¨æšèˆ‰
   if ($user->role === UserRole::ADMIN) { ... }
   ```

#### å‰ç«¯ç¦æ­¢è¡Œç‚º
1. **âŒ çµ„ä»¶ç›´æ¥èª¿ç”¨ API**
   ```typescript
   // çµ•å°ç¦æ­¢
   const Component = () => {
     useEffect(() => {
       fetch('/api/categories').then(...);
     }, []);
   };
   
   // å¿…é ˆä½¿ç”¨ Hooks
   const Component = () => {
     const { data } = useProductCategories();
   };
   ```

2. **âŒ ä¸ä½¿ç”¨ TypeScript æˆ–å¿½ç•¥å‹åˆ¥æª¢æŸ¥**
   ```typescript
   // çµ•å°ç¦æ­¢
   const data: any = response.data;
   
   // å¿…é ˆä½¿ç”¨æ­£ç¢ºå‹åˆ¥
   const data: ProductCategory[] = response.data;
   ```

3. **âŒ è·³ééŒ¯èª¤è™•ç†**
   ```typescript
   // çµ•å°ç¦æ­¢
   const handleSubmit = async (data) => {
     await createCategory(data);
     navigate('/categories');
   };
   
   // å¿…é ˆè™•ç†éŒ¯èª¤
   const handleSubmit = async (data) => {
     try {
       await createCategory(data);
       navigate('/categories');
     } catch (error) {
       showError(error.message);
     }
   };
   ```

4. **âŒ é‡è¤‡å¯¦ç¾å·²å­˜åœ¨çš„çµ„ä»¶**
   ```typescript
   // çµ•å°ç¦æ­¢ï¼šé‡æ–°å¯¦ç¾æŒ‰éˆ•
   const CustomButton = ({ children, onClick }) => (
     <button className="custom-btn" onClick={onClick}>
       {children}
     </button>
   );
   
   // å¿…é ˆä½¿ç”¨å…±ç”¨çµ„ä»¶
   import { Button } from '@/components/ui/button';
   ```

#### é€šç”¨ç¦æ­¢è¡Œç‚º
1. **âŒ ä¸éµå¾ªå‘½åè¦ç¯„**
2. **âŒ ä¸å¯«è¨»é‡‹æˆ–æ–‡æª”**
3. **âŒ ä¸é€²è¡Œæ¸¬è©¦**
4. **âŒ è·³é Code Review**
5. **âŒ ä¸ä½¿ç”¨ Git åˆ†æ”¯ç­–ç•¥**
6. **âŒ ç¡¬ç·¨ç¢¼æ•æ„Ÿè³‡è¨Š**
7. **âŒ ä¸è™•ç†ä¾‹å¤–æƒ…æ³**
8. **âŒ ä½¿ç”¨å·²æ£„ç”¨çš„æŠ€è¡“**

### âš ï¸ é•è¦å¾Œæœ
- **ç¬¬ä¸€æ¬¡**: è­¦å‘Š + å¼·åˆ¶é‡æ§‹
- **ç¬¬äºŒæ¬¡**: ç¨‹å¼ç¢¼æ¬Šé™æš«åœ + åŸ¹è¨“
- **ç¬¬ä¸‰æ¬¡**: å°ˆæ¡ˆç§»é™¤

---

## âœ… é–‹ç™¼æª¢æŸ¥æ¸…å–®

### ğŸ“‹ æ–°åŠŸèƒ½é–‹ç™¼æª¢æŸ¥

#### ğŸ¯ é–‹ç™¼å‰æª¢æŸ¥
- [ ] **éœ€æ±‚ç¢ºèª**: åŠŸèƒ½éœ€æ±‚å·²æ˜ç¢ºå®šç¾©
- [ ] **æŠ€è¡“é¸å‹**: ç¢ºèªä½¿ç”¨æŒ‡å®šçš„æŠ€è¡“æ£§ï¼Œç„¡æ›¿ä»£æ–¹æ¡ˆ
- [ ] **ä¾è³´åˆ†æ**: ç¢ºèªå°ç¾æœ‰æ¨¡çµ„çš„ä¾è³´é—œä¿‚
- [ ] **è³‡æ–™åº«è¨­è¨ˆ**: éµå¾ªæ¨™æº–è¡¨æ ¼è¨­è¨ˆè¦ç¯„
- [ ] **API è¨­è¨ˆ**: éµå¾ª RESTful è¨­è¨ˆåŸå‰‡
- [ ] **æ¬Šé™è¨­è¨ˆ**: ç¢ºèªæ¬Šé™æª¢æŸ¥æ©Ÿåˆ¶

#### âš™ï¸ å¾Œç«¯é–‹ç™¼æª¢æŸ¥
- [ ] **Model ç¹¼æ‰¿**: ç¹¼æ‰¿ `BaseModel` ä¸¦å¯¦ç¾é–€å¸‚éš”é›¢
- [ ] **Repository ä»‹é¢**: å¯¦ç¾ `RepositoryInterface` ä¸¦æ³¨å…¥ DI å®¹å™¨
- [ ] **Service å±¤**: å¯¦ç¾ `ServiceInterface` ä¸¦è™•ç†æ¥­å‹™é‚è¼¯
- [ ] **Controller**: ç¹¼æ‰¿ `BaseController` ä¸¦å¯¦ç¾æ¨™æº– CRUD
- [ ] **Policy**: å¯¦ç¾æ¬Šé™æª¢æŸ¥é‚è¼¯
- [ ] **Observer**: å¯¦ç¾æ¨¡å‹äº‹ä»¶è™•ç†
- [ ] **Request é©—è­‰**: å¯¦ç¾å®Œæ•´çš„è¼¸å…¥é©—è­‰
- [ ] **Resource**: å¯¦ç¾æ¨™æº–åŒ–çš„ API å›æ‡‰
- [ ] **Migration**: éµå¾ªè³‡æ–™åº«è¨­è¨ˆæ¨™æº–
- [ ] **ç•°å¸¸è™•ç†**: ä½¿ç”¨ `BusinessException` è™•ç†æ¥­å‹™éŒ¯èª¤

#### ğŸ¨ å‰ç«¯é–‹ç™¼æª¢æŸ¥
- [ ] **å‹åˆ¥å®šç¾©**: 100% TypeScript è¦†è“‹ï¼Œç„¡ `any` å‹åˆ¥
- [ ] **API æ•´åˆ**: ä½¿ç”¨å‹åˆ¥å®‰å…¨çš„ API å®¢æˆ¶ç«¯
- [ ] **Hooks å¯¦ç¾**: å¯¦ç¾å®Œæ•´çš„ CRUD Hooks
- [ ] **çµ„ä»¶è¨­è¨ˆ**: éµå¾ªçµ„ä»¶å±¤ç´šæ¶æ§‹
- [ ] **ç‹€æ…‹ç®¡ç†**: æ­£ç¢ºä½¿ç”¨ Zustand + TanStack Query
- [ ] **éŒ¯èª¤è™•ç†**: å¯¦ç¾å®Œæ•´çš„éŒ¯èª¤è™•ç†æ©Ÿåˆ¶
- [ ] **è¼‰å…¥ç‹€æ…‹**: è™•ç†æ‰€æœ‰çš„è¼‰å…¥å’ŒéŒ¯èª¤ç‹€æ…‹
- [ ] **æ¬Šé™æ§åˆ¶**: ä½¿ç”¨ `PermissionGuard` çµ„ä»¶
- [ ] **éŸ¿æ‡‰å¼è¨­è¨ˆ**: æ”¯æ´æ‰€æœ‰è¢å¹•å°ºå¯¸
- [ ] **ç„¡éšœç¤™æ€§**: éµå¾ª WCAG 2.1 æ¨™æº–

#### ğŸ§ª æ¸¬è©¦æª¢æŸ¥
- [ ] **å–®å…ƒæ¸¬è©¦**: è¦†è“‹ç‡ â‰¥ 85% (å¾Œç«¯) / â‰¥ 80% (å‰ç«¯)
- [ ] **æ•´åˆæ¸¬è©¦**: API ç«¯é»å®Œæ•´æ¸¬è©¦
- [ ] **çµ„ä»¶æ¸¬è©¦**: React çµ„ä»¶åŠŸèƒ½æ¸¬è©¦
- [ ] **E2E æ¸¬è©¦**: é—œéµä½¿ç”¨è€…æµç¨‹æ¸¬è©¦
- [ ] **æ•ˆèƒ½æ¸¬è©¦**: è¼‰å…¥æ™‚é–“ < 3 ç§’
- [ ] **å®‰å…¨æ¸¬è©¦**: SQL æ³¨å…¥ã€XSS é˜²è­·æ¸¬è©¦
- [ ] **Pure Bearer Token é©—è­‰**: Authorization æ¨™é ­èªè­‰æ­£å¸¸
- [ ] **å®Œå…¨å—æ§çµ„ä»¶**: é€šç”¨çµ„ä»¶ç„¡å…§éƒ¨ç‹€æ…‹ï¼Œå®Œå…¨é€šé props æ§åˆ¶
- [ ] **API åˆç´„ä¸€è‡´æ€§**: OpenAPI è¦ç¯„èˆ‡å¯¦éš› API å›æ‡‰ 100% ä¸€è‡´
- [ ] **React Hooks è¦ç¯„**: æ‰€æœ‰å›èª¿å‡½æ•¸ä½¿ç”¨ useCallbackï¼Œä¾è³´é™£åˆ—æœ€å°åŒ–

### ğŸ” ç¨‹å¼ç¢¼å“è³ªæª¢æŸ¥

#### ğŸ“ ç¨‹å¼ç¢¼å¯©æ ¸æ¸…å–®
- [ ] **å‘½åè¦ç¯„**: éµå¾ªçµ±ä¸€å‘½åæ¨™æº–
- [ ] **ç¨‹å¼ç¢¼è¨»é‡‹**: æ¯å€‹å‡½æ•¸éƒ½æœ‰å®Œæ•´è¨»é‡‹
- [ ] **éŒ¯èª¤è™•ç†**: æ‰€æœ‰å¯èƒ½çš„éŒ¯èª¤éƒ½æœ‰è™•ç†
- [ ] **æ•ˆèƒ½å„ªåŒ–**: ç„¡æ˜é¡¯æ•ˆèƒ½ç“¶é ¸
- [ ] **å®‰å…¨æª¢æŸ¥**: ç„¡å®‰å…¨æ¼æ´
- [ ] **é‡è¤‡ç¨‹å¼ç¢¼**: ç„¡é‡è¤‡å¯¦ç¾çš„åŠŸèƒ½
- [ ] **ä¾è³´æ³¨å…¥**: æ­£ç¢ºä½¿ç”¨ DI æ¨¡å¼
- [ ] **è¨­è¨ˆæ¨¡å¼**: éµå¾ª SOLID åŸå‰‡

#### ğŸš¨ è‡ªå‹•åŒ–æª¢æŸ¥
- [ ] **ESLint**: ç„¡ Lint éŒ¯èª¤æˆ–è­¦å‘Š
- [ ] **Prettier**: ç¨‹å¼ç¢¼æ ¼å¼åŒ–ä¸€è‡´
- [ ] **PHPStan**: Level 8 éœæ…‹åˆ†æé€šé
- [ ] **TypeScript**: åš´æ ¼æ¨¡å¼æª¢æŸ¥é€šé
- [ ] **æ¸¬è©¦è¦†è“‹ç‡**: é”åˆ°æœ€ä½è¦æ±‚æ¨™æº–
- [ ] **å»ºç½®æª¢æŸ¥**: CI/CD æµç¨‹å…¨éƒ¨é€šé

### ğŸ“¦ éƒ¨ç½²å‰æª¢æŸ¥

#### ğŸ”§ ç’°å¢ƒé…ç½®
- [ ] **ç’°å¢ƒè®Šæ•¸**: æ­£ç¢ºé…ç½®æ‰€æœ‰å¿…è¦çš„ç’°å¢ƒè®Šæ•¸
- [ ] **è³‡æ–™åº«é·ç§»**: Migration å·²åŸ·è¡Œä¸”å¯å›æ»¾
- [ ] **ç¨®å­è³‡æ–™**: åŸºç¤è³‡æ–™å·²æ­£ç¢ºå¡«å……
- [ ] **å¿«å–é…ç½®**: Redis å¿«å–æ­£å¸¸é‹ä½œ
- [ ] **æª”æ¡ˆæ¬Šé™**: å„²å­˜ç›®éŒ„æ¬Šé™æ­£ç¢º
- [ ] **SSL æ†‘è­‰**: HTTPS é…ç½®æ­£ç¢º

#### ğŸ“Š æ•ˆèƒ½æª¢æŸ¥
- [ ] **è³‡æ–™åº«æŸ¥è©¢**: ç„¡ N+1 æŸ¥è©¢å•é¡Œ
- [ ] **ç´¢å¼•å„ªåŒ–**: é—œéµæŸ¥è©¢éƒ½æœ‰é©ç•¶ç´¢å¼•
- [ ] **API å›æ‡‰æ™‚é–“**: < 500ms
- [ ] **å‰ç«¯è¼‰å…¥æ™‚é–“**: < 3 ç§’
- [ ] **è¨˜æ†¶é«”ä½¿ç”¨**: ç„¡è¨˜æ†¶é«”æ´©æ¼
- [ ] **ç£ç¢Ÿç©ºé–“**: å……è¶³çš„å„²å­˜ç©ºé–“

#### ğŸ” å®‰å…¨æª¢æŸ¥
- [ ] **èº«ä»½é©—è­‰**: æ‰€æœ‰ç«¯é»éƒ½æœ‰é©ç•¶çš„èªè­‰
- [ ] **æ¬Šé™æ§åˆ¶**: ç´°ç²’åº¦æ¬Šé™æª¢æŸ¥
- [ ] **è³‡æ–™é©—è­‰**: è¼¸å…¥è³‡æ–™å®Œæ•´é©—è­‰
- [ ] **SQL æ³¨å…¥**: é˜²è­·æ©Ÿåˆ¶æœ‰æ•ˆ
- [ ] **XSS æ”»æ“Š**: é˜²è­·æ©Ÿåˆ¶æœ‰æ•ˆ
- [ ] **Pure Bearer Token é©—è­‰**: Authorization æ¨™é ­èªè­‰æ­£å¸¸
- [ ] **å®Œå…¨å—æ§çµ„ä»¶**: é€šç”¨çµ„ä»¶ç„¡å…§éƒ¨ç‹€æ…‹ï¼Œå®Œå…¨é€šé props æ§åˆ¶
- [ ] **API åˆç´„ä¸€è‡´æ€§**: OpenAPI è¦ç¯„èˆ‡å¯¦éš› API å›æ‡‰ 100% ä¸€è‡´
- [ ] **React Hooks è¦ç¯„**: æ‰€æœ‰å›èª¿å‡½æ•¸ä½¿ç”¨ useCallbackï¼Œä¾è³´é™£åˆ—æœ€å°åŒ–

### ğŸ“‹ ç™¼å¸ƒæª¢æŸ¥æ¸…å–®

#### âœ… æœ€çµ‚ç¢ºèª
- [ ] **åŠŸèƒ½æ¸¬è©¦**: æ‰€æœ‰åŠŸèƒ½æ­£å¸¸é‹ä½œ
- [ ] **ç€è¦½å™¨ç›¸å®¹**: æ”¯æ´ä¸»æµç€è¦½å™¨
- [ ] **è¡Œå‹•è£ç½®**: è¡Œå‹•ç«¯é«”é©—è‰¯å¥½
- [ ] **æ–‡æª”æ›´æ–°**: ç›¸é—œæ–‡æª”å·²æ›´æ–°
- [ ] **ç‰ˆæœ¬æ¨™è¨˜**: Git æ¨™ç±¤å·²å»ºç«‹
- [ ] **åœ˜éšŠé€šçŸ¥**: ç›¸é—œäººå“¡å·²é€šçŸ¥
- [ ] **ç›£æ§è¨­å®š**: ç”Ÿç”¢ç’°å¢ƒç›£æ§å·²è¨­å®š
- [ ] **å›æ»¾è¨ˆåŠƒ**: ç·Šæ€¥å›æ»¾æ–¹æ¡ˆå·²æº–å‚™

---

## ğŸ“Š å“è³ªæ¨™æº–ç›£æ§

### ğŸ¯ ç¨‹å¼ç¢¼å“è³ªæŒ‡æ¨™

| æŒ‡æ¨™ | æœ€ä½æ¨™æº– | ç›®æ¨™æ¨™æº– | ç•¶å‰ç‹€æ…‹ |
|------|----------|----------|----------|
| **å¾Œç«¯æ¸¬è©¦è¦†è“‹ç‡** | 85% | 95% | ğŸŸ¢ 95%+ |
| **å‰ç«¯æ¸¬è©¦è¦†è“‹ç‡** | 80% | 90% | ğŸŸ¢ 85%+ |
| **TypeScript åš´æ ¼åº¦** | 100% | 100% | ğŸŸ¢ 100% |
| **ESLint é›¶è­¦å‘Š** | å¿…é ˆ | å¿…é ˆ | ğŸŸ¢ é€šé |
| **PHPStan Level** | 8 | 8 | ğŸŸ¢ Level 8 |
| **API å›æ‡‰æ™‚é–“** | < 500ms | < 200ms | ğŸŸ¢ < 300ms |
| **å‰ç«¯è¼‰å…¥æ™‚é–“** | < 3s | < 1.5s | ğŸŸ¢ < 2s |

### ğŸ“ˆ æŒçºŒæ”¹é€²è¨ˆåŠƒ

#### æ¯é€±æª¢æŸ¥
- ç¨‹å¼ç¢¼è¦†è“‹ç‡å ±å‘Š
- æ•ˆèƒ½ç›£æ§å ±å‘Š
- å®‰å…¨æƒæå ±å‘Š

#### æ¯æœˆæª¢æŸ¥
- æ¶æ§‹æ¨™æº–éµå¾ªåº¦å¯©æ ¸
- æŠ€è¡“å‚µå‹™è©•ä¼°
- åœ˜éšŠåŸ¹è¨“éœ€æ±‚åˆ†æ

#### å­£åº¦æª¢æŸ¥
- æ¶æ§‹æ¨™æº–æ›´æ–°
- å·¥å…·éˆå‡ç´šè¨ˆåŠƒ
- æœ€ä½³å¯¦è¸åˆ†äº«

---

## ğŸ“ æ”¯æ´èˆ‡å›é¥‹

### ğŸ†˜ æŠ€è¡“æ”¯æ´
- **æ¶æ§‹å•é¡Œ**: è¯ç¹«æ¶æ§‹è² è²¬äºº
- **é–‹ç™¼ç–‘å•**: æŸ¥é–±æœ¬æ‰‹å†Šæˆ–è©¢å•åœ˜éšŠ
- **å·¥å…·å•é¡Œ**: åƒè€ƒå·¥å…·å®˜æ–¹æ–‡æª”

### ğŸ“ æ–‡æª”å›é¥‹
å¦‚ç™¼ç¾æœ¬æ‰‹å†Šæœ‰ä»»ä½•å•é¡Œæˆ–æ”¹é€²å»ºè­°ï¼š
1. å»ºç«‹ GitHub Issue
2. æäº¤ Pull Request
3. è¯ç¹«å°ˆæ¡ˆç¶­è­·è€…

### ğŸ”„ ç‰ˆæœ¬æ­·å²

#### ğŸ“ˆ **V4.0 (2025-01-08) - é©å‘½æ€§æ¶æ§‹å‡ç´š**
**ğŸ¯ æ ¸å¿ƒè®Šé©**:
- ğŸš€ **Pure Bearer Token èªè­‰æ¶æ§‹**: å®Œå…¨æ¨æ£„ Session/Cookieï¼Œå¯¦ç¾ 100% ç„¡ç‹€æ…‹è¨­è¨ˆ
  - API å†·å•Ÿå‹•æ€§èƒ½æå‡ **98%+** (å¾ 800ms é™è‡³ â‰¤50ms)
  - å¾®æœå‹™å°±ç·’æ¶æ§‹ï¼Œæ”¯æ´æ°´å¹³æ“´å±•
  - æ¶ˆé™¤ CSRF æ”»æ“Šé¢ï¼Œå®‰å…¨æ€§å¤§å¹…æå‡
- ğŸ”’ **å¼·åˆ¶ API åˆç´„æ¸¬è©¦**: 
  - CI/CD å¼·åˆ¶é©—è­‰ OpenAPI è¦ç¯„èˆ‡å¯¦éš› API å›æ‡‰çš„ 100% ä¸€è‡´æ€§
  - è‡ªå‹•åŒ–å‹åˆ¥ç”Ÿæˆï¼Œæ¶ˆé™¤å‰å¾Œç«¯ä»‹é¢ä¸åŒ¹é…å•é¡Œ
  - å»ºç«‹æ¥­ç•Œæœ€åš´æ ¼çš„ API å“è³ªä¿è­‰æ©Ÿåˆ¶
- ğŸ­ **å®Œå…¨å—æ§çµ„ä»¶è¨­è¨ˆå“²å­¸**: 
  - æ‰€æœ‰é€šç”¨çµ„ä»¶å¼·åˆ¶ç„¡å…§éƒ¨ç‹€æ…‹ï¼Œå®Œå…¨é€šé props æ§åˆ¶
  - å¯¦ç¾æœ€é«˜ç´šåˆ¥çš„çµ„ä»¶é‡ç”¨æ€§å’Œå¯æ¸¬è©¦æ€§
  - å»ºç«‹æ¸…æ™°çš„ç‹€æ…‹ç®¡ç†è²¬ä»»é‚Šç•Œ
- âš›ï¸ **React Hooks æœ€ä½³å¯¦è¸æ¨™æº–**: 
  - å¼·åˆ¶æ‰€æœ‰å›èª¿å‡½æ•¸ä½¿ç”¨ useCallback åŒ…è£
  - useEffect ä¾è³´é™£åˆ—æœ€å°åŒ–ï¼Œæ ¹é™¤ç„¡é™é‡æ¸²æŸ“
  - çµ„ä»¶æ¸²æŸ“æ•ˆèƒ½æœ€ä½³åŒ–ï¼Œè¨˜æ†¶é«”ä½¿ç”¨å„ªåŒ–

**ğŸ† æŠ€è¡“çªç ´**:
- **å•Ÿå‹•é€Ÿåº¦**: å¾å‚³çµ±æ¶æ§‹çš„ 800ms é™è‡³ **â‰¤50ms**
- **API ä¸€è‡´æ€§**: é”åˆ°æ¥­ç•Œç½•è¦‹çš„ **100% å‹åˆ¥æº–ç¢ºåº¦**
- **çµ„ä»¶é‡ç”¨ç‡**: é€šç”¨çµ„ä»¶é‡ç”¨ç‡æå‡è‡³ **95%+**
- **æ¸²æŸ“æ•ˆèƒ½**: ç„¡é™é‡æ¸²æŸ“å•é¡Œ **100% æ ¹é™¤**

#### ğŸ“‹ **V3.0 (2025-01-07) - ä¼æ¥­ç´šç”Ÿæ…‹æ•´åˆ**
- ğŸ§‘â€ğŸ’¼ **ç”¨æˆ¶ç®¡ç†æ¨¡çµ„ V6.2**: Spatie ç”Ÿæ…‹ç³»çµ±å®Œæ•´æ•´åˆ
- ğŸ” **è»Ÿåˆªé™¤å”¯ä¸€ç´„æŸ**: ä¼æ¥­ç´šè³‡æ–™å®Œæ•´æ€§ä¿éšœ
- ğŸ›¡ï¸ **é›™å› ç´ èªè­‰ (2FA)**: å®‰å…¨æ€§æ¨™æº–å‡ç´š
- ğŸ“ **åª’é«”ç®¡ç†ç³»çµ±**: Spatie MediaLibrary æ•´åˆ
- ğŸ“Š **æ´»å‹•æ—¥èªŒè¿½è¹¤**: å®Œæ•´å¯©è¨ˆè»Œè·¡

#### ğŸŒ³ **V2.4 (2025-01-07) - åˆ†å±¤æ¶æ§‹æ¨™ç«¿**
- ğŸ·ï¸ **å•†å“åˆ†é¡æ¨¡çµ„ v2.3**: ä¼æ¥­ç´šéšå±¤ç®¡ç†æ¨™æº–
- âš¡ **é«˜æ•ˆå¿«å–ç­–ç•¥**: Redis æ¨™ç±¤å¼ + æ ¹åˆ†ç‰‡ + é˜²æŠ–å‹•
- ğŸ“ˆ **è±å¯Œçµ±è¨ˆåŠŸèƒ½**: æ·±åº¦çµ±è¨ˆã€ç¯€é»è¨ˆæ•¸ã€è¶¨å‹¢åˆ†æ
- ğŸ”’ **ç´°ç²’åº¦æ¬Šé™**: Sanctum Token ç²¾ç¢ºæ§åˆ¶
- ğŸ“„ **é›™é‡åˆ†é **: æ¨™æº–åˆ†é  + æ¸¸æ¨™åˆ†é æ”¯æ´

#### ğŸ”„ **æŒçºŒæ¼”é€²**
- **V1.0-V2.3**: åŸºç¤æ¶æ§‹å»ºç«‹ã€æ ¸å¿ƒæ¨¡çµ„å¯¦ç¾
- **æœªä¾†è¦åŠƒ**: åŸºæ–¼ V4.0 æ¶æ§‹çš„å¾®æœå‹™åŒ–ã€AI æ•´åˆã€åœ‹éš›åŒ–

---

## ğŸ“Š LomisX3 V4.0 å°ˆæ¡ˆå…ƒæ•¸æ“š

```json
{
  "project": "LomisX3 ä¼æ¥­ç´šç®¡ç†ç³»çµ±",
  "version": "4.0.0",
  "architectureHandbook": "V4.0 (2025-01-08)",
  "lastUpdated": "2025-01-08",
  "architecture": "Pure Bearer Token + å®Œå…¨å—æ§çµ„ä»¶ + API åˆç´„é©—è­‰",
  
  "techStack": {
    "backend": {
      "language": "PHP >= 8.2",
      "framework": "Laravel >= 12.0",
      "database": "MySQL >= 8.0",
      "cache": "Redis >= 7.0 (ç´”å¿«å–æ¨¡å¼)",
      "auth": "Laravel Sanctum (Pure Bearer Token)",
      "permissions": "Spatie Permission >= 6.9",
      "testing": "PHPUnit/Pest >= 11.5",
      "quality": "Laravel Pint + PHPStan Level 8"
    },
    "frontend": {
      "framework": "React >= 19.1",
      "language": "TypeScript >= 5.8 (åš´æ ¼æ¨¡å¼)",
      "ui": "shadcn/ui (å”¯ä¸€æŒ‡å®š) + Tailwind CSS >= 3.4",
      "state": "TanStack Query >= 5.80 + Zustand",
      "form": "React Hook Form >= 7.57 + Zod >= 3.25",
      "router": "React Router >= 7.6",
      "build": "Vite >= 6.3"
    }
  },

  "completedModules": {
    "ProductCategory": {
      "status": "âœ… ä¼æ¥­ç´šå®Œæˆ",
      "version": "v2.3",
      "completion": "100%",
      "testCoverage": "95%+",
      "features": ["éšå±¤çµæ§‹", "é«˜æ•ˆå¿«å–", "çµ±è¨ˆåŠŸèƒ½", "å®‰å…¨æ¬Šé™", "é›™é‡åˆ†é "]
    },
    "UserManagement": {
      "status": "âœ… ä¼æ¥­ç´šå®Œæˆ", 
      "version": "v6.2",
      "completion": "100%",
      "testCoverage": "100%",
      "features": ["Spatie æ•´åˆ", "è»Ÿåˆªé™¤å”¯ä¸€ç´„æŸ", "2FA", "åª’é«”ç®¡ç†", "æ´»å‹•æ—¥èªŒ"]
    }
  },

  "v4BreakthroughFeatures": {
    "pureBearerToken": {
      "description": "é©å‘½æ€§ 100% ç„¡ç‹€æ…‹èªè­‰æ¶æ§‹",
      "technicalAdvantages": [
        "å®Œå…¨æ¨æ£„ Session/Cookie ä¾è³´",
        "API å†·å•Ÿå‹•å¾ 800ms é™è‡³ â‰¤50ms (98%+ æå‡)",
        "å¾®æœå‹™å°±ç·’ï¼Œæ”¯æ´ç„¡é™æ°´å¹³æ“´å±•",
        "æ¶ˆé™¤ CSRF æ”»æ“Šé¢ï¼Œå®‰å…¨æ€§è³ªçš„é£›èº"
      ],
      "businessValue": [
        "ç³»çµ±å›æ‡‰é€Ÿåº¦å¤§å¹…æå‡ï¼Œç”¨æˆ¶é«”é©—é¡¯è‘—æ”¹å–„",
        "ç‚ºæœªä¾†å¾®æœå‹™æ¶æ§‹å¥ å®šå …å¯¦åŸºç¤",
        "é™ä½ç¶­é‹æˆæœ¬ï¼Œç°¡åŒ–éƒ¨ç½²æµç¨‹",
        "æå‡ç³»çµ±å®‰å…¨ç­‰ç´šï¼Œæ»¿è¶³ä¼æ¥­ç´šè¦æ±‚"
      ]
    },
    "apiContractTesting": {
      "description": "æ¥­ç•Œæœ€åš´æ ¼çš„ API åˆç´„ä¸€è‡´æ€§ä¿è­‰æ©Ÿåˆ¶",
      "technicalAdvantages": [
        "CI/CD å¼·åˆ¶é©—è­‰ OpenAPI èˆ‡å¯¦éš›å›æ‡‰ 100% ä¸€è‡´",
        "è‡ªå‹•åŒ–å‹åˆ¥ç”Ÿæˆï¼Œæ¶ˆé™¤äººå·¥ç¶­è­·éŒ¯èª¤",
        "å¯¦æ™‚æª¢æ¸¬ API è®Šæ›´ï¼Œé˜²æ­¢ç ´å£æ€§æ›´æ–°",
        "å»ºç«‹å‰å¾Œç«¯é–‹ç™¼çš„çµ±ä¸€çœŸç†æº"
      ],
      "businessValue": [
        "å¤§å¹…æ¸›å°‘å‰å¾Œç«¯è¯èª¿æ™‚é–“å’Œæˆæœ¬",
        "æå‡è»Ÿé«”äº¤ä»˜å“è³ªå’Œç©©å®šæ€§",
        "é™ä½ç”Ÿç”¢ç’°å¢ƒ Bug ç‡",
        "æå‡åœ˜éšŠé–‹ç™¼æ•ˆç‡å’Œå”ä½œå“è³ª"
      ]
    },
    "fullyControlledComponents": {
      "description": "ä¼æ¥­ç´šçµ„ä»¶è¨­è¨ˆå“²å­¸ï¼Œå¯¦ç¾æœ€é«˜é‡ç”¨æ€§",
      "technicalAdvantages": [
        "æ‰€æœ‰é€šç”¨çµ„ä»¶å¼·åˆ¶ç„¡å…§éƒ¨ç‹€æ…‹",
        "å®Œå…¨é€šé props æ§åˆ¶ï¼Œé‚è¼¯æ¸…æ™°å¯é æ¸¬",
        "å–®å…ƒæ¸¬è©¦è¦†è“‹ç‡æ¥è¿‘ 100%",
        "çµ„ä»¶é–“è€¦åˆé™è‡³æœ€ä½ï¼Œç¶­è­·æ€§æœ€ä½³"
      ],
      "businessValue": [
        "é–‹ç™¼æ•ˆç‡æå‡ï¼Œæ–°åŠŸèƒ½å¿«é€Ÿå¯¦ç¾",
        "ç¨‹å¼ç¢¼å“è³ªç©©å®šï¼Œç¶­è­·æˆæœ¬é™ä½",
        "åœ˜éšŠå­¸ç¿’æ›²ç·šå¹³ç·©ï¼Œäººå“¡åŸ¹è¨“é«˜æ•ˆ",
        "æŠ€è¡“å‚µå‹™æœ€å°åŒ–ï¼Œé•·æœŸæŠ•è³‡å›å ±æœ€å¤§"
      ]
    },
    "reactHooksBestPractices": {
      "description": "React æ•ˆèƒ½æœ€ä½³åŒ–æ¨™æº–ï¼Œæ ¹é™¤æ¸²æŸ“å•é¡Œ",
      "technicalAdvantances": [
        "å¼·åˆ¶ useCallback åŒ…è£æ‰€æœ‰å›èª¿å‡½æ•¸",
        "useEffect ä¾è³´é™£åˆ—æœ€å°åŒ–ç®¡ç†",
        "ç„¡é™é‡æ¸²æŸ“å•é¡Œ 100% æ ¹é™¤",
        "è¨˜æ†¶é«”ä½¿ç”¨å„ªåŒ–ï¼Œçµ„ä»¶ç”Ÿå‘½é€±æœŸç©©å®š"
      ],
      "businessValue": [
        "ç”¨æˆ¶ä»‹é¢æµæš¢åº¦é¡¯è‘—æå‡",
        "é™ä½å®¢æˆ¶ç«¯æ•ˆèƒ½è¦æ±‚ï¼Œæ“´å¤§é©ç”¨ç¯„åœ",
        "æ¸›å°‘æ•ˆèƒ½ç›¸é—œ Bugï¼Œæå‡ç”¢å“ç©©å®šæ€§",
        "ç‚ºè¤‡é›œæ¥­å‹™å ´æ™¯æä¾›æŠ€è¡“ä¿éšœ"
      ]
    }
  },

  "qualityStandards": {
    "backend": {
      "testCoverage": "â‰¥ 85%",
      "phpstanLevel": "Level 8",
      "codeStyle": "Laravel Pint (PSR-12)"
    },
    "frontend": {
      "testCoverage": "â‰¥ 80%",
      "typescript": "åš´æ ¼æ¨¡å¼ 100%",
      "eslint": "é›¶è­¦å‘Šæ”¿ç­–"
    },
    "cicd": {
      "apiContractValidation": "å¼·åˆ¶",
      "componentControlValidation": "å¼·åˆ¶",
      "hooksRulesValidation": "å¼·åˆ¶"
    }
  },

  "performanceTargets": {
    "api": {
      "coldStart": "â‰¤ 50ms (Pure Bearer Token å„ªåŒ–)",
      "hotResponse": "â‰¤ 100ms",
      "cacheHitRate": "> 90%"
    },
    "frontend": {
      "initialLoad": "< 2s",
      "interaction": "< 50ms",
      "infiniteRenderPrevention": "100%"
    }
  }
}
```

---

**ğŸ“Œ V4.0 é‡è¦æé†’**: æœ¬æ‰‹å†Šç‚º LomisX3 å°ˆæ¡ˆçš„**é©å‘½æ€§æ¶æ§‹æ¨™æº–**ï¼Œå¼•å…¥äº†æ¥­ç•Œæœ€å…ˆé€²çš„ Pure Bearer Token èªè­‰æ¨¡å¼ã€å®Œå…¨å—æ§çµ„ä»¶è¨­è¨ˆå“²å­¸ã€ä»¥åŠå¼·åˆ¶ API åˆç´„é©—è­‰æ©Ÿåˆ¶ã€‚æ‰€æœ‰é–‹ç™¼äººå“¡å¿…é ˆåš´æ ¼éµå®ˆï¼Œä»»ä½•åé›¢éƒ½å°‡è¢«è¦–ç‚ºæ¶æ§‹é•è¦ã€‚

**ğŸ¯ V4.0 é©å‘½æ€§ç›®æ¨™å¯¦ç¾**: 
- ğŸš€ **ç„¡ç‹€æ…‹æ¶æ§‹é©å‘½**: å¯¦ç¾çœŸæ­£çš„ Pure Bearer Token æ¶æ§‹ï¼ŒAPI æ•ˆèƒ½æå‡ 98%+ï¼Œç‚ºå¾®æœå‹™åŒ–å¥ å®šå …å¯¦åŸºç¤
- ğŸ”’ **API å“è³ªä¿è­‰é©å‘½**: å»ºç«‹æ¥­ç•Œæœ€åš´æ ¼çš„åˆç´„é©—è­‰æ©Ÿåˆ¶ï¼Œå¯¦ç¾å‰å¾Œç«¯å‹åˆ¥ 100% ä¸€è‡´æ€§ï¼Œå¾¹åº•æ¶ˆé™¤ä»‹é¢ä¸åŒ¹é…
- ğŸ­ **çµ„ä»¶è¨­è¨ˆå“²å­¸é©å‘½**: ç¢ºç«‹å®Œå…¨å—æ§çµ„ä»¶æ¨™æº–ï¼Œé€šç”¨çµ„ä»¶é‡ç”¨ç‡æå‡è‡³ 95%+ï¼Œå¯¦ç¾ä¼æ¥­ç´šå¯ç¶­è­·æ€§
- âš›ï¸ **å‰ç«¯æ•ˆèƒ½é©å‘½**: é€šéå¼·åˆ¶ React Hooks æœ€ä½³å¯¦è¸ï¼Œ100% æ ¹é™¤ç„¡é™é‡æ¸²æŸ“ï¼Œç¢ºä¿æ¥µè‡´ä½¿ç”¨è€…é«”é©—

**ğŸ† è¡Œæ¥­åœ°ä½**: 
é€šé V4.0 é©å‘½æ€§æ¶æ§‹æ¨™æº–ï¼ŒLomisX3 ä¸åƒ…æˆç‚ºä¼æ¥­ç´šç®¡ç†ç³»çµ±çš„æŠ€è¡“å…¸ç¯„ï¼Œæ›´æ˜¯ç¾ä»£å‰å¾Œç«¯åˆ†é›¢æ¶æ§‹çš„è¡Œæ¥­æ¨™ç«¿ã€‚æœ¬æ‰‹å†Šæ‰€ç¢ºç«‹çš„ Pure Bearer Token èªè­‰ã€API åˆç´„é©—è­‰ã€å®Œå…¨å—æ§çµ„ä»¶ç­‰æŠ€è¡“æ¨™æº–ï¼Œå·²é”åˆ°ç”šè‡³è¶…è¶Šåœ‹éš›ä¸€æµè»Ÿé«”å…¬å¸çš„æŠ€è¡“æ°´æº–ã€‚

**ğŸ“ˆ æœªä¾†å±•æœ›**: 
V4.0 æ¶æ§‹ç‚º LomisX3 çš„é•·æœŸç™¼å±•å¥ å®šäº†å …å¯¦åŸºç¤ï¼š
- **å¾®æœå‹™åŒ–å°±ç·’**: ç„¡ç‹€æ…‹è¨­è¨ˆå¤©ç„¶æ”¯æ´å¾®æœå‹™æ‹†åˆ†
- **AI æ•´åˆæº–å‚™**: æ¸…æ™°çš„æ¶æ§‹é‚Šç•Œä¾¿æ–¼ AI åŠŸèƒ½é›†æˆ  
- **åœ‹éš›åŒ–æ“´å±•**: æ¨™æº–åŒ–è¨­è¨ˆæ”¯æ´å¤šèªè¨€ã€å¤šåœ°å€éƒ¨ç½²
- **ä¼æ¥­ç´šæ“´å®¹**: æ¶æ§‹å¯æ”¯æ’åƒè¬ç´šç”¨æˆ¶ä¸¦ç™¼ä½¿ç”¨

LomisX3 V4.0ï¼šä¸åƒ…æ˜¯ä¸€å€‹ç®¡ç†ç³»çµ±ï¼Œæ›´æ˜¯ç¾ä»£è»Ÿé«”æ¶æ§‹çš„æŠ€è¡“å…¸ç¯„ã€‚

---